2025-05-19 01:20:24,900 [INFO] utils.save_manager: 初始化存檔管理器，實驗目錄: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:20:24,900 [INFO] utils.save_manager: 配置已保存到: results/indexed_classification_drlee_20250519_012024/config.json
2025-05-19 01:20:24,900 [INFO] __main__: 開始實驗: indexed_classification_drlee
2025-05-19 01:20:24,900 [INFO] __main__: 使用設備: cuda
2025-05-19 01:20:24,900 [INFO] utils.save_manager: 初始化存檔管理器，實驗目錄: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:20:24,901 [INFO] data.dataset_factory: 使用索引CSV: data/metadata/selection_groups/biscuit_20250516_230749.csv
2025-05-19 01:20:24,922 [INFO] utils.data_index_loader: DrLee_Evaluation 標籤映射: {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:24,923 [INFO] utils.data_index_loader: DrTai_Evaluation 標籤映射: {'吞嚥障礙': 0, '正常': 1, '無OR 輕微吞嚥障礙': 2, '重度吞嚥障礙': 3}
2025-05-19 01:20:24,923 [INFO] utils.data_index_loader: selection 標籤映射: {'餅乾1塊': 0, '餅乾2塊': 1}
2025-05-19 01:20:24,923 [INFO] utils.data_index_loader: 成功加載數據索引: data/metadata/selection_groups/biscuit_20250516_230749.csv, 共 216 條記錄
2025-05-19 01:20:24,923 [INFO] data.indexed_dataset: 分類任務 DrLee_Evaluation: 3 個類別，標籤映射 = {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:24,923 [INFO] data.indexed_dataset: 成功加載數據索引，共 216 條記錄
2025-05-19 01:20:24,937 [INFO] data.audio_dataset: 從數據索引創建了 216 個樣本
2025-05-19 01:20:24,937 [INFO] data.dataset_factory: 按患者 ID 拆分數據集
2025-05-19 01:20:24,937 [INFO] data.indexed_dataset: 患者ID分佈: N開頭 29 位, P開頭 81 位, 其他 0 位
2025-05-19 01:20:24,937 [INFO] data.indexed_dataset: 訓練集患者ID分佈: N開頭 14 位, P開頭 40 位, 其他 0 位
2025-05-19 01:20:24,937 [INFO] data.indexed_dataset: 驗證集患者ID分佈: N開頭 8 位, P開頭 24 位, 其他 0 位
2025-05-19 01:20:24,937 [INFO] data.indexed_dataset: 測試集患者ID分佈: N開頭 7 位, P開頭 17 位, 其他 0 位
2025-05-19 01:20:24,939 [INFO] data.indexed_dataset: 按患者ID拆分數據: 訓練集 104 個文件，驗證集 64 個文件，測試集 48 個文件
2025-05-19 01:20:24,959 [INFO] utils.data_index_loader: DrLee_Evaluation 標籤映射: {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:24,959 [INFO] utils.data_index_loader: DrTai_Evaluation 標籤映射: {'吞嚥障礙': 0, '正常': 1, '無OR 輕微吞嚥障礙': 2, '重度吞嚥障礙': 3}
2025-05-19 01:20:24,959 [INFO] utils.data_index_loader: selection 標籤映射: {'餅乾1塊': 0, '餅乾2塊': 1}
2025-05-19 01:20:24,959 [INFO] utils.data_index_loader: 成功加載數據索引: data/metadata/selection_groups/biscuit_20250516_230749.csv, 共 216 條記錄
2025-05-19 01:20:24,959 [INFO] data.indexed_dataset: 分類任務 DrLee_Evaluation: 3 個類別，標籤映射 = {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:24,959 [INFO] data.indexed_dataset: 成功加載數據索引，共 216 條記錄
2025-05-19 01:20:24,973 [INFO] data.audio_dataset: 從數據索引創建了 216 個樣本
2025-05-19 01:20:24,995 [INFO] utils.data_index_loader: DrLee_Evaluation 標籤映射: {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:24,995 [INFO] utils.data_index_loader: DrTai_Evaluation 標籤映射: {'吞嚥障礙': 0, '正常': 1, '無OR 輕微吞嚥障礙': 2, '重度吞嚥障礙': 3}
2025-05-19 01:20:24,995 [INFO] utils.data_index_loader: selection 標籤映射: {'餅乾1塊': 0, '餅乾2塊': 1}
2025-05-19 01:20:24,996 [INFO] utils.data_index_loader: 成功加載數據索引: data/metadata/selection_groups/biscuit_20250516_230749.csv, 共 216 條記錄
2025-05-19 01:20:24,996 [INFO] data.indexed_dataset: 分類任務 DrLee_Evaluation: 3 個類別，標籤映射 = {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:24,996 [INFO] data.indexed_dataset: 成功加載數據索引，共 216 條記錄
2025-05-19 01:20:25,010 [INFO] data.audio_dataset: 從數據索引創建了 216 個樣本
2025-05-19 01:20:25,010 [INFO] data.dataset_factory: 使用索引模式創建數據集 - 訓練: 104，驗證: 64，測試: 48
2025-05-19 01:20:25,010 [INFO] data.dataset_factory: 使用索引CSV: data/metadata/selection_groups/biscuit_20250516_230749.csv
2025-05-19 01:20:25,030 [INFO] utils.data_index_loader: DrLee_Evaluation 標籤映射: {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:25,030 [INFO] utils.data_index_loader: DrTai_Evaluation 標籤映射: {'吞嚥障礙': 0, '正常': 1, '無OR 輕微吞嚥障礙': 2, '重度吞嚥障礙': 3}
2025-05-19 01:20:25,030 [INFO] utils.data_index_loader: selection 標籤映射: {'餅乾1塊': 0, '餅乾2塊': 1}
2025-05-19 01:20:25,030 [INFO] utils.data_index_loader: 成功加載數據索引: data/metadata/selection_groups/biscuit_20250516_230749.csv, 共 216 條記錄
2025-05-19 01:20:25,030 [INFO] data.indexed_dataset: 分類任務 DrLee_Evaluation: 3 個類別，標籤映射 = {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:25,030 [INFO] data.indexed_dataset: 成功加載數據索引，共 216 條記錄
2025-05-19 01:20:25,044 [INFO] data.audio_dataset: 從數據索引創建了 216 個樣本
2025-05-19 01:20:25,044 [INFO] data.dataset_factory: 按患者 ID 拆分數據集
2025-05-19 01:20:25,045 [INFO] data.indexed_dataset: 患者ID分佈: N開頭 29 位, P開頭 81 位, 其他 0 位
2025-05-19 01:20:25,045 [INFO] data.indexed_dataset: 訓練集患者ID分佈: N開頭 14 位, P開頭 40 位, 其他 0 位
2025-05-19 01:20:25,045 [INFO] data.indexed_dataset: 驗證集患者ID分佈: N開頭 8 位, P開頭 24 位, 其他 0 位
2025-05-19 01:20:25,045 [INFO] data.indexed_dataset: 測試集患者ID分佈: N開頭 7 位, P開頭 17 位, 其他 0 位
2025-05-19 01:20:25,046 [INFO] data.indexed_dataset: 按患者ID拆分數據: 訓練集 104 個文件，驗證集 64 個文件，測試集 48 個文件
2025-05-19 01:20:25,066 [INFO] utils.data_index_loader: DrLee_Evaluation 標籤映射: {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:25,066 [INFO] utils.data_index_loader: DrTai_Evaluation 標籤映射: {'吞嚥障礙': 0, '正常': 1, '無OR 輕微吞嚥障礙': 2, '重度吞嚥障礙': 3}
2025-05-19 01:20:25,066 [INFO] utils.data_index_loader: selection 標籤映射: {'餅乾1塊': 0, '餅乾2塊': 1}
2025-05-19 01:20:25,066 [INFO] utils.data_index_loader: 成功加載數據索引: data/metadata/selection_groups/biscuit_20250516_230749.csv, 共 216 條記錄
2025-05-19 01:20:25,066 [INFO] data.indexed_dataset: 分類任務 DrLee_Evaluation: 3 個類別，標籤映射 = {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:25,066 [INFO] data.indexed_dataset: 成功加載數據索引，共 216 條記錄
2025-05-19 01:20:25,080 [INFO] data.audio_dataset: 從數據索引創建了 216 個樣本
2025-05-19 01:20:25,100 [INFO] utils.data_index_loader: DrLee_Evaluation 標籤映射: {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:25,100 [INFO] utils.data_index_loader: DrTai_Evaluation 標籤映射: {'吞嚥障礙': 0, '正常': 1, '無OR 輕微吞嚥障礙': 2, '重度吞嚥障礙': 3}
2025-05-19 01:20:25,100 [INFO] utils.data_index_loader: selection 標籤映射: {'餅乾1塊': 0, '餅乾2塊': 1}
2025-05-19 01:20:25,100 [INFO] utils.data_index_loader: 成功加載數據索引: data/metadata/selection_groups/biscuit_20250516_230749.csv, 共 216 條記錄
2025-05-19 01:20:25,100 [INFO] data.indexed_dataset: 分類任務 DrLee_Evaluation: 3 個類別，標籤映射 = {'聽起來正常': 0, '輕度異常': 1, '重度異常': 2}
2025-05-19 01:20:25,100 [INFO] data.indexed_dataset: 成功加載數據索引，共 216 條記錄
2025-05-19 01:20:25,114 [INFO] data.audio_dataset: 從數據索引創建了 216 個樣本
2025-05-19 01:20:25,114 [INFO] data.dataset_factory: 使用索引模式創建數據集 - 訓練: 104，驗證: 64，測試: 48
2025-05-19 01:20:25,115 [INFO] __main__: 數據集已創建，訓練集大小: 104, 驗證集大小: 64, 測試集大小: 48
2025-05-19 01:20:25,115 [INFO] __main__: 保存資料集詳細資訊...
2025-05-19 01:20:27,279 [INFO] utils.save_manager: train 資料集資訊已保存到: results/indexed_classification_drlee_20250519_012024/datasets/train_dataset_info.pt
2025-05-19 01:20:27,280 [INFO] utils.save_manager: train 資料集資訊(JSON)已保存到: results/indexed_classification_drlee_20250519_012024/datasets/train_dataset_info.json
2025-05-19 01:20:28,229 [INFO] utils.save_manager: val 資料集資訊已保存到: results/indexed_classification_drlee_20250519_012024/datasets/val_dataset_info.pt
2025-05-19 01:20:28,230 [INFO] utils.save_manager: val 資料集資訊(JSON)已保存到: results/indexed_classification_drlee_20250519_012024/datasets/val_dataset_info.json
2025-05-19 01:20:28,863 [INFO] utils.save_manager: test 資料集資訊已保存到: results/indexed_classification_drlee_20250519_012024/datasets/test_dataset_info.pt
2025-05-19 01:20:28,863 [INFO] utils.save_manager: test 資料集資訊(JSON)已保存到: results/indexed_classification_drlee_20250519_012024/datasets/test_dataset_info.json
2025-05-19 01:20:28,864 [INFO] utils.save_manager: 資料集綜合統計資訊已保存到: results/indexed_classification_drlee_20250519_012024/datasets/dataset_statistics.json
2025-05-19 01:20:28,864 [INFO] __main__: 資料集綜合統計資訊保存完成
2025-05-19 01:20:28,864 [WARNING] __main__: 無法從任何數據集獲取類別數量，模型配置中的 num_classes 將保持不變或依賴默認值。
2025-05-19 01:20:28,864 [INFO] models.swin_transformer: 使用預訓練權重: Swin_T_Weights.IMAGENET1K_V1
2025-05-19 01:20:29,599 [INFO] __main__: 模型已創建，類型: swin_transformer
2025-05-19 01:20:29,803 [INFO] losses.loss_factory: 創建損失函數: CrossEntropyLoss
2025-05-19 01:20:29,803 [INFO] trainers.pytorch_trainer: 使用LossFactory創建損失函數成功: CrossEntropyLoss
2025-05-19 01:20:29,803 [INFO] utils.save_manager: 初始化存檔管理器，實驗目錄: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:20:29,804 [INFO] trainers.pytorch_trainer: TensorBoard logs 將保存至 results/indexed_classification_drlee_20250519_012024/tensorboard_logs/
2025-05-19 01:20:29,804 [INFO] trainers.pytorch_trainer: 訓練輸出將保存至 results/indexed_classification_drlee_20250519_012024
2025-05-19 01:20:29,809 [INFO] utils.save_manager: 配置已保存到: results/indexed_classification_drlee_20250519_012024/config.json
2025-05-19 01:20:29,817 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:20:29,817 [INFO] trainers.pytorch_trainer: 開始訓練，模型類型: swin_transformer
2025-05-19 01:20:29,817 [INFO] trainers.pytorch_trainer: 設備: cuda
2025-05-19 01:20:29,817 [INFO] utils.data_adapter: 模型類型 'swin_transformer' 與數據類型 'audio' 不兼容，使用 AdapterDataLoader 進行適配
Training:   0%|          | 0/30 [00:00<?, ?it/s]2025-05-19 01:20:29,818 [INFO] trainers.pytorch_trainer: 監控指標: accuracy, 模式: max

Epoch 1/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:30,336 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:30,389 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 1/30 [Train]:   0%|          | 0/4 [00:01<?, ?it/s, loss=134][A
Epoch 1/30 [Train]:  25%|██▌       | 1/4 [00:01<00:03,  1.30s/it, loss=134][A2025-05-19 01:20:31,121 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:31,153 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 1/30 [Train]:  25%|██▌       | 1/4 [00:01<00:03,  1.30s/it, loss=80.7][A
Epoch 1/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.56it/s, loss=80.7][A2025-05-19 01:20:31,300 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:31,333 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 1/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.56it/s, loss=174] [A
Epoch 1/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.33it/s, loss=174][A2025-05-19 01:20:31,475 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:31,484 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 1/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.33it/s, loss=140][AEpoch 1/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.25it/s, loss=140]
2025-05-19 01:20:31,723 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_0/gns_stats_epoch_0.json
2025-05-19 01:20:31,723 [INFO] trainers.pytorch_trainer: Epoch 0 GNS = 0.0000

Epoch 1/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:32,104 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:32,402 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 1/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=136][A
Epoch 1/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=136][A2025-05-19 01:20:32,438 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:32,470 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 1/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=218][AEpoch 1/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.47it/s, loss=218]
2025-05-19 01:20:32,681 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:32,687 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:20:32,688 [INFO] trainers.pytorch_trainer: Epoch 1/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:32,688 [INFO] trainers.pytorch_trainer: Epoch 1/30 - 訓練損失: 132.0504, 驗證損失: 176.9820

Epoch 2/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:33,168 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:33,208 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 2/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=117][A
Epoch 2/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.44it/s, loss=117][A2025-05-19 01:20:33,385 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:33,424 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 2/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.44it/s, loss=60.2][A
Epoch 2/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.54it/s, loss=60.2][A2025-05-19 01:20:33,569 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:33,601 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 2/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.54it/s, loss=120] [A
Epoch 2/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.44it/s, loss=120][A2025-05-19 01:20:33,737 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:33,746 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 2/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.44it/s, loss=106][AEpoch 2/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.42it/s, loss=106]
2025-05-19 01:20:33,979 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_1/gns_stats_epoch_1.json
2025-05-19 01:20:33,979 [INFO] trainers.pytorch_trainer: Epoch 1 GNS = 0.0000

Epoch 2/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:34,369 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:34,649 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 2/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=38.5][A
Epoch 2/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=38.5][A2025-05-19 01:20:34,685 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:34,756 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 2/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=22.5][A
Epoch 2/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.86it/s, loss=22.5][AEpoch 2/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.39it/s, loss=22.5]
2025-05-19 01:20:35,204 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:35,211 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:20:35,211 [INFO] trainers.pytorch_trainer: Epoch 2/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:35,211 [INFO] trainers.pytorch_trainer: Epoch 2/30 - 訓練損失: 101.0202, 驗證損失: 30.5183

Epoch 3/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:35,717 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:35,754 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 3/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=41.8][A
Epoch 3/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.35it/s, loss=41.8][A2025-05-19 01:20:35,954 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:35,993 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 3/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.35it/s, loss=46.6][A
Epoch 3/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.43it/s, loss=46.6][A2025-05-19 01:20:36,136 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:36,168 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 3/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.43it/s, loss=82.8][A
Epoch 3/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.32it/s, loss=82.8][A2025-05-19 01:20:36,306 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:36,315 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 3/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.32it/s, loss=83.4][AEpoch 3/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s, loss=83.4]
2025-05-19 01:20:36,562 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_2/gns_stats_epoch_2.json
2025-05-19 01:20:36,562 [INFO] trainers.pytorch_trainer: Epoch 2 GNS = 0.0000

Epoch 3/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:36,985 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:37,263 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 3/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=79.7][A
Epoch 3/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.37it/s, loss=79.7][A2025-05-19 01:20:37,299 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:37,330 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 3/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.37it/s, loss=130] [AEpoch 3/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.41it/s, loss=130]
2025-05-19 01:20:37,404 [INFO] trainers.pytorch_trainer: Epoch 3/30 - 訓練損失: 63.6707, 驗證損失: 104.8678

Epoch 4/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:37,893 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:37,932 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 4/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=85.7][A
Epoch 4/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.41it/s, loss=85.7][A2025-05-19 01:20:38,116 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:38,154 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 4/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.41it/s, loss=45.1][A
Epoch 4/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.53it/s, loss=45.1][A2025-05-19 01:20:38,292 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:38,324 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 4/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.53it/s, loss=51.2][A
Epoch 4/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.44it/s, loss=51.2][A2025-05-19 01:20:38,459 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:38,468 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 4/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.44it/s, loss=14.8][AEpoch 4/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.41it/s, loss=14.8]
2025-05-19 01:20:38,705 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_3/gns_stats_epoch_3.json
2025-05-19 01:20:38,705 [INFO] trainers.pytorch_trainer: Epoch 3 GNS = 0.0000

Epoch 4/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:39,118 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:39,405 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 4/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=42.9][A
Epoch 4/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.37it/s, loss=42.9][A2025-05-19 01:20:39,441 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:39,474 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 4/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.37it/s, loss=28.7][AEpoch 4/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.41it/s, loss=28.7]
2025-05-19 01:20:39,548 [INFO] trainers.pytorch_trainer: Epoch 4/30 - 訓練損失: 49.1934, 驗證損失: 35.8343

Epoch 5/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:40,065 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:40,104 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 5/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=31.3][A
Epoch 5/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.36it/s, loss=31.3][A2025-05-19 01:20:40,286 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:40,324 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 5/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.36it/s, loss=38.3][A
Epoch 5/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.46it/s, loss=38.3][A2025-05-19 01:20:40,463 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:40,494 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 5/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.46it/s, loss=21.6][A
Epoch 5/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.37it/s, loss=21.6][A2025-05-19 01:20:40,629 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:40,639 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 5/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.37it/s, loss=33.4][AEpoch 5/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s, loss=33.4]
2025-05-19 01:20:40,893 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/gns_stats_epoch_4.json
2025-05-19 01:20:40,894 [INFO] trainers.pytorch_trainer: Epoch 4 GNS = 0.0000

Epoch 5/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:41,308 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:41,613 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 5/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=16.1][A
Epoch 5/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.33it/s, loss=16.1][A2025-05-19 01:20:41,648 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:41,679 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 5/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.33it/s, loss=21.8][AEpoch 5/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.36it/s, loss=21.8]
2025-05-19 01:20:42,128 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:42,135 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:20:42,135 [INFO] trainers.pytorch_trainer: Epoch 5/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:42,418 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_4.pth
2025-05-19 01:20:42,419 [INFO] trainers.pytorch_trainer: Epoch 5/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_4.pth
2025-05-19 01:20:42,457 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:20:42,459 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:20:42,460 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:20:42,461 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:20:42,462 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:20:42,464 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:20:42,465 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:42,466 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:42,470 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:42,476 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:42,478 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:42,479 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:20:42,481 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:20:42,482 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:42,490 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:42,492 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:42,497 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:42,498 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:20:42,499 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:20:42,501 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:42,503 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:42,507 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:42,508 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:42,511 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:42,512 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:20:42,513 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:20:42,515 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:42,520 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:42,521 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:42,527 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:42,528 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:20:42,538 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:20:42,539 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:20:42,541 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:20:42,542 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:20:42,543 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:42,545 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:42,558 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:42,560 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:42,565 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:42,566 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:20:42,568 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:20:42,570 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:42,589 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:42,592 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:42,611 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:42,613 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:20:42,615 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:20:42,617 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:42,620 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:42,634 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:42,637 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:42,643 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:42,645 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:20:42,647 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:20:42,650 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:42,668 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:42,671 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:42,690 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:42,693 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:20:42,725 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:20:42,728 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:20:42,730 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:20:42,732 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:20:42,735 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:42,738 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:42,785 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:42,788 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:42,807 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:42,809 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:20:42,811 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:20:42,815 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:42,877 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:42,881 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:42,945 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:42,948 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:20:42,950 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:20:42,952 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:42,956 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:43,018 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:43,021 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:43,042 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:43,045 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:20:43,047 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:20:43,051 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:43,117 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:43,121 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:43,250 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:43,253 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:20:43,255 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:20:43,257 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:43,261 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:43,307 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:43,310 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:43,330 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:43,332 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:20:43,334 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:20:43,338 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:43,398 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:43,403 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:43,464 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:43,494 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:20:43,497 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:20:43,498 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:43,501 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:43,547 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:43,549 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:43,567 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:43,568 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:20:43,569 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:20:43,572 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:43,632 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:43,636 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:43,695 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:43,697 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:20:43,698 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:20:43,700 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:43,702 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:43,748 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:43,750 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:43,768 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:43,769 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:20:43,771 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:20:43,774 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:43,834 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:43,837 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:43,896 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:43,898 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:20:43,899 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:20:43,901 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:43,904 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:43,950 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:43,952 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:43,970 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:43,971 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:20:43,973 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:20:43,976 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:44,036 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:44,039 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:44,099 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:44,104 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:20:44,119 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:20:44,120 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:20:44,122 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:20:44,123 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:20:44,125 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:44,132 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:44,146 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:44,149 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:44,210 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:44,212 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:20:44,214 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:20:44,224 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:44,238 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:44,248 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:44,263 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:44,265 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:20:44,267 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:20:44,269 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:20:44,277 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:20:44,292 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:20:44,296 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:20:44,358 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:20:44,360 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:20:44,362 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:20:44,372 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:20:44,387 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:20:44,397 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:20:44,411 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:20:44,413 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_norm_weight_gradient_all.pt
2025-05-19 01:20:44,416 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_norm_bias_gradient_all.pt
2025-05-19 01:20:44,418 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/head_1_weight_gradient_all.pt
2025-05-19 01:20:44,420 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/head_1_bias_gradient_all.pt
2025-05-19 01:20:44,423 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:20:44,443 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:20:44,445 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:20:44,447 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:20:44,448 [INFO] trainers.pytorch_trainer: Epoch 4: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:20:48,325 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/gns_stats_epoch_4.json
2025-05-19 01:20:48,326 [INFO] trainers.pytorch_trainer: Epoch 5/30 - 訓練損失: 31.1659, 驗證損失: 18.9207

Epoch 6/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:48,792 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:48,844 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 6/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=23.4][A
Epoch 6/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.43it/s, loss=23.4][A2025-05-19 01:20:49,027 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:49,064 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 6/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.43it/s, loss=48.3][A
Epoch 6/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.52it/s, loss=48.3][A2025-05-19 01:20:49,212 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:49,244 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 6/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.52it/s, loss=24.7][A
Epoch 6/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.41it/s, loss=24.7][A2025-05-19 01:20:49,382 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:49,391 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 6/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.41it/s, loss=29]  [AEpoch 6/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.41it/s, loss=29]
2025-05-19 01:20:49,629 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_5/gns_stats_epoch_5.json
2025-05-19 01:20:49,629 [INFO] trainers.pytorch_trainer: Epoch 5 GNS = 0.0000

Epoch 6/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:50,030 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:50,295 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 6/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=14.2][A
Epoch 6/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=14.2][A2025-05-19 01:20:50,331 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:50,365 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 6/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=22.7][AEpoch 6/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.50it/s, loss=22.7]
2025-05-19 01:20:50,806 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:50,813 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:20:50,813 [INFO] trainers.pytorch_trainer: Epoch 6/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:50,813 [INFO] trainers.pytorch_trainer: Epoch 6/30 - 訓練損失: 31.3459, 驗證損失: 18.4429

Epoch 7/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:51,285 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:51,384 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 7/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=23.1][A
Epoch 7/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.31it/s, loss=23.1][A2025-05-19 01:20:51,581 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:51,614 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 7/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.31it/s, loss=31]  [A
Epoch 7/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.41it/s, loss=31][A2025-05-19 01:20:51,751 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:51,814 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 7/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.41it/s, loss=12][A
Epoch 7/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.15it/s, loss=12][A2025-05-19 01:20:51,951 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:51,960 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 7/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.15it/s, loss=12.8][AEpoch 7/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s, loss=12.8]
2025-05-19 01:20:52,195 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_6/gns_stats_epoch_6.json
2025-05-19 01:20:52,195 [INFO] trainers.pytorch_trainer: Epoch 6 GNS = 0.0000

Epoch 7/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:52,584 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:52,874 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 7/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=10.5][A
Epoch 7/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=10.5][A2025-05-19 01:20:52,909 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:52,942 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 7/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=11.2][AEpoch 7/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.46it/s, loss=11.2]
2025-05-19 01:20:53,389 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:53,395 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:20:53,396 [INFO] trainers.pytorch_trainer: Epoch 7/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:53,396 [INFO] trainers.pytorch_trainer: Epoch 7/30 - 訓練損失: 19.7344, 驗證損失: 10.8569

Epoch 8/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:53,880 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:54,046 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 8/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=18.3][A
Epoch 8/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.16it/s, loss=18.3][A2025-05-19 01:20:54,261 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:54,299 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 8/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.16it/s, loss=20.3][A
Epoch 8/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=20.3][A2025-05-19 01:20:54,467 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:54,501 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 8/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=24.2][A
Epoch 8/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.96it/s, loss=24.2][A2025-05-19 01:20:54,642 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:54,651 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 8/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.96it/s, loss=45.8][AEpoch 8/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s, loss=45.8]
2025-05-19 01:20:54,886 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_7/gns_stats_epoch_7.json
2025-05-19 01:20:54,886 [INFO] trainers.pytorch_trainer: Epoch 7 GNS = 0.0000

Epoch 8/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:55,279 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:55,569 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 8/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=11.3][A
Epoch 8/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=11.3][A2025-05-19 01:20:55,604 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:55,635 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 8/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=17.9][AEpoch 8/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.46it/s, loss=17.9]
2025-05-19 01:20:55,715 [INFO] trainers.pytorch_trainer: Epoch 8/30 - 訓練損失: 27.1607, 驗證損失: 14.6147

Epoch 9/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:56,201 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:56,314 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 9/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=20.8][A
Epoch 9/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.26it/s, loss=20.8][A2025-05-19 01:20:56,510 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:56,546 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 9/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.26it/s, loss=34.4][A
Epoch 9/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.33it/s, loss=34.4][A2025-05-19 01:20:56,685 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:56,721 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 9/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.33it/s, loss=33.4][A
Epoch 9/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.22it/s, loss=33.4][A2025-05-19 01:20:56,856 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:56,865 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 9/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.22it/s, loss=31.8][AEpoch 9/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s, loss=31.8]
2025-05-19 01:20:57,100 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_8/gns_stats_epoch_8.json
2025-05-19 01:20:57,100 [INFO] trainers.pytorch_trainer: Epoch 8 GNS = 0.0000

Epoch 9/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:20:57,491 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:57,769 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 9/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=3.12][A
Epoch 9/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=3.12][A2025-05-19 01:20:57,805 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:57,841 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 9/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=5]   [AEpoch 9/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.48it/s, loss=5]
2025-05-19 01:20:58,287 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:58,294 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:20:58,294 [INFO] trainers.pytorch_trainer: Epoch 9/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:20:58,295 [INFO] trainers.pytorch_trainer: Epoch 9/30 - 訓練損失: 30.1014, 驗證損失: 4.0604

Epoch 10/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:20:58,812 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:58,851 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 10/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=29.8][A
Epoch 10/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.35it/s, loss=29.8][A2025-05-19 01:20:59,041 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:59,077 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 10/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.35it/s, loss=21.7][A
Epoch 10/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.46it/s, loss=21.7][A2025-05-19 01:20:59,212 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:59,245 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 10/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.46it/s, loss=23.8][A
Epoch 10/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.38it/s, loss=23.8][A2025-05-19 01:20:59,377 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:20:59,386 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 10/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.38it/s, loss=18.2][AEpoch 10/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s, loss=18.2]
2025-05-19 01:20:59,624 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/gns_stats_epoch_9.json
2025-05-19 01:20:59,624 [INFO] trainers.pytorch_trainer: Epoch 9 GNS = 0.0000

Epoch 10/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:00,027 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:00,309 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 10/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=5.15][A
Epoch 10/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=5.15][A2025-05-19 01:21:00,345 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:00,422 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 10/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=7.64][A
Epoch 10/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.78it/s, loss=7.64][AEpoch 10/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.30it/s, loss=7.64]
2025-05-19 01:21:00,803 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_9.pth
2025-05-19 01:21:00,803 [INFO] trainers.pytorch_trainer: Epoch 10/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_9.pth
2025-05-19 01:21:00,839 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:21:00,841 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:21:00,842 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:21:00,844 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:21:00,845 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:00,846 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:00,847 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:00,848 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:00,853 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:00,859 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:00,862 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:00,864 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:00,865 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:00,866 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:00,871 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:00,876 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:00,881 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:00,882 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:00,884 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:00,885 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:00,886 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:00,891 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:00,892 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:00,894 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:00,895 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:00,896 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:00,898 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:00,903 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:00,904 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:00,909 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:00,911 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:21:00,920 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:21:00,922 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:21:00,923 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:00,924 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:00,925 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:00,927 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:00,941 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:00,942 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:00,947 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:00,949 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:00,950 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:00,952 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:00,970 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:00,972 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:00,990 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:00,992 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:00,993 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:00,994 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:00,996 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:01,010 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:01,011 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:01,016 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:01,018 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:01,019 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:01,021 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:01,039 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:01,040 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:01,058 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:01,061 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:21:01,093 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:21:01,095 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:21:01,096 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:01,097 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:01,099 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:01,102 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:01,147 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:01,149 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:01,167 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:01,169 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:01,170 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:01,173 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:01,234 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:01,237 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:01,297 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:01,299 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:01,302 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:01,303 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:01,306 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:01,354 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:01,355 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:01,373 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:01,375 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:01,376 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:01,380 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:01,439 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:01,444 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:01,505 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:01,506 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:21:01,507 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:21:01,509 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:01,512 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:01,558 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:01,560 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:01,578 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:01,579 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:21:01,581 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:21:01,584 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:01,644 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:01,647 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:01,708 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:01,709 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:21:01,710 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:21:01,712 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:01,715 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:01,761 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:01,763 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:01,781 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:01,782 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:21:01,784 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:21:01,787 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:01,847 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:01,850 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:01,910 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:01,911 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:21:01,912 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:21:01,914 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:01,917 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:01,963 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:01,965 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:01,983 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:01,984 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:21:01,986 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:21:01,989 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:02,050 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:02,054 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:02,114 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:02,115 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:21:02,117 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:21:02,119 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:02,122 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:02,169 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:02,171 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:02,189 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:02,191 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:21:02,192 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:21:02,195 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:02,256 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:02,259 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:02,318 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:02,324 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:21:02,338 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:21:02,339 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:21:02,341 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:02,342 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:02,344 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:02,351 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:02,365 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:02,368 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:02,428 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:02,430 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:02,431 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:02,440 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:02,454 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:02,463 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:02,477 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:02,479 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:02,482 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:02,487 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:02,495 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:02,510 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:02,524 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:02,636 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:02,639 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:02,641 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:02,655 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:02,689 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:02,699 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:02,721 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:02,723 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_norm_weight_gradient_all.pt
2025-05-19 01:21:02,726 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_norm_bias_gradient_all.pt
2025-05-19 01:21:02,728 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/head_1_weight_gradient_all.pt
2025-05-19 01:21:02,737 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/head_1_bias_gradient_all.pt
2025-05-19 01:21:02,740 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:21:02,749 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:21:02,751 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:21:02,753 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:21:02,755 [INFO] trainers.pytorch_trainer: Epoch 9: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:21:06,548 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/gns_stats_epoch_9.json
2025-05-19 01:21:06,548 [INFO] trainers.pytorch_trainer: Epoch 10/30 - 訓練損失: 23.3918, 驗證損失: 6.3924

Epoch 11/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:07,050 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:07,112 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 11/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=28][A
Epoch 11/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.32it/s, loss=28][A2025-05-19 01:21:07,306 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:07,343 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 11/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.32it/s, loss=20.5][A
Epoch 11/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.40it/s, loss=20.5][A2025-05-19 01:21:07,487 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:07,524 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 11/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.40it/s, loss=35.6][A
Epoch 11/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.26it/s, loss=35.6][A2025-05-19 01:21:07,663 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:07,674 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 11/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.26it/s, loss=7.73][AEpoch 11/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s, loss=7.73]
2025-05-19 01:21:07,910 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_10/gns_stats_epoch_10.json
2025-05-19 01:21:07,910 [INFO] trainers.pytorch_trainer: Epoch 10 GNS = 0.0000

Epoch 11/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:08,298 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:08,578 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 11/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=9.17][A
Epoch 11/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=9.17][A2025-05-19 01:21:08,614 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:08,646 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 11/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=14.3][AEpoch 11/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.50it/s, loss=14.3]
2025-05-19 01:21:08,723 [INFO] trainers.pytorch_trainer: Epoch 11/30 - 訓練損失: 22.9496, 驗證損失: 11.7568

Epoch 12/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:09,245 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:09,283 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 12/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=32.9][A
Epoch 12/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.33it/s, loss=32.9][A2025-05-19 01:21:09,477 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:09,516 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 12/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.33it/s, loss=18.9][A
Epoch 12/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.41it/s, loss=18.9][A2025-05-19 01:21:09,657 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:09,695 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 12/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.41it/s, loss=21.8][A
Epoch 12/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.29it/s, loss=21.8][A2025-05-19 01:21:09,830 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:09,841 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 12/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.29it/s, loss=12.8][AEpoch 12/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s, loss=12.8]
2025-05-19 01:21:10,088 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_11/gns_stats_epoch_11.json
2025-05-19 01:21:10,088 [INFO] trainers.pytorch_trainer: Epoch 11 GNS = 0.0000

Epoch 12/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:10,478 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:10,781 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 12/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=7.35][A
Epoch 12/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.38it/s, loss=7.35][A2025-05-19 01:21:10,817 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:10,849 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 12/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.38it/s, loss=11.8][AEpoch 12/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.42it/s, loss=11.8]
2025-05-19 01:21:10,928 [INFO] trainers.pytorch_trainer: Epoch 12/30 - 訓練損失: 21.5934, 驗證損失: 9.5900

Epoch 13/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:11,448 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:11,505 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 13/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=18.6][A
Epoch 13/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.32it/s, loss=18.6][A2025-05-19 01:21:11,687 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:11,723 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 13/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.32it/s, loss=15.4][A
Epoch 13/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.42it/s, loss=15.4][A2025-05-19 01:21:11,860 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:11,893 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 13/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.42it/s, loss=24.9][A
Epoch 13/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.32it/s, loss=24.9][A2025-05-19 01:21:12,029 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:12,039 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 13/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.32it/s, loss=22.9][AEpoch 13/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s, loss=22.9]
2025-05-19 01:21:12,282 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_12/gns_stats_epoch_12.json
2025-05-19 01:21:12,282 [INFO] trainers.pytorch_trainer: Epoch 12 GNS = 0.0000

Epoch 13/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:12,677 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:12,951 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 13/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=8.17][A
Epoch 13/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=8.17][A2025-05-19 01:21:12,986 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:13,019 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 13/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=13.2][AEpoch 13/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.49it/s, loss=13.2]
2025-05-19 01:21:13,097 [INFO] trainers.pytorch_trainer: Epoch 13/30 - 訓練損失: 20.4340, 驗證損失: 10.6668

Epoch 14/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:13,657 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:13,697 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 14/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=20.1][A
Epoch 14/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.28it/s, loss=20.1][A2025-05-19 01:21:13,881 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:13,919 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 14/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.28it/s, loss=20.8][A
Epoch 14/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.35it/s, loss=20.8][A2025-05-19 01:21:14,059 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:14,100 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 14/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.35it/s, loss=21.3][A
Epoch 14/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.20it/s, loss=21.3][A2025-05-19 01:21:14,236 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:14,247 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 14/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.20it/s, loss=80.4][AEpoch 14/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s, loss=80.4]
2025-05-19 01:21:14,505 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_13/gns_stats_epoch_13.json
2025-05-19 01:21:14,505 [INFO] trainers.pytorch_trainer: Epoch 13 GNS = 0.0000

Epoch 14/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:14,897 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:15,174 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 14/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=11.4][A
Epoch 14/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=11.4][A2025-05-19 01:21:15,210 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:15,243 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 14/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=10.8][AEpoch 14/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.49it/s, loss=10.8]
2025-05-19 01:21:15,322 [INFO] trainers.pytorch_trainer: Epoch 14/30 - 訓練損失: 35.6415, 驗證損失: 11.0609

Epoch 15/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:15,835 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:15,886 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 15/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=28.6][A
Epoch 15/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.34it/s, loss=28.6][A2025-05-19 01:21:16,070 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:16,109 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 15/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.34it/s, loss=44.3][A
Epoch 15/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.44it/s, loss=44.3][A2025-05-19 01:21:16,247 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:16,282 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 15/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.44it/s, loss=28.5][A
Epoch 15/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.33it/s, loss=28.5][A2025-05-19 01:21:16,415 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:16,427 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 15/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.33it/s, loss=17.1][AEpoch 15/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s, loss=17.1]
2025-05-19 01:21:16,666 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/gns_stats_epoch_14.json
2025-05-19 01:21:16,666 [INFO] trainers.pytorch_trainer: Epoch 14 GNS = 0.0000

Epoch 15/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:17,055 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:17,343 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 15/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=16.7][A
Epoch 15/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=16.7][A2025-05-19 01:21:17,383 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:17,428 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 15/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=26.9][AEpoch 15/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.40it/s, loss=26.9]
2025-05-19 01:21:17,811 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_14.pth
2025-05-19 01:21:17,811 [INFO] trainers.pytorch_trainer: Epoch 15/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_14.pth
2025-05-19 01:21:17,855 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:21:17,857 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:21:17,858 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:21:17,859 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:21:17,861 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:17,862 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:17,863 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:17,864 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:17,868 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:17,874 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:17,876 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:17,878 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:17,879 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:17,880 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:17,885 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:17,887 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:17,896 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:17,897 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:17,898 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:17,900 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:17,901 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:17,905 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:17,906 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:17,909 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:17,910 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:17,911 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:17,912 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:17,917 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:17,919 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:17,924 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:17,925 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:21:17,935 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:21:17,936 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:21:17,937 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:17,938 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:17,940 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:17,942 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:17,955 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:17,956 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:17,962 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:17,963 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:17,964 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:17,966 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:17,984 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:17,986 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:18,003 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:18,005 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:18,006 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:18,007 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:18,009 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:18,022 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:18,024 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:18,029 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:18,030 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:18,031 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:18,033 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:18,051 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:18,052 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:18,070 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:18,072 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:21:18,107 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:21:18,108 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:21:18,110 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:18,111 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:18,112 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:18,115 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:18,160 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:18,162 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:18,180 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:18,181 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:18,183 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:18,189 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:18,251 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:18,254 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:18,315 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:18,316 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:18,318 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:18,319 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:18,322 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:18,368 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:18,370 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:18,388 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:18,389 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:18,390 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:18,394 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:18,454 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:18,457 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:18,517 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:18,518 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:21:18,520 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:21:18,521 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:18,524 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:18,570 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:18,572 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:18,590 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:18,591 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:21:18,592 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:21:18,595 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:18,655 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:18,658 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:18,719 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:18,721 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:21:18,723 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:21:18,724 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:18,727 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:18,772 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:18,774 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:18,792 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:18,794 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:21:18,795 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:21:18,798 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:18,858 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:18,861 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:18,922 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:18,923 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:21:18,925 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:21:18,927 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:18,929 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:18,975 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:18,977 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:18,995 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:18,996 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:21:18,998 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:21:19,001 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:19,060 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:19,063 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:19,124 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:19,125 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:21:19,127 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:21:19,129 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:19,132 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:19,177 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:19,179 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:19,197 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:19,199 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:21:19,200 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:21:19,203 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:19,262 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:19,266 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:19,326 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:19,331 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:21:19,346 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:21:19,347 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:21:19,349 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:19,350 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:19,352 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:19,359 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:19,372 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:19,376 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:19,436 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:19,437 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:19,439 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:19,447 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:19,461 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:19,470 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:19,483 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:19,485 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:19,486 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:19,488 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:19,495 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:19,508 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:19,512 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:19,641 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:19,643 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:19,644 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:19,653 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:19,678 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:19,687 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:19,713 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:19,714 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_norm_weight_gradient_all.pt
2025-05-19 01:21:19,716 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_norm_bias_gradient_all.pt
2025-05-19 01:21:19,717 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/head_1_weight_gradient_all.pt
2025-05-19 01:21:19,719 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/head_1_bias_gradient_all.pt
2025-05-19 01:21:19,720 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:21:19,736 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:21:19,737 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:21:19,738 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:21:19,739 [INFO] trainers.pytorch_trainer: Epoch 14: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:21:23,559 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/gns_stats_epoch_14.json
2025-05-19 01:21:23,560 [INFO] trainers.pytorch_trainer: Epoch 15/30 - 訓練損失: 29.6196, 驗證損失: 21.7982

Epoch 16/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:24,121 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:24,158 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 16/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=30.6][A
Epoch 16/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.23it/s, loss=30.6][A2025-05-19 01:21:24,374 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:24,412 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 16/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.23it/s, loss=18.1][A
Epoch 16/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.23it/s, loss=18.1][A2025-05-19 01:21:24,568 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:24,607 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 16/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.23it/s, loss=26.4][A
Epoch 16/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.12it/s, loss=26.4][A2025-05-19 01:21:24,737 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:24,747 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 16/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.12it/s, loss=31.1][AEpoch 16/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s, loss=31.1]
2025-05-19 01:21:24,987 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_15/gns_stats_epoch_15.json
2025-05-19 01:21:24,987 [INFO] trainers.pytorch_trainer: Epoch 15 GNS = 0.0000

Epoch 16/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:25,385 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:25,658 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 16/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=17.8][A
Epoch 16/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.42it/s, loss=17.8][A2025-05-19 01:21:25,694 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:25,727 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 16/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.42it/s, loss=28.9][AEpoch 16/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.48it/s, loss=28.9]
2025-05-19 01:21:25,807 [INFO] trainers.pytorch_trainer: Epoch 16/30 - 訓練損失: 26.5599, 驗證損失: 23.3180

Epoch 17/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:26,326 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:26,364 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 17/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=24.4][A
Epoch 17/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.37it/s, loss=24.4][A2025-05-19 01:21:26,540 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:26,577 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 17/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.37it/s, loss=17.3][A
Epoch 17/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.48it/s, loss=17.3][A2025-05-19 01:21:26,715 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:26,751 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 17/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.48it/s, loss=14.9][A
Epoch 17/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.37it/s, loss=14.9][A2025-05-19 01:21:26,884 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:26,895 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 17/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.37it/s, loss=15.3][AEpoch 17/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.34it/s, loss=15.3]
2025-05-19 01:21:27,129 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_16/gns_stats_epoch_16.json
2025-05-19 01:21:27,129 [INFO] trainers.pytorch_trainer: Epoch 16 GNS = 0.0000

Epoch 17/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:27,516 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:27,798 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 17/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=14.3][A
Epoch 17/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=14.3][A2025-05-19 01:21:27,833 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:27,866 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 17/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=12.4][AEpoch 17/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.49it/s, loss=12.4]
2025-05-19 01:21:27,946 [INFO] trainers.pytorch_trainer: Epoch 17/30 - 訓練損失: 17.9599, 驗證損失: 13.3458

Epoch 18/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:28,479 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:28,517 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 18/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=24.5][A
Epoch 18/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.34it/s, loss=24.5][A2025-05-19 01:21:28,699 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:28,735 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 18/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.34it/s, loss=16.1][A
Epoch 18/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.43it/s, loss=16.1][A2025-05-19 01:21:28,874 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:28,911 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 18/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.43it/s, loss=24.3][A
Epoch 18/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.32it/s, loss=24.3][A2025-05-19 01:21:29,045 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:29,057 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 18/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.32it/s, loss=28.7][AEpoch 18/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s, loss=28.7]
2025-05-19 01:21:29,294 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_17/gns_stats_epoch_17.json
2025-05-19 01:21:29,295 [INFO] trainers.pytorch_trainer: Epoch 17 GNS = 0.0000

Epoch 18/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:29,683 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:29,977 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 18/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=21.1][A
Epoch 18/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=21.1][A2025-05-19 01:21:30,012 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:30,044 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 18/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=34.1][AEpoch 18/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.46it/s, loss=34.1]
2025-05-19 01:21:30,121 [INFO] trainers.pytorch_trainer: Epoch 18/30 - 訓練損失: 23.3709, 驗證損失: 27.5731

Epoch 19/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:30,633 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:30,675 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 19/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=24][A
Epoch 19/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.36it/s, loss=24][A2025-05-19 01:21:30,858 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:30,894 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 19/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.36it/s, loss=22.6][A
Epoch 19/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.47it/s, loss=22.6][A2025-05-19 01:21:31,032 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:31,069 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 19/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.47it/s, loss=13.9][A
Epoch 19/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.35it/s, loss=13.9][A2025-05-19 01:21:31,205 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:31,215 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 19/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.35it/s, loss=12.5][AEpoch 19/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s, loss=12.5]
2025-05-19 01:21:31,452 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_18/gns_stats_epoch_18.json
2025-05-19 01:21:31,452 [INFO] trainers.pytorch_trainer: Epoch 18 GNS = 0.0000

Epoch 19/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:31,842 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:32,121 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 19/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=11.7][A
Epoch 19/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=11.7][A2025-05-19 01:21:32,156 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:32,189 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 19/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=11]  [AEpoch 19/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.49it/s, loss=11]
2025-05-19 01:21:32,267 [INFO] trainers.pytorch_trainer: Epoch 19/30 - 訓練損失: 18.2383, 驗證損失: 11.3575

Epoch 20/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:32,773 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:32,818 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 20/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=15.9][A
Epoch 20/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.37it/s, loss=15.9][A2025-05-19 01:21:32,999 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:33,036 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 20/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.37it/s, loss=11.3][A
Epoch 20/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.49it/s, loss=11.3][A2025-05-19 01:21:33,173 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:33,209 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 20/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.49it/s, loss=13.8][A
Epoch 20/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.36it/s, loss=13.8][A2025-05-19 01:21:33,347 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:33,357 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 20/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.36it/s, loss=5.57][AEpoch 20/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s, loss=5.57]
2025-05-19 01:21:33,591 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/gns_stats_epoch_19.json
2025-05-19 01:21:33,591 [INFO] trainers.pytorch_trainer: Epoch 19 GNS = 0.0000

Epoch 20/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:33,979 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:34,257 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 20/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=8.54][A
Epoch 20/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=8.54][A2025-05-19 01:21:34,293 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:34,326 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 20/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=13.6][AEpoch 20/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.49it/s, loss=13.6]
2025-05-19 01:21:34,710 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_19.pth
2025-05-19 01:21:34,711 [INFO] trainers.pytorch_trainer: Epoch 20/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_19.pth
2025-05-19 01:21:34,750 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:21:34,752 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:21:34,753 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:21:34,754 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:21:34,755 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:34,757 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:34,758 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:34,759 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:34,763 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:34,765 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:34,771 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:34,772 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:34,773 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:34,775 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:34,780 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:34,781 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:34,789 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:34,790 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:34,791 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:34,792 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:34,794 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:34,798 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:34,799 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:34,803 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:34,804 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:34,805 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:34,807 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:34,812 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:34,813 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:34,818 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:34,820 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:21:34,829 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:21:34,830 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:21:34,831 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:34,833 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:34,834 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:34,836 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:34,849 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:34,850 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:34,856 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:34,857 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:34,858 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:34,860 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:34,878 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:34,879 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:34,897 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:34,898 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:34,899 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:34,901 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:34,902 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:34,916 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:34,917 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:34,922 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:34,923 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:34,925 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:34,926 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:34,944 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:34,946 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:34,964 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:34,966 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:21:34,999 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:21:35,000 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:21:35,002 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:35,003 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:35,004 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:35,007 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:35,052 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:35,054 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:35,072 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:35,074 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:35,075 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:35,078 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:35,139 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:35,143 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:35,204 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:35,205 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:35,207 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:35,208 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:35,211 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:35,259 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:35,260 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:35,278 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:35,280 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:35,282 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:35,285 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:35,348 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:35,352 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:35,413 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:35,414 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:21:35,415 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:21:35,416 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:35,419 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:35,469 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:35,471 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:35,489 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:35,491 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:21:35,492 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:21:35,495 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:35,556 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:35,559 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:35,619 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:35,621 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:21:35,622 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:21:35,623 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:35,626 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:35,673 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:35,675 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:35,693 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:35,694 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:21:35,695 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:21:35,698 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:35,759 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:35,763 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:35,823 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:35,825 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:21:35,826 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:21:35,827 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:35,830 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:35,878 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:35,879 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:35,898 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:35,900 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:21:35,901 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:21:35,904 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:35,965 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:35,968 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:36,029 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:36,030 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:21:36,031 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:21:36,033 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:36,036 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:36,082 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:36,084 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:36,102 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:36,104 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:21:36,105 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:21:36,108 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:36,170 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:36,173 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:36,233 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:36,238 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:21:36,253 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:21:36,255 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:21:36,256 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:36,257 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:36,259 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:36,266 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:36,280 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:36,284 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:36,345 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:36,347 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:36,348 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:36,357 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:36,370 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:36,379 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:36,393 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:36,394 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:36,396 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:36,397 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:36,404 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:36,418 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:36,423 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:36,483 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:36,485 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:36,486 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:36,494 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:36,514 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:36,523 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:36,538 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:36,539 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_norm_weight_gradient_all.pt
2025-05-19 01:21:36,540 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_norm_bias_gradient_all.pt
2025-05-19 01:21:36,552 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/head_1_weight_gradient_all.pt
2025-05-19 01:21:36,553 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/head_1_bias_gradient_all.pt
2025-05-19 01:21:36,555 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:21:36,563 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:21:36,564 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:21:36,566 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:21:36,567 [INFO] trainers.pytorch_trainer: Epoch 19: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:21:40,504 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/gns_stats_epoch_19.json
2025-05-19 01:21:40,505 [INFO] trainers.pytorch_trainer: Epoch 20/30 - 訓練損失: 11.6290, 驗證損失: 11.0730

Epoch 21/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:41,004 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:41,065 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 21/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=18.6][A
Epoch 21/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.30it/s, loss=18.6][A2025-05-19 01:21:41,273 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:41,308 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 21/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.30it/s, loss=17.3][A
Epoch 21/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.38it/s, loss=17.3][A2025-05-19 01:21:41,452 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:41,487 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 21/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.38it/s, loss=15.3][A
Epoch 21/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.25it/s, loss=15.3][A2025-05-19 01:21:41,625 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:41,633 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 21/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.25it/s, loss=2.61][AEpoch 21/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s, loss=2.61]
2025-05-19 01:21:41,869 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_20/gns_stats_epoch_20.json
2025-05-19 01:21:41,869 [INFO] trainers.pytorch_trainer: Epoch 20 GNS = 0.0000

Epoch 21/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:42,257 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:42,548 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 21/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=4.59][A
Epoch 21/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=4.59][A2025-05-19 01:21:42,583 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:42,616 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 21/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=4.25][AEpoch 21/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.45it/s, loss=4.25]
2025-05-19 01:21:42,697 [INFO] trainers.pytorch_trainer: Epoch 21/30 - 訓練損失: 13.4496, 驗證損失: 4.4214

Epoch 22/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:43,215 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:43,471 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 22/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=18.1][A
Epoch 22/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.03it/s, loss=18.1][A2025-05-19 01:21:43,669 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:43,707 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 22/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.03it/s, loss=15.4][A
Epoch 22/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.99it/s, loss=15.4][A2025-05-19 01:21:43,845 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:43,880 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 22/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.99it/s, loss=15.2][A
Epoch 22/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s, loss=15.2][A2025-05-19 01:21:44,015 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:44,025 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 22/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s, loss=7.94][AEpoch 22/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.77it/s, loss=7.94]
2025-05-19 01:21:44,264 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_21/gns_stats_epoch_21.json
2025-05-19 01:21:44,264 [INFO] trainers.pytorch_trainer: Epoch 21 GNS = 0.0000

Epoch 22/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:44,660 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:44,932 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 22/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=10.2][A
Epoch 22/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=10.2][A2025-05-19 01:21:44,967 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:45,002 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 22/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=16.6][AEpoch 22/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.50it/s, loss=16.6]
2025-05-19 01:21:45,078 [INFO] trainers.pytorch_trainer: Epoch 22/30 - 訓練損失: 14.1691, 驗證損失: 13.4380

Epoch 23/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:45,594 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:45,707 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 23/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=13.9][A
Epoch 23/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.24it/s, loss=13.9][A2025-05-19 01:21:45,889 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:45,925 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 23/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.24it/s, loss=22]  [A
Epoch 23/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.30it/s, loss=22][A2025-05-19 01:21:46,062 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:46,097 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 23/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.30it/s, loss=15.5][A
Epoch 23/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.18it/s, loss=15.5][A2025-05-19 01:21:46,233 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:46,242 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 23/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.18it/s, loss=21.8][AEpoch 23/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s, loss=21.8]
2025-05-19 01:21:46,481 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_22/gns_stats_epoch_22.json
2025-05-19 01:21:46,481 [INFO] trainers.pytorch_trainer: Epoch 22 GNS = 0.0000

Epoch 23/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:46,867 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:47,160 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 23/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=15.7][A
Epoch 23/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=15.7][A2025-05-19 01:21:47,196 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:47,228 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 23/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.41it/s, loss=25.2][AEpoch 23/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.46it/s, loss=25.2]
2025-05-19 01:21:47,306 [INFO] trainers.pytorch_trainer: Epoch 23/30 - 訓練損失: 18.3122, 驗證損失: 20.4197

Epoch 24/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:47,779 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:47,895 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 24/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=9.36][A
Epoch 24/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.30it/s, loss=9.36][A2025-05-19 01:21:48,076 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:48,111 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 24/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.30it/s, loss=16.8][A
Epoch 24/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.40it/s, loss=16.8][A2025-05-19 01:21:48,247 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:48,282 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 24/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.40it/s, loss=14.2][A
Epoch 24/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.29it/s, loss=14.2][A2025-05-19 01:21:48,417 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:48,429 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 24/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.29it/s, loss=4.24][AEpoch 24/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s, loss=4.24]
2025-05-19 01:21:48,674 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_23/gns_stats_epoch_23.json
2025-05-19 01:21:48,674 [INFO] trainers.pytorch_trainer: Epoch 23 GNS = 0.0000

Epoch 24/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:49,064 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:49,332 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 24/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=10.8][A
Epoch 24/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.45it/s, loss=10.8][A2025-05-19 01:21:49,368 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:49,400 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 24/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.45it/s, loss=8.67][AEpoch 24/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.52it/s, loss=8.67]
2025-05-19 01:21:49,480 [INFO] trainers.pytorch_trainer: Epoch 24/30 - 訓練損失: 11.1266, 驗證損失: 9.7153

Epoch 25/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:50,020 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:50,062 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 25/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=18.3][A
Epoch 25/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.32it/s, loss=18.3][A2025-05-19 01:21:50,244 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:50,279 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 25/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.32it/s, loss=21.1][A
Epoch 25/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.41it/s, loss=21.1][A2025-05-19 01:21:50,417 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:50,453 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 25/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.41it/s, loss=13.7][A
Epoch 25/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.29it/s, loss=13.7][A2025-05-19 01:21:50,589 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:50,600 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 25/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.29it/s, loss=35.4][AEpoch 25/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s, loss=35.4]
2025-05-19 01:21:50,845 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/gns_stats_epoch_24.json
2025-05-19 01:21:50,845 [INFO] trainers.pytorch_trainer: Epoch 24 GNS = 0.0000

Epoch 25/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:51,238 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:51,509 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 25/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=11.3][A
Epoch 25/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.44it/s, loss=11.3][A2025-05-19 01:21:51,545 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:51,577 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 25/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.44it/s, loss=18.5][AEpoch 25/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.51it/s, loss=18.5]
2025-05-19 01:21:51,962 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_24.pth
2025-05-19 01:21:51,963 [INFO] trainers.pytorch_trainer: Epoch 25/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_24.pth
2025-05-19 01:21:52,007 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:21:52,009 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:21:52,010 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:21:52,011 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:21:52,012 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,014 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,015 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,016 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,020 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,022 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,028 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,029 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,030 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,031 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:52,037 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:52,038 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:52,045 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:52,047 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,048 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,049 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,050 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,054 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,056 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,060 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,061 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,062 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,063 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:52,068 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:52,070 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:52,075 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:52,077 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:21:52,086 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:21:52,087 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:21:52,088 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,090 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,091 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,093 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,106 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,108 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,113 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,114 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,115 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,117 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:52,135 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:52,137 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:52,154 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:52,156 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,157 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,158 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,161 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,174 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,176 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,181 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,182 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,183 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,185 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:52,203 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:52,205 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:52,223 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:52,225 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:21:52,257 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:21:52,259 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:21:52,260 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,262 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,263 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,266 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,313 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,315 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,333 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,334 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,336 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,339 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:52,401 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:52,404 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:52,467 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:52,468 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,469 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,471 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,473 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,522 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,524 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,542 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,543 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,545 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,548 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:52,607 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:52,611 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:52,670 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:52,671 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,672 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,674 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,677 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,723 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,725 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,743 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,744 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,745 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,748 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:52,809 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:52,812 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:52,872 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:52,873 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:21:52,875 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:21:52,876 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:52,879 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:52,925 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:52,927 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:52,945 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:52,946 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:21:52,948 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:21:52,951 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:53,011 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:53,014 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:53,074 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:53,075 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:21:53,076 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:21:53,078 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:53,081 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:53,126 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:53,128 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:53,146 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:53,147 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:21:53,149 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:21:53,152 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:53,212 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:53,216 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:53,275 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:53,277 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:21:53,278 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:21:53,280 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:53,283 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:53,329 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:53,331 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:53,349 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:53,350 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:21:53,351 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:21:53,355 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:53,415 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:53,418 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:53,478 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:53,483 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:21:53,498 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:21:53,500 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:21:53,501 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:21:53,502 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:21:53,504 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:53,511 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:53,524 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:53,528 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:53,588 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:53,590 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:21:53,591 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:21:53,600 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:53,614 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:53,622 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:53,636 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:53,637 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:21:53,639 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:21:53,640 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:21:53,647 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:21:53,661 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:21:53,664 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:21:53,726 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:21:53,728 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:21:53,729 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:21:53,737 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:21:53,759 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:21:53,767 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:21:53,782 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:21:53,792 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_norm_weight_gradient_all.pt
2025-05-19 01:21:53,794 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_norm_bias_gradient_all.pt
2025-05-19 01:21:53,795 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/head_1_weight_gradient_all.pt
2025-05-19 01:21:53,797 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/head_1_bias_gradient_all.pt
2025-05-19 01:21:53,798 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:21:53,811 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:21:53,812 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:21:53,825 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:21:53,826 [INFO] trainers.pytorch_trainer: Epoch 24: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:21:57,750 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/gns_stats_epoch_24.json
2025-05-19 01:21:57,751 [INFO] trainers.pytorch_trainer: Epoch 25/30 - 訓練損失: 22.1372, 驗證損失: 14.8908

Epoch 26/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:21:58,233 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:58,323 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 26/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=15.5][A
Epoch 26/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.31it/s, loss=15.5][A2025-05-19 01:21:58,518 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:58,554 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 26/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.31it/s, loss=19]  [A
Epoch 26/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.40it/s, loss=19][A2025-05-19 01:21:58,692 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:58,729 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 26/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.40it/s, loss=12.2][A
Epoch 26/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.28it/s, loss=12.2][A2025-05-19 01:21:58,862 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:58,874 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 26/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.28it/s, loss=3.23][AEpoch 26/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s, loss=3.23]
2025-05-19 01:21:59,122 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_25/gns_stats_epoch_25.json
2025-05-19 01:21:59,122 [INFO] trainers.pytorch_trainer: Epoch 25 GNS = 0.0000

Epoch 26/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:21:59,517 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:59,793 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 26/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=11.5][A
Epoch 26/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=11.5][A2025-05-19 01:21:59,829 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:21:59,865 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 26/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.43it/s, loss=8.99][AEpoch 26/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.48it/s, loss=8.99]
2025-05-19 01:21:59,943 [INFO] trainers.pytorch_trainer: Epoch 26/30 - 訓練損失: 12.4753, 驗證損失: 10.2395

Epoch 27/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:00,431 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:00,637 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 27/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=18.4][A
Epoch 27/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.13it/s, loss=18.4][A2025-05-19 01:22:00,832 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:00,872 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 27/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.13it/s, loss=17.6][A
Epoch 27/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=17.6][A2025-05-19 01:22:01,022 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:01,054 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 27/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=22.1][A
Epoch 27/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.98it/s, loss=22.1][A2025-05-19 01:22:01,191 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:01,202 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 27/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.98it/s, loss=12.2][AEpoch 27/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s, loss=12.2]
2025-05-19 01:22:01,450 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_26/gns_stats_epoch_26.json
2025-05-19 01:22:01,450 [INFO] trainers.pytorch_trainer: Epoch 26 GNS = 0.0000

Epoch 27/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:01,849 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:02,136 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 27/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=9.7][A
Epoch 27/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=9.7][A2025-05-19 01:22:02,171 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:02,203 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 27/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.40it/s, loss=15.6][AEpoch 27/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.44it/s, loss=15.6]
2025-05-19 01:22:02,282 [INFO] trainers.pytorch_trainer: Epoch 27/30 - 訓練損失: 17.5639, 驗證損失: 12.6401

Epoch 28/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:02,787 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:02,884 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 28/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=16.3][A
Epoch 28/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.28it/s, loss=16.3][A2025-05-19 01:22:03,065 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:03,101 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 28/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.28it/s, loss=12.2][A
Epoch 28/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.36it/s, loss=12.2][A2025-05-19 01:22:03,239 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:03,274 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 28/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.36it/s, loss=12.3][A
Epoch 28/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.25it/s, loss=12.3][A2025-05-19 01:22:03,408 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:03,417 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 28/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.25it/s, loss=24.2][AEpoch 28/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s, loss=24.2]
2025-05-19 01:22:03,653 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_27/gns_stats_epoch_27.json
2025-05-19 01:22:03,653 [INFO] trainers.pytorch_trainer: Epoch 27 GNS = 0.0000

Epoch 28/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:04,053 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:04,326 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 28/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=7.78][A
Epoch 28/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.42it/s, loss=7.78][A2025-05-19 01:22:04,362 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:04,399 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 28/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.42it/s, loss=7.61][AEpoch 28/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.47it/s, loss=7.61]
2025-05-19 01:22:04,478 [INFO] trainers.pytorch_trainer: Epoch 28/30 - 訓練損失: 16.2486, 驗證損失: 7.6976

Epoch 29/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:04,963 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:05,032 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 29/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=19.5][A
Epoch 29/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.37it/s, loss=19.5][A2025-05-19 01:22:05,213 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:05,248 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 29/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.37it/s, loss=14.9][A
Epoch 29/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.47it/s, loss=14.9][A2025-05-19 01:22:05,389 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:05,439 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 29/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.47it/s, loss=19.1][A
Epoch 29/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.28it/s, loss=19.1][A2025-05-19 01:22:05,574 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:05,583 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 29/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.28it/s, loss=9.71][AEpoch 29/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s, loss=9.71]
2025-05-19 01:22:05,819 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_28/gns_stats_epoch_28.json
2025-05-19 01:22:05,819 [INFO] trainers.pytorch_trainer: Epoch 28 GNS = 0.0000

Epoch 29/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:06,215 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:06,483 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 29/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=10.7][A
Epoch 29/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.44it/s, loss=10.7][A2025-05-19 01:22:06,519 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:06,552 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 29/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.44it/s, loss=17.1][AEpoch 29/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.50it/s, loss=17.1]
2025-05-19 01:22:06,630 [INFO] trainers.pytorch_trainer: Epoch 29/30 - 訓練損失: 15.8121, 驗證損失: 13.8959

Epoch 30/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:07,140 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:07,192 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=14.9][A
Epoch 30/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.36it/s, loss=14.9][A2025-05-19 01:22:07,370 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:07,406 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.36it/s, loss=17.1][A
Epoch 30/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.47it/s, loss=17.1][A2025-05-19 01:22:07,543 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:07,578 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.47it/s, loss=17.3][A
Epoch 30/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.36it/s, loss=17.3][A2025-05-19 01:22:07,713 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:07,724 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.36it/s, loss=8.52][AEpoch 30/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s, loss=8.52]
2025-05-19 01:22:07,973 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/gns_stats_epoch_29.json
2025-05-19 01:22:07,973 [INFO] trainers.pytorch_trainer: Epoch 29 GNS = 0.0000

Epoch 30/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:08,382 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:08,659 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=7.85][A
Epoch 30/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.39it/s, loss=7.85][A2025-05-19 01:22:08,695 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:08,733 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.39it/s, loss=5.1] [AEpoch 30/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.42it/s, loss=5.1]
2025-05-19 01:22:09,124 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_29.pth
2025-05-19 01:22:09,124 [INFO] trainers.pytorch_trainer: Epoch 30/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_29.pth
2025-05-19 01:22:09,166 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:22:09,167 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:22:09,169 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:22:09,170 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:22:09,171 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:09,172 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:09,173 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:09,175 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:09,179 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:09,180 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:09,182 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:09,183 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:09,185 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:09,186 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:09,197 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:09,198 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:09,203 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:09,205 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:09,206 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:09,207 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:09,209 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:09,213 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:09,215 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:09,217 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:09,218 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:09,219 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:09,221 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:09,226 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:09,227 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:09,232 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:09,234 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:22:09,243 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:22:09,244 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:22:09,246 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:09,247 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:09,248 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:09,250 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:09,263 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:09,265 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:09,270 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:09,271 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:09,272 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:09,274 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:09,292 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:09,294 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:09,311 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:09,312 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:09,314 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:09,315 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:09,317 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:09,330 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:09,332 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:09,337 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:09,338 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:09,339 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:09,341 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:09,359 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:09,361 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:09,379 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:09,381 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:22:09,413 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:22:09,415 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:22:09,416 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:09,418 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:09,419 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:09,422 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:09,467 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:09,469 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:09,487 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:09,488 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:09,489 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:09,493 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:09,553 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:09,557 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:09,617 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:09,619 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:09,620 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:09,621 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:09,624 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:09,670 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:09,672 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:09,690 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:09,691 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:09,693 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:09,696 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:09,756 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:09,759 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:09,819 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:09,821 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:22:09,822 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:22:09,824 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:09,826 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:09,872 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:09,873 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:09,891 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:09,893 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:22:09,894 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:22:09,897 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:09,958 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:09,961 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:10,026 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:10,028 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:22:10,029 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:22:10,032 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:10,035 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:10,083 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:10,085 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:10,103 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:10,104 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:22:10,105 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:22:10,108 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:10,169 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:10,172 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:10,232 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:10,233 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:22:10,234 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:22:10,236 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:10,238 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:10,285 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:10,287 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:10,304 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:10,306 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:22:10,307 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:22:10,310 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:10,371 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:10,374 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:10,433 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:10,435 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:22:10,436 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:22:10,438 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:10,441 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:10,487 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:10,488 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:10,506 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:10,508 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:22:10,509 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:22:10,512 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:10,573 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:10,577 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:10,636 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:10,642 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:22:10,657 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:22:10,659 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:22:10,660 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:10,662 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:10,663 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:10,670 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:10,684 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:10,687 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:10,747 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:10,748 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:10,750 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:10,758 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:10,772 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:10,781 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:10,795 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:10,796 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:10,797 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:10,799 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:10,806 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:10,819 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:10,823 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:10,883 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:10,884 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:10,886 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:10,894 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:10,909 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:10,918 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:10,932 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:10,933 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_norm_weight_gradient_all.pt
2025-05-19 01:22:10,934 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_norm_bias_gradient_all.pt
2025-05-19 01:22:10,936 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/head_1_weight_gradient_all.pt
2025-05-19 01:22:10,937 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/head_1_bias_gradient_all.pt
2025-05-19 01:22:10,939 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:22:10,946 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:22:10,947 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:22:10,949 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:22:10,950 [INFO] trainers.pytorch_trainer: Epoch 29: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:22:14,736 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/gns_stats_epoch_29.json
2025-05-19 01:22:14,737 [INFO] trainers.pytorch_trainer: Epoch 30/30 - 訓練損失: 14.4625, 驗證損失: 6.4776
2025-05-19 01:22:14,737 [INFO] trainers.pytorch_trainer: 訓練完成，耗時: 104.92 秒
2025-05-19 01:22:15,084 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:22:15,091 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:22:15,091 [INFO] trainers.pytorch_trainer: 在測試集上評估最佳模型...

Epoch 30/30 [TEST]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:15,532 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:15,686 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [TEST]:   0%|          | 0/2 [00:00<?, ?it/s, loss=2.4][A
Epoch 30/30 [TEST]:  50%|█████     | 1/2 [00:00<00:00,  1.57it/s, loss=2.4][A2025-05-19 01:22:15,728 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:15,747 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [TEST]:  50%|█████     | 1/2 [00:00<00:00,  1.57it/s, loss=4.72][AEpoch 30/30 [TEST]: 100%|██████████| 2/2 [00:00<00:00,  2.80it/s, loss=4.72]
2025-05-19 01:22:15,812 [INFO] trainers.pytorch_trainer: 測試損失: 3.5605
2025-05-19 01:22:15,812 [INFO] trainers.pytorch_trainer: 測試 accuracy: 0.5417
2025-05-19 01:22:15,812 [INFO] trainers.pytorch_trainer: 測試 f1_score: 0.2342
2025-05-19 01:22:15,812 [INFO] trainers.pytorch_trainer: 測試 precision: 0.1806
2025-05-19 01:22:15,812 [INFO] trainers.pytorch_trainer: 測試 recall: 0.3333
Training:   0%|          | 0/30 [01:45<?, ?it/s]
2025-05-19 01:22:15,819 [INFO] __main__: 訓練器已創建
2025-05-19 01:22:15,819 [INFO] models.hook_bridge: ModelAnalyticsCallback 將使用 save_frequency: 5
2025-05-19 01:22:15,819 [INFO] models.hook_bridge: ModelAnalyticsCallback 將捕獲以下層的特徵向量: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:15,819 [INFO] models.hook_bridge:   計算餘弦相似度 (來自配置): True
2025-05-19 01:22:15,819 [INFO] models.hook_bridge:   計算t-SNE (來自配置): True
2025-05-19 01:22:15,819 [INFO] models.hook_bridge:   t-SNE Perplexity (來自配置): 30
2025-05-19 01:22:15,819 [INFO] utils.save_manager: 初始化存檔管理器，實驗目錄: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:22:15,819 [INFO] models.hook_bridge: 為回調創建了SaveManager，根目錄: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:22:15,819 [INFO] models.hook_bridge: 初始化模型分析回調，輸出目錄: results/indexed_classification_drlee_20250519_012024, 保存頻率: 5 epoch
2025-05-19 01:22:15,819 [INFO] models.hook_bridge: 將捕獲以下層的特徵向量: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:15,819 [INFO] models.hook_bridge:   計算餘弦相似度: True
2025-05-19 01:22:15,819 [INFO] models.hook_bridge:   計算t-SNE: True
2025-05-19 01:22:15,819 [INFO] models.hook_bridge:   t-SNE Perplexity: 30
2025-05-19 01:22:15,819 [INFO] models.hook_bridge: 已添加 EvaluationResultsHook 用於數據集: test
2025-05-19 01:22:15,819 [INFO] models.hook_bridge: 已添加 EvaluationResultsHook 用於數據集: val
2025-05-19 01:22:15,819 [INFO] trainers.pytorch_trainer: 添加回調: SimpleModelAnalyticsCallback
2025-05-19 01:22:15,819 [INFO] trainers.pytorch_trainer: 添加回調: EvaluationResultsHook
2025-05-19 01:22:15,819 [INFO] trainers.pytorch_trainer: 添加回調: EvaluationResultsHook
2025-05-19 01:22:15,819 [INFO] __main__: 已添加 3 個分析器回調
2025-05-19 01:22:15,820 [INFO] trainers.pytorch_trainer: 評估epoch追蹤已啟用
2025-05-19 01:22:15,820 [INFO] __main__: 啟用評估epoch追蹤，以支持特定epoch的特徵向量捕獲和其他功能
2025-05-19 01:22:15,820 [INFO] utils.save_manager: 初始化存檔管理器，實驗目錄: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:22:15,820 [INFO] models.hook_bridge: 已註冊 6 個激活值鉤子，監控層: ['backbone.features.0', 'backbone.features.2', 'backbone.features.4', 'backbone.features.5', 'head.1', 'skip_connection.2']
2025-05-19 01:22:15,820 [INFO] models.hook_bridge: 已註冊 6 個梯度鉤子，監控參數: ['head.1.weight', 'head.1.bias', 'skip_connection.0.weight', 'skip_connection.0.bias', 'skip_connection.2.weight', 'skip_connection.2.bias']
2025-05-19 01:22:15,821 [INFO] models.hook_bridge: 模型鉤子管理器已初始化
2025-05-19 01:22:15,821 [INFO] models.hook_bridge: 將捕獲以下層的特徵向量: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:15,821 [INFO] models.hook_bridge: 模型分析回調已初始化，輸出目錄設定為: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:22:15,821 [INFO] trainers.pytorch_trainer: 開始訓練，模型類型: swin_transformer
2025-05-19 01:22:15,821 [INFO] trainers.pytorch_trainer: 設備: cuda
2025-05-19 01:22:15,821 [INFO] utils.data_adapter: 模型類型 'swin_transformer' 與數據類型 'audio' 不兼容，使用 AdapterDataLoader 進行適配
2025-05-19 01:22:15,821 [INFO] models.hook_bridge: 從TensorBoard日誌獲取輸出目錄 (實驗根目錄): results/indexed_classification_drlee_20250519_012024
2025-05-19 01:22:15,821 [INFO] utils.save_manager: 初始化存檔管理器，實驗目錄: results/indexed_classification_drlee_20250519_012024
2025-05-19 01:22:15,821 [INFO] models.hook_bridge: 已註冊 6 個激活值鉤子，監控層: ['backbone.features.0', 'backbone.features.2', 'backbone.features.4', 'backbone.features.5', 'head.1', 'skip_connection.2']
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 已註冊 6 個梯度鉤子，監控參數: ['head.1.weight', 'head.1.bias', 'skip_connection.0.weight', 'skip_connection.0.bias', 'skip_connection.2.weight', 'skip_connection.2.bias']
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 模型鉤子管理器已初始化
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 將捕獲以下層的特徵向量: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 已移除所有激活值鉤子
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 已移除所有梯度鉤子
2025-05-19 01:22:15,822 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 已移除所有激活值鉤子
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 已移除所有梯度鉤子
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 模型分析回調已初始化，輸出目錄設定為: results/indexed_classification_drlee_20250519_012024
Training:   0%|          | 0/30 [00:00<?, ?it/s]2025-05-19 01:22:15,822 [INFO] trainers.pytorch_trainer: 監控指標: accuracy, 模式: max
2025-05-19 01:22:15,822 [INFO] models.hook_bridge: 開始 epoch 0

Epoch 1/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:16,279 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:16,396 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:16,400 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 0
2025-05-19 01:22:16,424 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:16,440 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:16,448 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:16,464 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:16,469 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:16,469 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:16,471 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:16,472 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:16,472 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:16,473 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:16,473 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:16,473 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 1/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=29][A2025-05-19 01:22:16,649 [DEBUG] models.hook_bridge: 更新批次數據: epoch=0, batch=0, loss=29.019329071044922
2025-05-19 01:22:16,649 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:16,649 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 1/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.21it/s, loss=29][A2025-05-19 01:22:16,650 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:16,690 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:16,696 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 0
2025-05-19 01:22:16,702 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:16,717 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:16,723 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:16,736 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:16,740 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:16,740 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:16,742 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:16,742 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:16,742 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:16,743 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:16,743 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:16,743 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 1/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.21it/s, loss=29.3][A2025-05-19 01:22:16,841 [DEBUG] models.hook_bridge: 更新批次數據: epoch=0, batch=1, loss=29.3305606842041
2025-05-19 01:22:16,841 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:16,841 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 1/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.21it/s, loss=29.3][A2025-05-19 01:22:16,841 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:16,876 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:16,879 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 0
2025-05-19 01:22:16,884 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:16,893 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:16,898 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:16,911 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:16,915 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:16,915 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:16,917 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:16,917 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:16,917 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:16,917 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:16,918 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:16,918 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 1/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.21it/s, loss=7.54][A2025-05-19 01:22:17,029 [DEBUG] models.hook_bridge: 更新批次數據: epoch=0, batch=2, loss=7.5391387939453125
2025-05-19 01:22:17,029 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:17,029 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 1/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.01it/s, loss=7.54][A2025-05-19 01:22:17,030 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:17,040 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:17,042 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 0
2025-05-19 01:22:17,043 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:17,047 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:17,051 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:17,059 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:17,061 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:17,062 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:17,063 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:17,063 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:17,064 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:17,064 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:17,064 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:17,064 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 1/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.01it/s, loss=23.7][A2025-05-19 01:22:17,123 [DEBUG] models.hook_bridge: 更新批次數據: epoch=0, batch=3, loss=23.73942756652832
2025-05-19 01:22:17,123 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:17,123 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 1/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s, loss=23.7]
2025-05-19 01:22:17,288 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_0/gns_stats_epoch_0.json
2025-05-19 01:22:17,288 [INFO] trainers.pytorch_trainer: Epoch 0 GNS = 0.0000
2025-05-19 01:22:17,291 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 0。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:17,292 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:17,292 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:17,292 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:17,292 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:17,292 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:17,292 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 0)
2025-05-19 01:22:17,292 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 0)

Epoch 1/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:17,719 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:18,031 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:18,038 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 0
2025-05-19 01:22:18,062 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:18,077 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:18,085 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:18,088 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:18,103 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:18,108 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:18,109 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:18,109 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:18,109 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 1/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=8.15][A2025-05-19 01:22:18,116 [DEBUG] models.hook_bridge: 更新批次數據: epoch=0, batch=0, loss=8.145625114440918
2025-05-19 01:22:18,116 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:18,116 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 1/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.22it/s, loss=8.15][A2025-05-19 01:22:18,117 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:18,150 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:18,156 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 0
2025-05-19 01:22:18,162 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:18,170 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:18,178 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:18,179 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:18,194 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:18,199 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:18,199 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:18,199 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:18,200 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 1/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.22it/s, loss=7]   [A2025-05-19 01:22:18,201 [DEBUG] models.hook_bridge: 更新批次數據: epoch=0, batch=1, loss=6.996192455291748
2025-05-19 01:22:18,201 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:18,201 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2
Epoch 1/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.11it/s, loss=7]
2025-05-19 01:22:18,247 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 0。將保存捕獲的特徵向量。
2025-05-19 01:22:18,247 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:18,247 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:18,247 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:18,247 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:18,247 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:18,247 [INFO] models.hook_bridge: 開始為 val (epoch 0) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:18,247 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:18,247 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:18,247 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:18,248 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:18,248 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:18,255 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:18,255 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:18,306 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:18,306 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:18,924 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:19,313 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:19,314 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:19,314 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:19,315 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:19,319 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:19,319 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:19,359 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:19,360 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:19,477 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:19,698 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:19,698 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:19,698 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:19,699 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_head_0_val_features.pt
2025-05-19 01:22:19,699 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_head_0_val_features.pt
2025-05-19 01:22:19,731 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:19,731 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:20,069 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:20,298 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_head_0_val_tsne.pt
2025-05-19 01:22:20,298 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_0/layer_head_0_val_tsne.pt
2025-05-19 01:22:20,298 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:20,298 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:20,298 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:20,298 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:20,299 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:20,299 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 0)。收集了 2 個批次的數據
2025-05-19 01:22:20,299 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:20,299 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:20,300 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:20,302 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 0
2025-05-19 01:22:20,302 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 0 檢測到驗證集 outputs 和 targets，準備保存 epoch_0_validation_predictions.pt
2025-05-19 01:22:20,302 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 0 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_0_validation_predictions.pt
2025-05-19 01:22:20,303 [INFO] trainers.pytorch_trainer: Epoch 1/30 - 訓練損失: 22.4071, 驗證損失: 7.5709
2025-05-19 01:22:20,303 [INFO] models.hook_bridge: 開始 epoch 1

Epoch 2/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:20,817 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:20,894 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:20,900 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 1
2025-05-19 01:22:20,906 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:20,923 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:20,930 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:20,948 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:20,953 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:20,953 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:20,955 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:20,956 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:20,956 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:20,957 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:20,957 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:20,957 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 2/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=16.7][A2025-05-19 01:22:21,134 [DEBUG] models.hook_bridge: 更新批次數據: epoch=1, batch=0, loss=16.749603271484375
2025-05-19 01:22:21,134 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:21,134 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 2/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.21it/s, loss=16.7][A2025-05-19 01:22:21,134 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:21,172 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:21,178 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 1
2025-05-19 01:22:21,182 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:21,193 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:21,202 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:21,220 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:21,224 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:21,224 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:21,226 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:21,226 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:21,226 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:21,226 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:21,227 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:21,227 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 2/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.21it/s, loss=18.3][A2025-05-19 01:22:21,342 [DEBUG] models.hook_bridge: 更新批次數據: epoch=1, batch=1, loss=18.296663284301758
2025-05-19 01:22:21,343 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:21,343 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 2/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.16it/s, loss=18.3][A2025-05-19 01:22:21,343 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:21,380 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:21,383 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 1
2025-05-19 01:22:21,385 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:21,394 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:21,399 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:21,412 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:21,415 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:21,416 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:21,417 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:21,417 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:21,417 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:21,418 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:21,418 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:21,418 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 2/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.16it/s, loss=25.5][A2025-05-19 01:22:21,516 [DEBUG] models.hook_bridge: 更新批次數據: epoch=1, batch=2, loss=25.471282958984375
2025-05-19 01:22:21,517 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:21,517 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 2/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.02it/s, loss=25.5][A2025-05-19 01:22:21,517 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:21,526 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:21,527 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 1
2025-05-19 01:22:21,528 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:21,531 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:21,535 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:21,544 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:21,546 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:21,546 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:21,548 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:21,548 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:21,548 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:21,549 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:21,549 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:21,549 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 2/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.02it/s, loss=24.2][A2025-05-19 01:22:21,608 [DEBUG] models.hook_bridge: 更新批次數據: epoch=1, batch=3, loss=24.178640365600586
2025-05-19 01:22:21,608 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:21,608 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 2/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s, loss=24.2]
2025-05-19 01:22:21,771 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_1/gns_stats_epoch_1.json
2025-05-19 01:22:21,771 [INFO] trainers.pytorch_trainer: Epoch 1 GNS = 0.0000
2025-05-19 01:22:21,775 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 1。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:21,775 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:21,775 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:21,776 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:21,776 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:21,776 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:21,777 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 1)
2025-05-19 01:22:21,777 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 1)

Epoch 2/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:22,204 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:22,508 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:22,515 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 1
2025-05-19 01:22:22,521 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:22,536 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:22,544 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:22,547 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:22,562 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:22,567 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:22,568 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:22,568 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:22,568 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 2/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=11][A2025-05-19 01:22:22,576 [DEBUG] models.hook_bridge: 更新批次數據: epoch=1, batch=0, loss=11.035831451416016
2025-05-19 01:22:22,576 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:22,576 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 2/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.25it/s, loss=11][A2025-05-19 01:22:22,576 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:22,609 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:22,615 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 1
2025-05-19 01:22:22,620 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:22,628 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:22,636 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:22,637 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:22,652 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:22,657 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:22,657 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:22,657 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:22,657 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 2/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.25it/s, loss=17.8][A2025-05-19 01:22:22,659 [DEBUG] models.hook_bridge: 更新批次數據: epoch=1, batch=1, loss=17.754899978637695
2025-05-19 01:22:22,659 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:22,659 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2
Epoch 2/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.18it/s, loss=17.8]
2025-05-19 01:22:22,703 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 1。將保存捕獲的特徵向量。
2025-05-19 01:22:22,703 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:22,703 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:22,703 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:22,704 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:22,704 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:22,704 [INFO] models.hook_bridge: 開始為 val (epoch 1) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:22,704 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:22,704 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:22,704 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:22,705 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:22,705 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:22,712 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:22,712 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:22,761 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:22,761 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:23,249 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:23,450 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:23,451 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:23,451 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:23,451 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:23,456 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:23,456 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:23,495 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:23,495 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:23,608 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:23,818 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:23,818 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:23,818 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:23,819 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_head_0_val_features.pt
2025-05-19 01:22:23,820 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_head_0_val_features.pt
2025-05-19 01:22:23,851 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:23,851 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:23,904 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:24,341 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_head_0_val_tsne.pt
2025-05-19 01:22:24,342 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_1/layer_head_0_val_tsne.pt
2025-05-19 01:22:24,342 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:24,342 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:24,342 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:24,342 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:24,342 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:24,342 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 1)。收集了 2 個批次的數據
2025-05-19 01:22:24,343 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:24,343 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:24,349 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:24,350 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 1
2025-05-19 01:22:24,350 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 1 檢測到驗證集 outputs 和 targets，準備保存 epoch_1_validation_predictions.pt
2025-05-19 01:22:24,351 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 1 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_1_validation_predictions.pt
2025-05-19 01:22:24,351 [INFO] trainers.pytorch_trainer: Epoch 2/30 - 訓練損失: 21.1740, 驗證損失: 14.3954
2025-05-19 01:22:24,352 [INFO] models.hook_bridge: 開始 epoch 2

Epoch 3/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:24,854 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:24,934 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:24,938 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 2
2025-05-19 01:22:24,945 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:24,961 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:24,969 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:24,987 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:24,991 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:24,991 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:24,994 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:24,994 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:24,994 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:24,995 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:24,995 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:24,995 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 3/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=19.3][A2025-05-19 01:22:25,180 [DEBUG] models.hook_bridge: 更新批次數據: epoch=2, batch=0, loss=19.313934326171875
2025-05-19 01:22:25,181 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:25,181 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 3/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.21it/s, loss=19.3][A2025-05-19 01:22:25,181 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:25,220 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:25,225 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 2
2025-05-19 01:22:25,231 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:25,241 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:25,249 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:25,264 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:25,268 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:25,268 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:25,269 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:25,270 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:25,270 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:25,270 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:25,271 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:25,271 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 3/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.21it/s, loss=20.7][A2025-05-19 01:22:25,380 [DEBUG] models.hook_bridge: 更新批次數據: epoch=2, batch=1, loss=20.67024803161621
2025-05-19 01:22:25,380 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:25,380 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 3/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.19it/s, loss=20.7][A2025-05-19 01:22:25,380 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:25,431 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:25,437 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 2
2025-05-19 01:22:25,443 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:25,451 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:25,457 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:25,469 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:25,473 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:25,473 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:25,475 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:25,475 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:25,475 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:25,475 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:25,476 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:25,476 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 3/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.19it/s, loss=17.8][A2025-05-19 01:22:25,575 [DEBUG] models.hook_bridge: 更新批次數據: epoch=2, batch=2, loss=17.83920669555664
2025-05-19 01:22:25,575 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:25,575 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 3/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.96it/s, loss=17.8][A2025-05-19 01:22:25,575 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:25,584 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:25,585 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 2
2025-05-19 01:22:25,586 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:25,590 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:25,594 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:25,602 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:25,604 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:25,605 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:25,606 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:25,606 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:25,607 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:25,607 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:25,607 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:25,608 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 3/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.96it/s, loss=11.7][A2025-05-19 01:22:25,666 [DEBUG] models.hook_bridge: 更新批次數據: epoch=2, batch=3, loss=11.702920913696289
2025-05-19 01:22:25,667 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:25,667 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 3/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s, loss=11.7]
2025-05-19 01:22:25,837 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_2/gns_stats_epoch_2.json
2025-05-19 01:22:25,838 [INFO] trainers.pytorch_trainer: Epoch 2 GNS = 0.0000
2025-05-19 01:22:25,842 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 2。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:25,843 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:25,843 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:25,843 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:25,844 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:25,844 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:25,844 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 2)
2025-05-19 01:22:25,844 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 2)

Epoch 3/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:26,258 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:26,574 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:26,581 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 2
2025-05-19 01:22:26,606 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:26,620 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:26,628 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:26,631 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:26,646 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:26,651 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:26,652 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:26,652 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:26,652 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 3/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=5.79][A2025-05-19 01:22:26,659 [DEBUG] models.hook_bridge: 更新批次數據: epoch=2, batch=0, loss=5.790063858032227
2025-05-19 01:22:26,659 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:26,660 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 3/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.23it/s, loss=5.79][A2025-05-19 01:22:26,660 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:26,693 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:26,698 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 2
2025-05-19 01:22:26,709 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:26,717 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:26,725 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:26,726 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:26,741 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:26,745 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:26,746 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:26,746 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:26,746 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 3/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.23it/s, loss=9.29][A2025-05-19 01:22:26,748 [DEBUG] models.hook_bridge: 更新批次數據: epoch=2, batch=1, loss=9.294207572937012
2025-05-19 01:22:26,748 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:26,748 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2
Epoch 3/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.12it/s, loss=9.29]
2025-05-19 01:22:26,795 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 2。將保存捕獲的特徵向量。
2025-05-19 01:22:26,796 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:26,796 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:26,796 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:26,796 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:26,796 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:26,796 [INFO] models.hook_bridge: 開始為 val (epoch 2) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:26,796 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:26,796 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:26,796 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:26,797 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:26,797 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:26,804 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:26,804 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:26,855 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:26,855 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:27,235 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:27,437 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:27,437 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:27,438 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:27,438 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:27,442 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:27,442 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:27,482 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:27,482 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:27,595 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:27,808 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:27,808 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:27,809 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:27,810 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_head_0_val_features.pt
2025-05-19 01:22:27,810 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_head_0_val_features.pt
2025-05-19 01:22:27,842 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:27,842 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:27,907 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:28,133 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_head_0_val_tsne.pt
2025-05-19 01:22:28,133 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_2/layer_head_0_val_tsne.pt
2025-05-19 01:22:28,133 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:28,133 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:28,133 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:28,133 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:28,133 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:28,134 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 2)。收集了 2 個批次的數據
2025-05-19 01:22:28,134 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:28,134 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:28,135 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:28,135 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 2
2025-05-19 01:22:28,136 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 2 檢測到驗證集 outputs 和 targets，準備保存 epoch_2_validation_predictions.pt
2025-05-19 01:22:28,137 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 2 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_2_validation_predictions.pt
2025-05-19 01:22:28,137 [INFO] trainers.pytorch_trainer: Epoch 3/30 - 訓練損失: 17.3816, 驗證損失: 7.5421
2025-05-19 01:22:28,137 [INFO] models.hook_bridge: 開始 epoch 3

Epoch 4/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:28,720 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:28,760 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:28,764 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 3
2025-05-19 01:22:28,787 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:28,803 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:28,811 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:28,829 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:28,833 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:28,833 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:28,836 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:28,836 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:28,836 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:28,837 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:28,837 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:28,837 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 4/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=20.9][A2025-05-19 01:22:29,019 [DEBUG] models.hook_bridge: 更新批次數據: epoch=3, batch=0, loss=20.86280059814453
2025-05-19 01:22:29,019 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:29,019 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 4/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.14it/s, loss=20.9][A2025-05-19 01:22:29,019 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:29,060 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:29,066 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 3
2025-05-19 01:22:29,071 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:29,080 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:29,088 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:29,104 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:29,107 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:29,108 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:29,109 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:29,109 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:29,110 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:29,110 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:29,110 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:29,110 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 4/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.14it/s, loss=15.6][A2025-05-19 01:22:29,216 [DEBUG] models.hook_bridge: 更新批次數據: epoch=3, batch=1, loss=15.553902626037598
2025-05-19 01:22:29,216 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:29,216 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 4/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=15.6][A2025-05-19 01:22:29,216 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:29,250 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:29,253 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 3
2025-05-19 01:22:29,259 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:29,268 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:29,273 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:29,286 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:29,289 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:29,289 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:29,291 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:29,291 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:29,291 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:29,292 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:29,292 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:29,292 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 4/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=13.4][A2025-05-19 01:22:29,392 [DEBUG] models.hook_bridge: 更新批次數據: epoch=3, batch=2, loss=13.401653289794922
2025-05-19 01:22:29,392 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:29,392 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 4/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.94it/s, loss=13.4][A2025-05-19 01:22:29,393 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:29,402 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:29,403 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 3
2025-05-19 01:22:29,404 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:29,409 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:29,413 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:29,421 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:29,423 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:29,424 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:29,425 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:29,425 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:29,426 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:29,426 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:29,426 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:29,426 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 4/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.94it/s, loss=8.99][A2025-05-19 01:22:29,485 [DEBUG] models.hook_bridge: 更新批次數據: epoch=3, batch=3, loss=8.986261367797852
2025-05-19 01:22:29,486 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:29,486 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 4/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s, loss=8.99]
2025-05-19 01:22:29,647 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_3/gns_stats_epoch_3.json
2025-05-19 01:22:29,648 [INFO] trainers.pytorch_trainer: Epoch 3 GNS = 0.0000
2025-05-19 01:22:29,651 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 3。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:29,652 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:29,652 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:29,652 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:29,652 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:29,655 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:29,655 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 3)
2025-05-19 01:22:29,655 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 3)

Epoch 4/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:30,060 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:30,409 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:30,423 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 3
2025-05-19 01:22:30,429 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:30,445 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:30,453 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:30,457 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:30,472 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:30,477 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:30,478 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:30,478 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:30,478 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 4/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=10.2][A2025-05-19 01:22:30,486 [DEBUG] models.hook_bridge: 更新批次數據: epoch=3, batch=0, loss=10.17236042022705
2025-05-19 01:22:30,486 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:30,486 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 4/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.21it/s, loss=10.2][A2025-05-19 01:22:30,486 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:30,526 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:30,532 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 3
2025-05-19 01:22:30,537 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:30,546 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:30,554 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:30,554 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:30,569 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:30,574 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:30,575 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:30,575 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:30,575 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 4/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.21it/s, loss=8.09][A2025-05-19 01:22:30,577 [DEBUG] models.hook_bridge: 更新批次數據: epoch=3, batch=1, loss=8.092214584350586
2025-05-19 01:22:30,577 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:30,577 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2
Epoch 4/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.09it/s, loss=8.09]
2025-05-19 01:22:30,622 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 3。將保存捕獲的特徵向量。
2025-05-19 01:22:30,622 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:30,622 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:30,622 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:30,622 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:30,622 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:30,623 [INFO] models.hook_bridge: 開始為 val (epoch 3) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:30,623 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:30,623 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:30,623 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:30,624 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:30,624 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:30,631 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:30,631 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:30,685 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:30,685 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:30,992 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:31,207 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:31,207 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:31,207 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:31,207 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:31,211 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:31,212 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:31,251 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:31,251 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:31,374 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:31,585 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:31,585 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:31,585 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:31,586 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_head_0_val_features.pt
2025-05-19 01:22:31,587 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_head_0_val_features.pt
2025-05-19 01:22:31,618 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:31,618 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:31,656 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:31,874 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_head_0_val_tsne.pt
2025-05-19 01:22:31,875 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_3/layer_head_0_val_tsne.pt
2025-05-19 01:22:31,875 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:31,875 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:31,875 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:31,875 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:31,875 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:31,876 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 3)。收集了 2 個批次的數據
2025-05-19 01:22:31,876 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:31,876 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:31,877 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:31,878 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 3
2025-05-19 01:22:31,879 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 3 檢測到驗證集 outputs 和 targets，準備保存 epoch_3_validation_predictions.pt
2025-05-19 01:22:31,879 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 3 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_3_validation_predictions.pt
2025-05-19 01:22:31,880 [INFO] trainers.pytorch_trainer: Epoch 4/30 - 訓練損失: 14.7012, 驗證損失: 9.1323
2025-05-19 01:22:31,880 [INFO] models.hook_bridge: 開始 epoch 4

Epoch 5/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:32,421 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:32,464 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:32,468 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 4
2025-05-19 01:22:32,475 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:32,491 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:32,499 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:32,517 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:32,521 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:32,521 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:32,524 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:32,524 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:32,524 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:32,525 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:32,525 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:32,525 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 5/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=9.73][A2025-05-19 01:22:32,711 [DEBUG] models.hook_bridge: 更新批次數據: epoch=4, batch=0, loss=9.730347633361816
2025-05-19 01:22:32,711 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:32,711 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 5/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.21it/s, loss=9.73][A2025-05-19 01:22:32,712 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:32,759 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:32,765 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 4
2025-05-19 01:22:32,771 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:32,780 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:32,788 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:32,804 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:32,808 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:32,808 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:32,810 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:32,810 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:32,810 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:32,810 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:32,811 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:32,811 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 5/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.21it/s, loss=20.8][A2025-05-19 01:22:32,931 [DEBUG] models.hook_bridge: 更新批次數據: epoch=4, batch=1, loss=20.783037185668945
2025-05-19 01:22:32,931 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:32,931 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 5/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.13it/s, loss=20.8][A2025-05-19 01:22:32,931 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:32,968 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:32,971 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 4
2025-05-19 01:22:32,976 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:32,985 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:32,990 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:33,006 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:33,009 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:33,009 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:33,011 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:33,011 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:33,011 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:33,012 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:33,012 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:33,012 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 5/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.13it/s, loss=11.3][A2025-05-19 01:22:33,108 [DEBUG] models.hook_bridge: 更新批次數據: epoch=4, batch=2, loss=11.291219711303711
2025-05-19 01:22:33,109 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:33,109 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 5/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.97it/s, loss=11.3][A2025-05-19 01:22:33,109 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:33,119 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:33,121 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 4
2025-05-19 01:22:33,122 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:33,125 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:33,129 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:33,138 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:33,141 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:33,141 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:33,142 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:33,142 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:33,143 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:33,143 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:33,143 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:33,143 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 5/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.97it/s, loss=13.3][A2025-05-19 01:22:33,200 [DEBUG] models.hook_bridge: 更新批次數據: epoch=4, batch=3, loss=13.258691787719727
2025-05-19 01:22:33,200 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:33,200 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 5/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s, loss=13.3]
2025-05-19 01:22:33,366 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/gns_stats_epoch_4.json
2025-05-19 01:22:33,367 [INFO] trainers.pytorch_trainer: Epoch 4 GNS = 0.0000
2025-05-19 01:22:33,370 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 4。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:33,370 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:33,370 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:33,370 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:33,371 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:33,371 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:33,371 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 4)
2025-05-19 01:22:33,371 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 4)

Epoch 5/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:33,774 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:34,071 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:34,078 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 4
2025-05-19 01:22:34,101 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:34,115 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:34,123 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:34,126 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:34,141 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:34,146 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:34,147 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:34,147 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:34,147 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 5/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=11.6][A2025-05-19 01:22:34,154 [DEBUG] models.hook_bridge: 更新批次數據: epoch=4, batch=0, loss=11.572977066040039
2025-05-19 01:22:34,154 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:34,155 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 5/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=11.6][A2025-05-19 01:22:34,155 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:34,187 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:34,193 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 4
2025-05-19 01:22:34,217 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:34,231 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:34,239 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:34,239 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:34,254 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:34,259 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:34,259 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:34,260 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:34,260 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 5/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=18.8][A2025-05-19 01:22:34,261 [DEBUG] models.hook_bridge: 更新批次數據: epoch=4, batch=1, loss=18.77545738220215
2025-05-19 01:22:34,261 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:34,262 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 5/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.60it/s, loss=18.8][AEpoch 5/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.16it/s, loss=18.8]
2025-05-19 01:22:34,307 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 4。將保存捕獲的特徵向量。
2025-05-19 01:22:34,307 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:34,307 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:34,307 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:34,307 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:34,307 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:34,307 [INFO] models.hook_bridge: 開始為 val (epoch 4) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:34,307 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:34,307 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:34,307 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:34,308 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:34,308 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:34,315 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:34,315 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:34,362 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:34,362 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:34,805 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:35,049 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:35,049 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:35,050 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:35,050 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:35,054 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:35,054 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:35,104 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:35,105 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:35,368 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:35,656 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:35,656 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:35,656 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:35,658 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_head_0_val_features.pt
2025-05-19 01:22:35,658 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_head_0_val_features.pt
2025-05-19 01:22:35,704 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:35,704 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:35,938 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:36,159 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_head_0_val_tsne.pt
2025-05-19 01:22:36,159 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_4/layer_head_0_val_tsne.pt
2025-05-19 01:22:36,159 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:36,160 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:36,160 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:36,160 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:36,160 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:36,160 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 4)。收集了 2 個批次的數據
2025-05-19 01:22:36,160 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:36,160 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:36,161 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:37,107 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_4.pth
2025-05-19 01:22:37,107 [INFO] trainers.pytorch_trainer: Epoch 5/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_4.pth
2025-05-19 01:22:37,140 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:22:37,146 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:22:37,147 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:22:37,148 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:22:37,150 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:37,151 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:37,152 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:37,154 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:37,158 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:37,160 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:37,163 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:37,164 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:37,166 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:37,167 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:37,172 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:37,174 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:37,182 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:37,184 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:37,185 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:37,186 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:37,188 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:37,192 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:37,194 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:37,196 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:37,197 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:37,198 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:37,200 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:37,213 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:37,215 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:37,228 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:37,229 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:22:37,239 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:22:37,240 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:22:37,242 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:37,243 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:37,245 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:37,246 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:37,260 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:37,262 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:37,267 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:37,269 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:37,270 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:37,272 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:37,290 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:37,292 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:37,310 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:37,311 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:37,312 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:37,314 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:37,316 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:37,329 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:37,331 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:37,336 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:37,338 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:37,339 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:37,341 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:37,359 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:37,361 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:37,379 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:37,381 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:22:37,414 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:22:37,415 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:22:37,417 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:37,419 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:37,420 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:37,423 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:37,469 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:37,471 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:37,489 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:37,491 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:37,492 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:37,496 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:37,556 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:37,560 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:37,621 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:37,627 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:37,632 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:37,634 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:37,637 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:37,684 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:37,686 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:37,704 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:37,705 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:37,707 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:37,711 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:37,771 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:37,775 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:37,835 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:37,837 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:22:37,838 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:22:37,840 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:37,843 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:37,890 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:37,892 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:37,910 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:37,912 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:22:37,914 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:22:37,917 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:37,977 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:37,981 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:38,040 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:38,042 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:22:38,043 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:22:38,045 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:38,048 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:38,094 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:38,096 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:38,114 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:38,115 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:22:38,117 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:22:38,121 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:38,180 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:38,184 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:38,244 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:38,245 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:22:38,247 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:22:38,248 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:38,252 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:38,298 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:38,300 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:38,318 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:38,319 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:22:38,321 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:22:38,324 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:38,385 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:38,389 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:38,449 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:38,451 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:22:38,452 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:22:38,454 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:38,457 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:38,503 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:38,505 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:38,523 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:38,525 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:22:38,526 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:22:38,530 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:38,590 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:38,594 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:38,653 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:38,659 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:22:38,675 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:22:38,677 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:22:38,678 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:22:38,680 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:22:38,681 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:38,703 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:38,716 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:38,721 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:38,781 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:38,783 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:22:38,785 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:22:38,795 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:38,809 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:38,820 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:38,840 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:38,844 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:22:38,847 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:22:38,850 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:22:38,859 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:22:38,878 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:22:38,894 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:22:38,966 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:22:38,969 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:22:38,972 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:22:38,983 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:22:38,998 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:22:39,010 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:22:39,025 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:22:39,031 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_norm_weight_gradient_all.pt
2025-05-19 01:22:39,035 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/backbone_norm_bias_gradient_all.pt
2025-05-19 01:22:39,039 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/head_1_weight_gradient_all.pt
2025-05-19 01:22:39,042 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/head_1_bias_gradient_all.pt
2025-05-19 01:22:39,044 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:22:39,053 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:22:39,055 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:22:39,058 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:22:39,059 [INFO] trainers.pytorch_trainer: Epoch 4: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:22:42,828 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/gns_stats_epoch_4.json
2025-05-19 01:22:42,828 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 4
2025-05-19 01:22:42,828 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 4 檢測到驗證集 outputs 和 targets，準備保存 epoch_4_validation_predictions.pt
2025-05-19 01:22:42,829 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 4 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4_validation_predictions.pt
2025-05-19 01:22:42,829 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 4 達到保存頻率，調用 save_manager.save_epoch_summary
2025-05-19 01:22:42,830 [INFO] utils.save_manager: Epoch 4 摘要已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_4/epoch_summary.pt
2025-05-19 01:22:42,830 [INFO] trainers.pytorch_trainer: Epoch 5/30 - 訓練損失: 13.7658, 驗證損失: 15.1742
2025-05-19 01:22:42,830 [INFO] models.hook_bridge: 開始 epoch 5

Epoch 6/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:43,365 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:43,403 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:43,407 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 5
2025-05-19 01:22:43,430 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:43,442 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:43,451 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:43,469 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:43,474 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:43,474 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:43,476 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:43,476 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:43,477 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:43,477 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:43,478 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:43,478 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 6/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=21.7][A2025-05-19 01:22:43,636 [DEBUG] models.hook_bridge: 更新批次數據: epoch=5, batch=0, loss=21.661758422851562
2025-05-19 01:22:43,636 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:43,636 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 6/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.24it/s, loss=21.7][A2025-05-19 01:22:43,636 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:43,675 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:43,678 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 5
2025-05-19 01:22:43,684 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:43,697 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:43,703 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:43,716 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:43,720 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:43,720 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:43,722 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:43,722 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:43,722 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:43,723 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:43,723 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:43,723 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 6/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.24it/s, loss=18.5][A2025-05-19 01:22:43,832 [DEBUG] models.hook_bridge: 更新批次數據: epoch=5, batch=1, loss=18.45442771911621
2025-05-19 01:22:43,832 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:43,832 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 6/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.24it/s, loss=18.5][A2025-05-19 01:22:43,833 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:43,870 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:43,874 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 5
2025-05-19 01:22:43,880 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:43,888 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:43,894 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:43,906 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:43,910 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:43,910 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:43,911 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:43,912 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:43,912 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:43,912 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:43,912 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:43,912 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 6/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.24it/s, loss=13.3][A2025-05-19 01:22:44,014 [DEBUG] models.hook_bridge: 更新批次數據: epoch=5, batch=2, loss=13.25827407836914
2025-05-19 01:22:44,014 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:44,014 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 6/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.07it/s, loss=13.3][A2025-05-19 01:22:44,014 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:44,023 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:44,024 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 5
2025-05-19 01:22:44,025 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:44,029 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:44,032 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:44,041 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:44,043 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:44,043 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:44,045 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:44,045 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:44,045 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:44,045 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:44,046 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:44,046 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 6/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.07it/s, loss=5.97][A2025-05-19 01:22:44,103 [DEBUG] models.hook_bridge: 更新批次數據: epoch=5, batch=3, loss=5.967992305755615
2025-05-19 01:22:44,103 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:44,103 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 6/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s, loss=5.97]
2025-05-19 01:22:44,265 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_5/gns_stats_epoch_5.json
2025-05-19 01:22:44,265 [INFO] trainers.pytorch_trainer: Epoch 5 GNS = 0.0000
2025-05-19 01:22:44,268 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 5。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:44,268 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:44,269 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:44,269 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:44,269 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:44,273 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:44,273 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 5)
2025-05-19 01:22:44,273 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 5)

Epoch 6/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:44,673 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:44,945 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:44,951 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 5
2025-05-19 01:22:44,974 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:44,988 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:44,996 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:45,000 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:45,015 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:45,020 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:45,020 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:45,020 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:45,021 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 6/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=3.74][A2025-05-19 01:22:45,028 [DEBUG] models.hook_bridge: 更新批次數據: epoch=5, batch=0, loss=3.7361538410186768
2025-05-19 01:22:45,028 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:45,028 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 6/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.33it/s, loss=3.74][A2025-05-19 01:22:45,028 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:45,066 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:45,071 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 5
2025-05-19 01:22:45,077 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:45,086 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:45,092 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:45,093 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:45,105 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:45,110 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:45,111 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:45,111 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:45,111 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 6/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.33it/s, loss=2.92][A2025-05-19 01:22:45,118 [DEBUG] models.hook_bridge: 更新批次數據: epoch=5, batch=1, loss=2.9154889583587646
2025-05-19 01:22:45,118 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:45,119 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2
Epoch 6/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.27it/s, loss=2.92]
2025-05-19 01:22:45,164 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 5。將保存捕獲的特徵向量。
2025-05-19 01:22:45,164 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:45,164 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:45,164 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:45,164 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:45,164 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:45,164 [INFO] models.hook_bridge: 開始為 val (epoch 5) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:45,164 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:45,164 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:45,164 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:45,165 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:45,165 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:45,172 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:45,172 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:45,221 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:45,221 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:45,679 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:45,936 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:45,936 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:45,938 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:45,938 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:45,941 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:45,941 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:45,984 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:45,984 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:46,279 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:46,497 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:46,497 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:46,498 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:46,498 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_head_0_val_features.pt
2025-05-19 01:22:46,499 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_head_0_val_features.pt
2025-05-19 01:22:46,529 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:46,529 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:46,793 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:47,016 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_head_0_val_tsne.pt
2025-05-19 01:22:47,016 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_5/layer_head_0_val_tsne.pt
2025-05-19 01:22:47,016 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:47,016 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:47,016 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:47,016 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:47,016 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:47,017 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 5)。收集了 2 個批次的數據
2025-05-19 01:22:47,017 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:47,017 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:47,018 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:47,370 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:22:47,377 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:22:47,377 [INFO] trainers.pytorch_trainer: Epoch 6/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:22:47,377 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 5
2025-05-19 01:22:47,377 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 5 檢測到驗證集 outputs 和 targets，準備保存 epoch_5_validation_predictions.pt
2025-05-19 01:22:47,378 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 5 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_5_validation_predictions.pt
2025-05-19 01:22:47,378 [INFO] trainers.pytorch_trainer: Epoch 6/30 - 訓練損失: 14.8356, 驗證損失: 3.3258
2025-05-19 01:22:47,378 [INFO] models.hook_bridge: 開始 epoch 6

Epoch 7/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:47,921 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:47,977 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:47,981 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 6
2025-05-19 01:22:48,004 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:48,020 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:48,028 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:48,046 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:48,050 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:48,051 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:48,053 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,053 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:48,054 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:48,054 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:48,055 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,055 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 7/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=8.23][A2025-05-19 01:22:48,212 [DEBUG] models.hook_bridge: 更新批次數據: epoch=6, batch=0, loss=8.231378555297852
2025-05-19 01:22:48,212 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:48,212 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 7/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.20it/s, loss=8.23][A2025-05-19 01:22:48,212 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:48,253 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:48,257 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 6
2025-05-19 01:22:48,263 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:48,273 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:48,282 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:48,297 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:48,301 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:48,302 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:48,303 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,303 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:48,304 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:48,304 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:48,304 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,304 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 7/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.20it/s, loss=19.5][A2025-05-19 01:22:48,425 [DEBUG] models.hook_bridge: 更新批次數據: epoch=6, batch=1, loss=19.51627540588379
2025-05-19 01:22:48,425 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:48,425 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 7/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.14it/s, loss=19.5][A2025-05-19 01:22:48,425 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:48,458 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:48,461 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 6
2025-05-19 01:22:48,467 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:48,477 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:48,482 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:48,495 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:48,498 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:48,499 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:48,500 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,500 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:48,500 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:48,501 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:48,501 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,501 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 7/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.14it/s, loss=19.2][A2025-05-19 01:22:48,602 [DEBUG] models.hook_bridge: 更新批次數據: epoch=6, batch=2, loss=19.240097045898438
2025-05-19 01:22:48,602 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:48,602 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 7/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.98it/s, loss=19.2][A2025-05-19 01:22:48,602 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:48,611 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:48,614 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 6
2025-05-19 01:22:48,615 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:48,622 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:48,625 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:48,633 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:48,635 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:48,635 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:48,637 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,637 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:48,637 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:48,638 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:48,638 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:48,638 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 7/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.98it/s, loss=13.7][A2025-05-19 01:22:48,696 [DEBUG] models.hook_bridge: 更新批次數據: epoch=6, batch=3, loss=13.711650848388672
2025-05-19 01:22:48,696 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:48,696 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 7/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s, loss=13.7]
2025-05-19 01:22:48,859 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_6/gns_stats_epoch_6.json
2025-05-19 01:22:48,859 [INFO] trainers.pytorch_trainer: Epoch 6 GNS = 0.0000
2025-05-19 01:22:48,862 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 6。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:48,862 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:48,863 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:48,863 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:48,863 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:48,863 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:48,863 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 6)
2025-05-19 01:22:48,863 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 6)

Epoch 7/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:49,265 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:49,571 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:49,578 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 6
2025-05-19 01:22:49,601 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:49,615 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:49,624 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:49,627 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:49,642 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:49,647 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:49,648 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:49,648 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:49,648 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 7/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=6.14][A2025-05-19 01:22:49,656 [DEBUG] models.hook_bridge: 更新批次數據: epoch=6, batch=0, loss=6.143410682678223
2025-05-19 01:22:49,656 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:49,656 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 7/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=6.14][A2025-05-19 01:22:49,656 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:49,725 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:49,731 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 6
2025-05-19 01:22:49,755 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:49,764 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:49,772 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:49,773 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:49,788 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:49,793 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:49,793 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:49,793 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:49,794 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 7/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=5.85][A2025-05-19 01:22:49,795 [DEBUG] models.hook_bridge: 更新批次數據: epoch=6, batch=1, loss=5.846268177032471
2025-05-19 01:22:49,795 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:49,795 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 7/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.45it/s, loss=5.85][AEpoch 7/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.06it/s, loss=5.85]
2025-05-19 01:22:49,845 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 6。將保存捕獲的特徵向量。
2025-05-19 01:22:49,845 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:49,845 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:49,845 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:49,845 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:49,845 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:49,845 [INFO] models.hook_bridge: 開始為 val (epoch 6) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:49,845 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:49,845 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:49,845 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:49,846 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:49,846 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:49,853 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:49,853 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:49,905 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:49,905 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:50,308 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:50,513 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:50,513 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:50,514 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:50,514 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:50,518 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:50,518 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:50,558 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:50,558 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:50,665 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:50,874 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:50,874 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:50,874 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:50,876 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_head_0_val_features.pt
2025-05-19 01:22:50,876 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_head_0_val_features.pt
2025-05-19 01:22:50,907 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:50,907 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:50,945 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:51,167 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_head_0_val_tsne.pt
2025-05-19 01:22:51,167 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_6/layer_head_0_val_tsne.pt
2025-05-19 01:22:51,167 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:51,168 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:51,168 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:51,168 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:51,168 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:51,168 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 6)。收集了 2 個批次的數據
2025-05-19 01:22:51,168 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:51,169 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:51,169 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:51,170 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 6
2025-05-19 01:22:51,171 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 6 檢測到驗證集 outputs 和 targets，準備保存 epoch_6_validation_predictions.pt
2025-05-19 01:22:51,172 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 6 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_6_validation_predictions.pt
2025-05-19 01:22:51,172 [INFO] trainers.pytorch_trainer: Epoch 7/30 - 訓練損失: 15.1749, 驗證損失: 5.9948
2025-05-19 01:22:51,173 [INFO] models.hook_bridge: 開始 epoch 7

Epoch 8/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:51,673 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:51,763 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:51,769 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 7
2025-05-19 01:22:51,793 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:51,809 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:51,817 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:51,835 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:51,840 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:51,840 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:51,842 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:51,843 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:51,843 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:51,844 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:51,844 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:51,844 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 8/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=8.3][A2025-05-19 01:22:52,014 [DEBUG] models.hook_bridge: 更新批次數據: epoch=7, batch=0, loss=8.301997184753418
2025-05-19 01:22:52,014 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:52,014 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 8/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.19it/s, loss=8.3][A2025-05-19 01:22:52,015 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:52,052 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:52,056 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 7
2025-05-19 01:22:52,062 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:52,072 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:52,079 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:52,095 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:52,099 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:52,099 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:52,101 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:52,101 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:52,101 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:52,102 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:52,102 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:52,102 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 8/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.19it/s, loss=10.8][A2025-05-19 01:22:52,217 [DEBUG] models.hook_bridge: 更新批次數據: epoch=7, batch=1, loss=10.831063270568848
2025-05-19 01:22:52,217 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:52,217 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 8/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.15it/s, loss=10.8][A2025-05-19 01:22:52,218 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:52,264 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:52,267 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 7
2025-05-19 01:22:52,273 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:52,283 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:52,289 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:52,302 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:52,305 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:52,306 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:52,307 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:52,307 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:52,308 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:52,308 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:52,308 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:52,308 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 8/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.15it/s, loss=19.9][A2025-05-19 01:22:52,410 [DEBUG] models.hook_bridge: 更新批次數據: epoch=7, batch=2, loss=19.944011688232422
2025-05-19 01:22:52,410 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:52,410 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 8/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.94it/s, loss=19.9][A2025-05-19 01:22:52,411 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:52,419 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:52,421 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 7
2025-05-19 01:22:52,422 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:52,428 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:52,432 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:52,439 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:52,442 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:52,442 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:52,443 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:52,444 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:52,444 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:52,444 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:52,444 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:52,444 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 8/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.94it/s, loss=9.34][A2025-05-19 01:22:52,503 [DEBUG] models.hook_bridge: 更新批次數據: epoch=7, batch=3, loss=9.3406982421875
2025-05-19 01:22:52,504 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:52,504 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 8/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s, loss=9.34]
2025-05-19 01:22:52,668 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_7/gns_stats_epoch_7.json
2025-05-19 01:22:52,668 [INFO] trainers.pytorch_trainer: Epoch 7 GNS = 0.0000
2025-05-19 01:22:52,671 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 7。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:52,672 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:52,672 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:52,672 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:52,672 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:52,674 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:52,675 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 7)
2025-05-19 01:22:52,675 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 7)

Epoch 8/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:53,082 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:53,379 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:53,385 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 7
2025-05-19 01:22:53,409 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:53,423 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:53,431 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:53,435 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:53,450 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:53,455 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:53,455 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:53,455 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:53,456 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 8/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=9.57][A2025-05-19 01:22:53,463 [DEBUG] models.hook_bridge: 更新批次數據: epoch=7, batch=0, loss=9.56633186340332
2025-05-19 01:22:53,463 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:53,463 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 8/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.27it/s, loss=9.57][A2025-05-19 01:22:53,464 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:53,498 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:53,504 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 7
2025-05-19 01:22:53,527 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:53,538 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:53,546 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:53,547 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:53,562 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:53,567 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:53,567 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:53,567 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:53,567 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 8/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.27it/s, loss=15.6][A2025-05-19 01:22:53,569 [DEBUG] models.hook_bridge: 更新批次數據: epoch=7, batch=1, loss=15.571805000305176
2025-05-19 01:22:53,569 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:53,569 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 8/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.59it/s, loss=15.6][AEpoch 8/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.14it/s, loss=15.6]
2025-05-19 01:22:53,618 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 7。將保存捕獲的特徵向量。
2025-05-19 01:22:53,618 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:53,618 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:53,618 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:53,618 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:53,619 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:53,619 [INFO] models.hook_bridge: 開始為 val (epoch 7) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:53,619 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:53,619 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:53,619 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:53,620 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:53,620 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:53,627 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:53,627 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:53,675 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:53,675 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:54,111 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:54,318 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:54,318 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:54,319 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:54,319 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:54,323 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:54,324 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:54,363 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:54,363 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:54,484 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:54,691 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:54,692 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:54,692 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:54,693 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_head_0_val_features.pt
2025-05-19 01:22:54,693 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_head_0_val_features.pt
2025-05-19 01:22:54,725 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:54,725 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:54,948 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:55,173 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_head_0_val_tsne.pt
2025-05-19 01:22:55,173 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_7/layer_head_0_val_tsne.pt
2025-05-19 01:22:55,173 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:55,173 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:55,174 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:55,174 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:55,174 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:55,174 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 7)。收集了 2 個批次的數據
2025-05-19 01:22:55,174 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:55,174 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:55,175 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:55,177 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 7
2025-05-19 01:22:55,177 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 7 檢測到驗證集 outputs 和 targets，準備保存 epoch_7_validation_predictions.pt
2025-05-19 01:22:55,178 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 7 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_7_validation_predictions.pt
2025-05-19 01:22:55,178 [INFO] trainers.pytorch_trainer: Epoch 8/30 - 訓練損失: 12.1044, 驗證損失: 12.5691
2025-05-19 01:22:55,178 [INFO] models.hook_bridge: 開始 epoch 8

Epoch 9/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:55,711 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:55,751 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:55,755 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 8
2025-05-19 01:22:55,762 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:55,779 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:55,786 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:55,804 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:55,809 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:55,809 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:55,811 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:55,812 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:55,812 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:55,813 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:55,813 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:55,813 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 9/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=17.6][A2025-05-19 01:22:55,978 [DEBUG] models.hook_bridge: 更新批次數據: epoch=8, batch=0, loss=17.645896911621094
2025-05-19 01:22:55,978 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:55,978 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 9/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.26it/s, loss=17.6][A2025-05-19 01:22:55,978 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:56,016 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:56,022 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 8
2025-05-19 01:22:56,028 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:56,037 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:56,045 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:56,058 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:56,061 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:56,062 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:56,063 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:56,063 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:56,064 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:56,064 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:56,064 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:56,064 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 9/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.26it/s, loss=12.3][A2025-05-19 01:22:56,172 [DEBUG] models.hook_bridge: 更新批次數據: epoch=8, batch=1, loss=12.324615478515625
2025-05-19 01:22:56,172 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:56,172 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 9/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.26it/s, loss=12.3][A2025-05-19 01:22:56,172 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:56,213 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:56,217 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 8
2025-05-19 01:22:56,222 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:56,231 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:56,237 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:56,250 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:56,253 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:56,253 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:56,255 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:56,255 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:56,255 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:56,256 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:56,256 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:56,256 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 9/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.26it/s, loss=12.8][A2025-05-19 01:22:56,355 [DEBUG] models.hook_bridge: 更新批次數據: epoch=8, batch=2, loss=12.81158447265625
2025-05-19 01:22:56,355 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:56,355 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 9/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.09it/s, loss=12.8][A2025-05-19 01:22:56,356 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:56,366 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:56,367 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 8
2025-05-19 01:22:56,368 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:22:56,372 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:22:56,376 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:56,385 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:22:56,387 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:56,388 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:22:56,389 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:56,389 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:56,390 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:56,390 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:56,390 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:56,390 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 9/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.09it/s, loss=25.1][A2025-05-19 01:22:56,450 [DEBUG] models.hook_bridge: 更新批次數據: epoch=8, batch=3, loss=25.125720977783203
2025-05-19 01:22:56,450 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:22:56,450 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 9/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s, loss=25.1]
2025-05-19 01:22:56,622 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_8/gns_stats_epoch_8.json
2025-05-19 01:22:56,622 [INFO] trainers.pytorch_trainer: Epoch 8 GNS = 0.0000
2025-05-19 01:22:56,626 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 8。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:22:56,626 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:56,626 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:56,627 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:56,627 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:22:56,628 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:22:56,628 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 8)
2025-05-19 01:22:56,628 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 8)

Epoch 9/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:22:57,044 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:57,337 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:57,348 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 8
2025-05-19 01:22:57,368 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:57,382 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:57,390 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:57,394 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:57,409 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:57,414 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:57,414 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:57,415 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:57,415 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 9/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=4.5][A2025-05-19 01:22:57,422 [DEBUG] models.hook_bridge: 更新批次數據: epoch=8, batch=0, loss=4.4969048500061035
2025-05-19 01:22:57,422 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:57,423 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 9/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=4.5][A2025-05-19 01:22:57,423 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:57,456 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:57,461 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 8
2025-05-19 01:22:57,484 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:57,493 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:57,501 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:57,501 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:57,516 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:57,521 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:22:57,522 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:22:57,522 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:57,522 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 9/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=3.46][A2025-05-19 01:22:57,524 [DEBUG] models.hook_bridge: 更新批次數據: epoch=8, batch=1, loss=3.460235834121704
2025-05-19 01:22:57,524 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:22:57,524 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 9/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.59it/s, loss=3.46][AEpoch 9/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.14it/s, loss=3.46]
2025-05-19 01:22:57,569 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 8。將保存捕獲的特徵向量。
2025-05-19 01:22:57,569 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:22:57,569 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:22:57,569 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:22:57,569 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:57,569 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:57,569 [INFO] models.hook_bridge: 開始為 val (epoch 8) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:22:57,569 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:22:57,569 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:22:57,569 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:22:57,570 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:22:57,570 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:57,577 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:57,578 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_4_val_features.pt
2025-05-19 01:22:57,631 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:57,631 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:22:58,099 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:58,384 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:58,384 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:22:58,385 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:22:58,385 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:58,389 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:58,389 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_7_val_features.pt
2025-05-19 01:22:58,429 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:58,429 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:22:58,543 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:58,775 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:58,775 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:22:58,775 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:22:58,776 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_head_0_val_features.pt
2025-05-19 01:22:58,777 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_head_0_val_features.pt
2025-05-19 01:22:58,810 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:58,810 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:22:59,063 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:22:59,288 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_head_0_val_tsne.pt
2025-05-19 01:22:59,288 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_8/layer_head_0_val_tsne.pt
2025-05-19 01:22:59,288 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:22:59,288 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:22:59,289 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:22:59,289 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:22:59,289 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:22:59,289 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 8)。收集了 2 個批次的數據
2025-05-19 01:22:59,289 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:22:59,289 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:22:59,290 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:22:59,292 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 8
2025-05-19 01:22:59,292 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 8 檢測到驗證集 outputs 和 targets，準備保存 epoch_8_validation_predictions.pt
2025-05-19 01:22:59,293 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 8 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_8_validation_predictions.pt
2025-05-19 01:22:59,294 [INFO] trainers.pytorch_trainer: Epoch 9/30 - 訓練損失: 16.9770, 驗證損失: 3.9786
2025-05-19 01:22:59,294 [INFO] models.hook_bridge: 開始 epoch 9

Epoch 10/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:22:59,773 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:22:59,923 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:22:59,931 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 9
2025-05-19 01:22:59,938 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:22:59,954 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:22:59,963 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:59,981 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:22:59,986 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:59,986 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:22:59,988 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:59,988 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:22:59,989 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:22:59,989 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:22:59,990 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:22:59,990 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 10/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=10.6][A2025-05-19 01:23:00,154 [DEBUG] models.hook_bridge: 更新批次數據: epoch=9, batch=0, loss=10.551997184753418
2025-05-19 01:23:00,154 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:00,154 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 10/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.17it/s, loss=10.6][A2025-05-19 01:23:00,154 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:00,191 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:00,197 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 9
2025-05-19 01:23:00,203 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:00,212 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:00,220 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:00,232 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:00,236 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:00,236 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:00,238 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:00,238 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:00,238 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:00,239 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:00,239 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:00,239 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 10/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.17it/s, loss=14.9][A2025-05-19 01:23:00,342 [DEBUG] models.hook_bridge: 更新批次數據: epoch=9, batch=1, loss=14.859504699707031
2025-05-19 01:23:00,342 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:00,342 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 10/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.16it/s, loss=14.9][A2025-05-19 01:23:00,342 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:00,402 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:00,405 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 9
2025-05-19 01:23:00,410 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:00,419 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:00,424 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:00,437 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:00,440 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:00,441 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:00,442 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:00,442 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:00,443 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:00,443 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:00,443 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:00,443 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 10/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.16it/s, loss=19.6][A2025-05-19 01:23:00,552 [DEBUG] models.hook_bridge: 更新批次數據: epoch=9, batch=2, loss=19.624372482299805
2025-05-19 01:23:00,552 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:00,552 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 10/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.88it/s, loss=19.6][A2025-05-19 01:23:00,552 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:00,561 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:00,562 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 9
2025-05-19 01:23:00,563 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:00,567 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:00,571 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:00,579 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:00,581 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:00,581 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:00,583 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:00,583 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:00,583 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:00,584 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:00,584 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:00,584 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 10/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.88it/s, loss=9.27][A2025-05-19 01:23:00,640 [DEBUG] models.hook_bridge: 更新批次數據: epoch=9, batch=3, loss=9.268579483032227
2025-05-19 01:23:00,640 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:00,640 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 10/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s, loss=9.27]
2025-05-19 01:23:00,802 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/gns_stats_epoch_9.json
2025-05-19 01:23:00,802 [INFO] trainers.pytorch_trainer: Epoch 9 GNS = 0.0000
2025-05-19 01:23:00,805 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 9。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:00,805 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:00,805 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:00,806 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:00,806 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:00,806 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:00,807 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 9)
2025-05-19 01:23:00,807 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 9)

Epoch 10/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:01,231 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:01,541 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:01,547 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 9
2025-05-19 01:23:01,570 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:01,584 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:01,592 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:01,596 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:01,611 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:01,616 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:01,616 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:01,617 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:01,617 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 10/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=8.18][A2025-05-19 01:23:01,624 [DEBUG] models.hook_bridge: 更新批次數據: epoch=9, batch=0, loss=8.184917449951172
2025-05-19 01:23:01,624 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:01,625 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 10/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.22it/s, loss=8.18][A2025-05-19 01:23:01,625 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:01,658 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:01,663 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 9
2025-05-19 01:23:01,686 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:01,695 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:01,703 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:01,703 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:01,718 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:01,723 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:01,723 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:01,724 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:01,724 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 10/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.22it/s, loss=13.2][A2025-05-19 01:23:01,725 [DEBUG] models.hook_bridge: 更新批次數據: epoch=9, batch=1, loss=13.183147430419922
2025-05-19 01:23:01,725 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:01,725 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 10/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.53it/s, loss=13.2][AEpoch 10/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.09it/s, loss=13.2]
2025-05-19 01:23:01,772 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 9。將保存捕獲的特徵向量。
2025-05-19 01:23:01,772 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:01,773 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:01,773 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:01,773 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:01,773 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:01,773 [INFO] models.hook_bridge: 開始為 val (epoch 9) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:01,773 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:01,773 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:01,773 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:01,774 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:01,774 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:01,781 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:01,781 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:01,832 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:01,832 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:02,302 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:02,510 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:02,510 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:02,511 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:02,511 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:02,515 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:02,515 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:02,558 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:02,558 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:02,749 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:02,967 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:02,968 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:02,968 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:02,969 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_head_0_val_features.pt
2025-05-19 01:23:02,969 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_head_0_val_features.pt
2025-05-19 01:23:03,002 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:03,002 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:03,308 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:03,534 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_head_0_val_tsne.pt
2025-05-19 01:23:03,534 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_9/layer_head_0_val_tsne.pt
2025-05-19 01:23:03,534 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:03,535 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:03,535 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:03,535 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:03,535 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:03,535 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 9)。收集了 2 個批次的數據
2025-05-19 01:23:03,535 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:03,535 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:03,535 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:04,484 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_9.pth
2025-05-19 01:23:04,484 [INFO] trainers.pytorch_trainer: Epoch 10/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_9.pth
2025-05-19 01:23:04,519 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:23:04,521 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:23:04,522 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:23:04,523 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:23:04,525 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:04,526 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:04,527 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:04,529 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:04,535 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:04,537 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:04,539 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:04,540 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:04,541 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:04,543 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:04,550 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:04,551 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:04,557 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:04,558 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:04,559 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:04,561 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:04,562 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:04,566 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:04,568 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:04,570 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:04,571 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:04,572 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:04,574 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:04,579 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:04,581 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:04,586 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:04,587 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:23:04,597 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:23:04,598 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:23:04,599 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:04,601 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:04,602 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:04,604 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:04,618 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:04,619 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:04,625 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:04,626 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:04,627 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:04,629 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:04,647 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:04,649 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:04,667 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:04,668 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:04,670 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:04,671 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:04,673 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:04,686 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:04,688 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:04,693 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:04,694 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:04,696 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:04,698 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:04,828 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:04,840 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:04,932 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:04,935 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:23:04,969 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:23:04,971 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:23:04,973 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:04,975 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:04,976 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:04,983 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:05,029 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:05,031 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:05,049 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:05,051 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:05,052 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:05,056 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:05,116 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:05,120 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:05,180 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:05,181 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:05,183 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:05,184 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:05,187 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:05,241 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:05,243 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:05,263 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:05,265 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:05,266 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:05,270 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:05,335 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:05,339 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:05,400 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:05,402 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:23:05,403 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:23:05,405 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:05,408 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:05,460 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:05,462 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:05,480 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:05,482 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:23:05,483 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:23:05,487 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:05,548 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:05,552 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:05,613 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:05,621 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:23:05,622 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:23:05,624 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:05,627 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:05,675 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:05,677 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:05,695 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:05,697 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:23:05,698 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:23:05,702 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:05,762 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:05,766 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:05,826 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:05,827 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:23:05,829 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:23:05,830 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:05,833 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:05,883 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:05,885 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:05,906 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:05,908 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:23:05,909 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:23:05,913 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:05,974 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:05,977 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:06,037 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:06,039 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:23:06,041 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:23:06,042 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:06,046 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:06,093 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:06,095 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:06,113 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:06,115 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:23:06,116 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:23:06,120 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:06,180 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:06,184 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:06,244 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:06,250 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:23:06,265 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:23:06,266 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:23:06,268 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:06,270 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:06,271 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:06,286 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:06,300 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:06,304 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:06,365 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:06,367 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:06,368 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:06,379 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:06,395 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:06,420 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:06,434 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:06,436 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:06,437 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:06,439 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:06,449 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:06,464 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:06,469 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:06,530 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:06,533 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:06,536 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:06,547 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:06,562 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:06,574 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:06,589 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:06,591 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_norm_weight_gradient_all.pt
2025-05-19 01:23:06,594 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/backbone_norm_bias_gradient_all.pt
2025-05-19 01:23:06,596 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/head_1_weight_gradient_all.pt
2025-05-19 01:23:06,599 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/head_1_bias_gradient_all.pt
2025-05-19 01:23:06,601 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:23:06,610 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:23:06,612 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:23:06,614 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:23:06,616 [INFO] trainers.pytorch_trainer: Epoch 9: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:23:10,385 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/gns_stats_epoch_9.json
2025-05-19 01:23:10,385 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 9
2025-05-19 01:23:10,386 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 9 檢測到驗證集 outputs 和 targets，準備保存 epoch_9_validation_predictions.pt
2025-05-19 01:23:10,386 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 9 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9_validation_predictions.pt
2025-05-19 01:23:10,387 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 9 達到保存頻率，調用 save_manager.save_epoch_summary
2025-05-19 01:23:10,387 [INFO] utils.save_manager: Epoch 9 摘要已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_9/epoch_summary.pt
2025-05-19 01:23:10,388 [INFO] trainers.pytorch_trainer: Epoch 10/30 - 訓練損失: 13.5761, 驗證損失: 10.6840
2025-05-19 01:23:10,388 [INFO] models.hook_bridge: 開始 epoch 10

Epoch 11/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:10,895 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:10,939 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:10,943 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 10
2025-05-19 01:23:10,966 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:10,982 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:10,989 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:11,007 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:11,011 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:11,012 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:11,014 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,014 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:11,014 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:11,015 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:11,015 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,016 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 11/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=22.2][A2025-05-19 01:23:11,177 [DEBUG] models.hook_bridge: 更新批次數據: epoch=10, batch=0, loss=22.182697296142578
2025-05-19 01:23:11,177 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:11,177 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 11/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.27it/s, loss=22.2][A2025-05-19 01:23:11,178 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:11,215 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:11,218 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 10
2025-05-19 01:23:11,224 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:11,233 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:11,238 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:11,251 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:11,254 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:11,255 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:11,256 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,256 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:11,257 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:11,257 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:11,257 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,257 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 11/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.27it/s, loss=11.9][A2025-05-19 01:23:11,380 [DEBUG] models.hook_bridge: 更新批次數據: epoch=10, batch=1, loss=11.944286346435547
2025-05-19 01:23:11,380 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:11,380 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 11/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.25it/s, loss=11.9][A2025-05-19 01:23:11,381 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:11,419 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:11,422 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 10
2025-05-19 01:23:11,427 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:11,436 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:11,441 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:11,454 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:11,457 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:11,458 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:11,459 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,459 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:11,459 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:11,460 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:11,460 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,460 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 11/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.25it/s, loss=20.1][A2025-05-19 01:23:11,556 [DEBUG] models.hook_bridge: 更新批次數據: epoch=10, batch=2, loss=20.14021110534668
2025-05-19 01:23:11,556 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:11,556 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 11/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.11it/s, loss=20.1][A2025-05-19 01:23:11,556 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:11,565 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:11,566 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 10
2025-05-19 01:23:11,567 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:11,571 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:11,574 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:11,582 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:11,585 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:11,585 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:11,587 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,587 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:11,587 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:11,587 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:11,587 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:11,588 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 11/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.11it/s, loss=29.6][A2025-05-19 01:23:11,647 [DEBUG] models.hook_bridge: 更新批次數據: epoch=10, batch=3, loss=29.610572814941406
2025-05-19 01:23:11,647 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:11,647 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 11/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s, loss=29.6]
2025-05-19 01:23:11,810 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_10/gns_stats_epoch_10.json
2025-05-19 01:23:11,810 [INFO] trainers.pytorch_trainer: Epoch 10 GNS = 0.0000
2025-05-19 01:23:11,813 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 10。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:11,813 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:11,814 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:11,814 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:11,814 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:11,814 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:11,814 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 10)
2025-05-19 01:23:11,814 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 10)

Epoch 11/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:12,223 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:12,523 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:12,530 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 10
2025-05-19 01:23:12,553 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:12,568 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:12,576 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:12,579 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:12,594 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:12,599 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:12,600 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:12,600 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:12,600 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 11/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=9.38][A2025-05-19 01:23:12,608 [DEBUG] models.hook_bridge: 更新批次數據: epoch=10, batch=0, loss=9.378726959228516
2025-05-19 01:23:12,608 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:12,608 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 11/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=9.38][A2025-05-19 01:23:12,608 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:12,641 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:12,647 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 10
2025-05-19 01:23:12,670 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:12,679 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:12,687 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:12,687 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:12,702 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:12,707 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:12,708 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:12,708 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:12,708 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 11/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=6.64][A2025-05-19 01:23:12,710 [DEBUG] models.hook_bridge: 更新批次數據: epoch=10, batch=1, loss=6.639073371887207
2025-05-19 01:23:12,710 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:12,710 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 11/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.59it/s, loss=6.64][AEpoch 11/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.14it/s, loss=6.64]
2025-05-19 01:23:12,758 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 10。將保存捕獲的特徵向量。
2025-05-19 01:23:12,758 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:12,758 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:12,758 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:12,758 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:12,758 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:12,758 [INFO] models.hook_bridge: 開始為 val (epoch 10) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:12,758 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:12,759 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:12,759 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:12,759 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:12,760 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:12,767 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:12,767 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:12,815 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:12,815 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:13,116 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:13,324 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:13,325 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:13,325 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:13,325 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:13,330 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:13,330 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:13,371 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:13,372 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:13,532 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:13,757 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:13,757 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:13,758 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:13,759 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_head_0_val_features.pt
2025-05-19 01:23:13,759 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_head_0_val_features.pt
2025-05-19 01:23:13,791 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:13,791 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:14,047 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:14,268 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_head_0_val_tsne.pt
2025-05-19 01:23:14,268 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_10/layer_head_0_val_tsne.pt
2025-05-19 01:23:14,269 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:14,269 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:14,269 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:14,269 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:14,269 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:14,269 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 10)。收集了 2 個批次的數據
2025-05-19 01:23:14,269 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:14,270 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:14,271 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:14,271 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 10
2025-05-19 01:23:14,272 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 10 檢測到驗證集 outputs 和 targets，準備保存 epoch_10_validation_predictions.pt
2025-05-19 01:23:14,273 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 10 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_10_validation_predictions.pt
2025-05-19 01:23:14,273 [INFO] trainers.pytorch_trainer: Epoch 11/30 - 訓練損失: 20.9694, 驗證損失: 8.0089
2025-05-19 01:23:14,274 [INFO] models.hook_bridge: 開始 epoch 11

Epoch 12/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:14,803 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:14,883 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:14,890 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 11
2025-05-19 01:23:14,913 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:14,929 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:14,936 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:14,955 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:14,959 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:14,960 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:14,962 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:14,962 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:14,962 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:14,963 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:14,963 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:14,963 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 12/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=19.4][A2025-05-19 01:23:15,129 [DEBUG] models.hook_bridge: 更新批次數據: epoch=11, batch=0, loss=19.42307472229004
2025-05-19 01:23:15,129 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:15,129 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 12/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.18it/s, loss=19.4][A2025-05-19 01:23:15,129 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:15,167 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:15,170 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 11
2025-05-19 01:23:15,176 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:15,186 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:15,192 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:15,209 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:15,213 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:15,213 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:15,215 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:15,215 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:15,215 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:15,216 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:15,216 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:15,216 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 12/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.18it/s, loss=17.3][A2025-05-19 01:23:15,328 [DEBUG] models.hook_bridge: 更新批次數據: epoch=11, batch=1, loss=17.261459350585938
2025-05-19 01:23:15,328 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:15,328 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 12/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.14it/s, loss=17.3][A2025-05-19 01:23:15,328 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:15,363 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:15,366 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 11
2025-05-19 01:23:15,372 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:15,382 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:15,388 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:15,400 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:15,404 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:15,404 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:15,406 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:15,406 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:15,406 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:15,406 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:15,407 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:15,407 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 12/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.14it/s, loss=8.11][A2025-05-19 01:23:15,505 [DEBUG] models.hook_bridge: 更新批次數據: epoch=11, batch=2, loss=8.109213829040527
2025-05-19 01:23:15,506 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:15,506 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 12/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.98it/s, loss=8.11][A2025-05-19 01:23:15,506 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:15,515 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:15,517 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 11
2025-05-19 01:23:15,518 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:15,522 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:15,525 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:15,534 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:15,537 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:15,537 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:15,538 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:15,539 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:15,539 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:15,539 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:15,539 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:15,539 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 12/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.98it/s, loss=20.3][A2025-05-19 01:23:15,650 [DEBUG] models.hook_bridge: 更新批次數據: epoch=11, batch=3, loss=20.259733200073242
2025-05-19 01:23:15,650 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:15,650 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 12/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.85it/s, loss=20.3][AEpoch 12/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s, loss=20.3]
2025-05-19 01:23:15,819 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_11/gns_stats_epoch_11.json
2025-05-19 01:23:15,819 [INFO] trainers.pytorch_trainer: Epoch 11 GNS = 0.0000
2025-05-19 01:23:15,822 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 11。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:15,822 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:15,822 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:15,823 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:15,823 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:15,825 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:15,825 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 11)
2025-05-19 01:23:15,825 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 11)

Epoch 12/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:16,229 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:16,523 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:16,529 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 11
2025-05-19 01:23:16,552 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:16,565 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:16,573 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:16,577 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:16,592 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:16,597 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:16,597 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:16,597 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:16,598 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 12/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=5.96][A2025-05-19 01:23:16,605 [DEBUG] models.hook_bridge: 更新批次數據: epoch=11, batch=0, loss=5.955316066741943
2025-05-19 01:23:16,605 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:16,605 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 12/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=5.96][A2025-05-19 01:23:16,606 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:16,645 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:16,651 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 11
2025-05-19 01:23:16,674 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:16,682 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:16,690 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:16,691 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:16,706 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:16,711 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:16,711 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:16,711 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:16,712 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 12/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=9.52][A2025-05-19 01:23:16,713 [DEBUG] models.hook_bridge: 更新批次數據: epoch=11, batch=1, loss=9.523486137390137
2025-05-19 01:23:16,713 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:16,713 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 12/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.60it/s, loss=9.52][AEpoch 12/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.16it/s, loss=9.52]
2025-05-19 01:23:16,761 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 11。將保存捕獲的特徵向量。
2025-05-19 01:23:16,761 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:16,761 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:16,761 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:16,761 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:16,762 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:16,762 [INFO] models.hook_bridge: 開始為 val (epoch 11) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:16,762 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:16,762 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:16,762 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:16,763 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:16,763 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:16,770 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:16,770 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:16,818 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:16,818 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:17,276 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:17,475 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:17,475 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:17,475 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:17,475 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:17,479 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:17,479 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:17,519 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:17,519 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:17,640 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:17,921 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:17,921 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:17,922 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:17,923 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_head_0_val_features.pt
2025-05-19 01:23:17,923 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_head_0_val_features.pt
2025-05-19 01:23:17,955 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:17,955 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:18,219 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:18,489 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_head_0_val_tsne.pt
2025-05-19 01:23:18,489 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_11/layer_head_0_val_tsne.pt
2025-05-19 01:23:18,489 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:18,489 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:18,489 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:18,489 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:18,489 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:18,489 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 11)。收集了 2 個批次的數據
2025-05-19 01:23:18,489 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:18,489 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:18,490 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:18,490 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 11
2025-05-19 01:23:18,491 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 11 檢測到驗證集 outputs 和 targets，準備保存 epoch_11_validation_predictions.pt
2025-05-19 01:23:18,491 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 11 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_11_validation_predictions.pt
2025-05-19 01:23:18,492 [INFO] trainers.pytorch_trainer: Epoch 12/30 - 訓練損失: 16.2634, 驗證損失: 7.7394
2025-05-19 01:23:18,492 [INFO] models.hook_bridge: 開始 epoch 12

Epoch 13/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:19,020 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:19,064 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:19,068 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 12
2025-05-19 01:23:19,091 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:19,107 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:19,114 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:19,132 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:19,137 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:19,137 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:19,139 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,140 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:19,140 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:19,141 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:19,141 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,141 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 13/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=21.1][A2025-05-19 01:23:19,301 [DEBUG] models.hook_bridge: 更新批次數據: epoch=12, batch=0, loss=21.056468963623047
2025-05-19 01:23:19,301 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:19,301 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 13/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.24it/s, loss=21.1][A2025-05-19 01:23:19,302 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:19,338 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:19,342 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 12
2025-05-19 01:23:19,348 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:19,358 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:19,365 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:19,379 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:19,383 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:19,383 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:19,385 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,385 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:19,385 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:19,386 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:19,386 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,386 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 13/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.24it/s, loss=20.1][A2025-05-19 01:23:19,497 [DEBUG] models.hook_bridge: 更新批次數據: epoch=12, batch=1, loss=20.105215072631836
2025-05-19 01:23:19,497 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:19,497 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 13/30 [Train]:  50%|█████     | 2/4 [00:00<00:00,  2.24it/s, loss=20.1][A2025-05-19 01:23:19,497 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:19,536 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:19,539 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 12
2025-05-19 01:23:19,545 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:19,555 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:19,561 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:19,576 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:19,580 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:19,580 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:19,582 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,582 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:19,582 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:19,582 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:19,583 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,583 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 13/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.24it/s, loss=21.6][A2025-05-19 01:23:19,684 [DEBUG] models.hook_bridge: 更新批次數據: epoch=12, batch=2, loss=21.615814208984375
2025-05-19 01:23:19,684 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:19,684 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 13/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.05it/s, loss=21.6][A2025-05-19 01:23:19,684 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:19,694 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:19,695 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 12
2025-05-19 01:23:19,696 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:19,700 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:19,703 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:19,711 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:19,714 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:19,714 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:19,715 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,716 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:19,716 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:19,716 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:19,716 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:19,716 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 13/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.05it/s, loss=21.7][A2025-05-19 01:23:19,775 [DEBUG] models.hook_bridge: 更新批次數據: epoch=12, batch=3, loss=21.74374008178711
2025-05-19 01:23:19,775 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:19,775 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 13/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s, loss=21.7]
2025-05-19 01:23:19,952 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_12/gns_stats_epoch_12.json
2025-05-19 01:23:19,952 [INFO] trainers.pytorch_trainer: Epoch 12 GNS = 0.0000
2025-05-19 01:23:19,956 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 12。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:19,956 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:19,956 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:19,957 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:19,957 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:19,957 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:19,957 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 12)
2025-05-19 01:23:19,957 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 12)

Epoch 13/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:20,360 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:20,665 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:20,672 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 12
2025-05-19 01:23:20,696 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:20,710 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:20,716 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:20,720 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:20,735 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:20,740 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:20,740 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:20,741 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:20,741 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 13/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=3.42][A2025-05-19 01:23:20,748 [DEBUG] models.hook_bridge: 更新批次數據: epoch=12, batch=0, loss=3.4151268005371094
2025-05-19 01:23:20,748 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:20,749 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 13/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.27it/s, loss=3.42][A2025-05-19 01:23:20,749 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:20,786 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:20,791 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 12
2025-05-19 01:23:20,814 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:20,823 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:20,831 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:20,831 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:20,846 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:20,852 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:20,852 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:20,852 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:20,852 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 13/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.27it/s, loss=3.08][A2025-05-19 01:23:20,854 [DEBUG] models.hook_bridge: 更新批次數據: epoch=12, batch=1, loss=3.078416109085083
2025-05-19 01:23:20,854 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:20,854 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 13/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.58it/s, loss=3.08][AEpoch 13/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.14it/s, loss=3.08]
2025-05-19 01:23:20,901 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 12。將保存捕獲的特徵向量。
2025-05-19 01:23:20,901 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:20,901 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:20,901 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:20,902 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:20,902 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:20,902 [INFO] models.hook_bridge: 開始為 val (epoch 12) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:20,902 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:20,902 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:20,902 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:20,903 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:20,903 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:20,910 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:20,910 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:20,958 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:20,958 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:21,425 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:21,627 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:21,627 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:21,627 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:21,627 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:21,631 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:21,631 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:21,671 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:21,671 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:21,777 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:21,986 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:21,986 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:21,986 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:21,987 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_head_0_val_features.pt
2025-05-19 01:23:21,987 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_head_0_val_features.pt
2025-05-19 01:23:22,019 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:22,019 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:22,257 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:22,486 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_head_0_val_tsne.pt
2025-05-19 01:23:22,486 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_12/layer_head_0_val_tsne.pt
2025-05-19 01:23:22,486 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:22,486 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:22,487 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:22,487 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:22,487 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:22,487 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 12)。收集了 2 個批次的數據
2025-05-19 01:23:22,487 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:22,487 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:22,488 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:22,877 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:23:22,884 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:23:22,884 [INFO] trainers.pytorch_trainer: Epoch 13/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:23:22,884 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 12
2025-05-19 01:23:22,884 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 12 檢測到驗證集 outputs 和 targets，準備保存 epoch_12_validation_predictions.pt
2025-05-19 01:23:22,885 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 12 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_12_validation_predictions.pt
2025-05-19 01:23:22,885 [INFO] trainers.pytorch_trainer: Epoch 13/30 - 訓練損失: 21.1303, 驗證損失: 3.2468
2025-05-19 01:23:22,885 [INFO] models.hook_bridge: 開始 epoch 13

Epoch 14/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:23,431 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:23,471 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:23,474 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 13
2025-05-19 01:23:23,498 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:23,513 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:23,522 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:23,539 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:23,543 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:23,543 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:23,546 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:23,546 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:23,546 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:23,547 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:23,547 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:23,547 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 14/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=14.5][A2025-05-19 01:23:23,732 [DEBUG] models.hook_bridge: 更新批次數據: epoch=13, batch=0, loss=14.484954833984375
2025-05-19 01:23:23,732 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:23,732 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 14/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.18it/s, loss=14.5][A2025-05-19 01:23:23,732 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:23,769 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:23,775 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 13
2025-05-19 01:23:23,798 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:23,807 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:23,815 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:23,828 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:23,832 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:23,832 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:23,834 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:23,834 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:23,834 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:23,835 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:23,835 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:23,835 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 14/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.18it/s, loss=11]  [A2025-05-19 01:23:24,018 [DEBUG] models.hook_bridge: 更新批次數據: epoch=13, batch=1, loss=10.98979377746582
2025-05-19 01:23:24,019 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:24,019 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 14/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.94it/s, loss=11][A2025-05-19 01:23:24,019 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:24,054 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:24,057 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 13
2025-05-19 01:23:24,063 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:24,073 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:24,079 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:24,091 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:24,095 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:24,095 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:24,097 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:24,097 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:24,097 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:24,098 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:24,098 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:24,098 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 14/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.94it/s, loss=12.9][A2025-05-19 01:23:24,200 [DEBUG] models.hook_bridge: 更新批次數據: epoch=13, batch=2, loss=12.924001693725586
2025-05-19 01:23:24,200 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:24,200 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 14/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.75it/s, loss=12.9][A2025-05-19 01:23:24,200 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:24,210 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:24,211 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 13
2025-05-19 01:23:24,212 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:24,216 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:24,220 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:24,229 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:24,231 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:24,232 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:24,233 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:24,233 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:24,234 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:24,234 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:24,234 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:24,234 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 14/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.75it/s, loss=14]  [A2025-05-19 01:23:24,364 [DEBUG] models.hook_bridge: 更新批次數據: epoch=13, batch=3, loss=13.996145248413086
2025-05-19 01:23:24,364 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:24,365 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 14/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.51it/s, loss=14][AEpoch 14/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.63it/s, loss=14]
2025-05-19 01:23:24,533 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_13/gns_stats_epoch_13.json
2025-05-19 01:23:24,533 [INFO] trainers.pytorch_trainer: Epoch 13 GNS = 0.0000
2025-05-19 01:23:24,536 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 13。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:24,536 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:24,536 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:24,537 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:24,537 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:24,541 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:24,541 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 13)
2025-05-19 01:23:24,541 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 13)

Epoch 14/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:24,974 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:25,268 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:25,274 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 13
2025-05-19 01:23:25,297 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:25,312 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:25,319 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:25,323 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:25,338 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:25,343 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:25,343 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:25,344 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:25,344 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 14/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=3.86][A2025-05-19 01:23:25,351 [DEBUG] models.hook_bridge: 更新批次數據: epoch=13, batch=0, loss=3.856348752975464
2025-05-19 01:23:25,351 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:25,351 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 14/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=3.86][A2025-05-19 01:23:25,351 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:25,387 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:25,393 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 13
2025-05-19 01:23:25,416 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:25,425 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:25,433 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:25,433 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:25,448 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:25,453 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:25,454 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:25,454 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:25,454 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 14/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=6.25][A2025-05-19 01:23:25,456 [DEBUG] models.hook_bridge: 更新批次數據: epoch=13, batch=1, loss=6.254415035247803
2025-05-19 01:23:25,456 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:25,456 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 14/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.53it/s, loss=6.25][AEpoch 14/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.09it/s, loss=6.25]
2025-05-19 01:23:25,507 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 13。將保存捕獲的特徵向量。
2025-05-19 01:23:25,507 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:25,507 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:25,507 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:25,507 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:25,507 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:25,507 [INFO] models.hook_bridge: 開始為 val (epoch 13) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:25,507 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:25,507 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:25,507 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:25,508 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:25,508 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:25,515 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:25,516 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:25,567 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:25,567 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:26,017 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:26,251 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:26,251 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:26,252 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:26,252 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:26,256 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:26,256 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:26,297 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:26,297 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:26,572 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:26,792 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:26,792 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:26,792 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:26,793 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_head_0_val_features.pt
2025-05-19 01:23:26,793 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_head_0_val_features.pt
2025-05-19 01:23:26,828 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:26,828 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:26,988 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:27,213 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_head_0_val_tsne.pt
2025-05-19 01:23:27,214 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_13/layer_head_0_val_tsne.pt
2025-05-19 01:23:27,214 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:27,214 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:27,214 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:27,214 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:27,214 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:27,215 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 13)。收集了 2 個批次的數據
2025-05-19 01:23:27,215 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:27,215 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:27,216 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:27,217 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 13
2025-05-19 01:23:27,217 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 13 檢測到驗證集 outputs 和 targets，準備保存 epoch_13_validation_predictions.pt
2025-05-19 01:23:27,218 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 13 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_13_validation_predictions.pt
2025-05-19 01:23:27,218 [INFO] trainers.pytorch_trainer: Epoch 14/30 - 訓練損失: 13.0987, 驗證損失: 5.0554
2025-05-19 01:23:27,219 [INFO] models.hook_bridge: 開始 epoch 14

Epoch 15/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:27,737 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:27,813 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:27,820 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 14
2025-05-19 01:23:27,844 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:27,860 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:27,869 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:27,885 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:27,890 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:27,890 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:27,892 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:27,893 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:27,893 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:27,894 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:27,894 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:27,894 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 15/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=18.2][A2025-05-19 01:23:28,072 [DEBUG] models.hook_bridge: 更新批次數據: epoch=14, batch=0, loss=18.199440002441406
2025-05-19 01:23:28,072 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:28,072 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 15/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.18it/s, loss=18.2][A2025-05-19 01:23:28,073 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:28,116 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:28,121 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 14
2025-05-19 01:23:28,127 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:28,136 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:28,142 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:28,155 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:28,159 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:28,159 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:28,161 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:28,161 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:28,161 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:28,161 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:28,162 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:28,162 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 15/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.18it/s, loss=20.9][A2025-05-19 01:23:28,279 [DEBUG] models.hook_bridge: 更新批次數據: epoch=14, batch=1, loss=20.87240982055664
2025-05-19 01:23:28,279 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:28,279 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 15/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.12it/s, loss=20.9][A2025-05-19 01:23:28,280 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:28,319 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:28,322 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 14
2025-05-19 01:23:28,328 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:28,336 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:28,343 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:28,356 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:28,360 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:28,360 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:28,361 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:28,362 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:28,362 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:28,362 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:28,362 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:28,362 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 15/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.12it/s, loss=19.9][A2025-05-19 01:23:28,460 [DEBUG] models.hook_bridge: 更新批次數據: epoch=14, batch=2, loss=19.928558349609375
2025-05-19 01:23:28,460 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:28,460 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 15/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.95it/s, loss=19.9][A2025-05-19 01:23:28,460 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:28,469 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:28,470 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 14
2025-05-19 01:23:28,471 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:28,475 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:28,478 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:28,487 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:28,490 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:28,490 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:28,492 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:28,492 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:28,492 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:28,492 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:28,493 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:28,493 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 15/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.95it/s, loss=15.9][A2025-05-19 01:23:28,563 [DEBUG] models.hook_bridge: 更新批次數據: epoch=14, batch=3, loss=15.948065757751465
2025-05-19 01:23:28,563 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:28,563 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 15/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  4.07it/s, loss=15.9][AEpoch 15/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s, loss=15.9]
2025-05-19 01:23:28,760 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/gns_stats_epoch_14.json
2025-05-19 01:23:28,760 [INFO] trainers.pytorch_trainer: Epoch 14 GNS = 0.0000
2025-05-19 01:23:28,765 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 14。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:28,765 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:28,765 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:28,766 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:28,766 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:28,766 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:28,766 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 14)
2025-05-19 01:23:28,766 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 14)

Epoch 15/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:29,187 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:29,496 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:29,503 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 14
2025-05-19 01:23:29,526 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:29,540 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:29,548 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:29,552 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:29,567 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:29,572 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:29,572 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:29,573 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:29,573 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 15/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=4.24][A2025-05-19 01:23:29,580 [DEBUG] models.hook_bridge: 更新批次數據: epoch=14, batch=0, loss=4.238467693328857
2025-05-19 01:23:29,580 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:29,580 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 15/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.23it/s, loss=4.24][A2025-05-19 01:23:29,581 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:29,613 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:29,619 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 14
2025-05-19 01:23:29,642 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:29,650 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:29,658 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:29,662 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:29,677 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:29,682 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:29,682 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:29,682 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:29,682 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 15/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.23it/s, loss=6.7] [A2025-05-19 01:23:29,684 [DEBUG] models.hook_bridge: 更新批次數據: epoch=14, batch=1, loss=6.703692436218262
2025-05-19 01:23:29,684 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:29,684 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 15/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.53it/s, loss=6.7][AEpoch 15/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.08it/s, loss=6.7]
2025-05-19 01:23:29,734 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 14。將保存捕獲的特徵向量。
2025-05-19 01:23:29,735 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:29,735 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:29,735 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:29,735 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:29,735 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:29,735 [INFO] models.hook_bridge: 開始為 val (epoch 14) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:29,735 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:29,735 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:29,735 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:29,736 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:29,736 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:29,743 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:29,743 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:29,795 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:29,795 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:30,279 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:30,504 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:30,505 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:30,505 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:30,505 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:30,509 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:30,509 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:30,549 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:30,549 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:30,903 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:31,118 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:31,118 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:31,118 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:31,120 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_head_0_val_features.pt
2025-05-19 01:23:31,120 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_head_0_val_features.pt
2025-05-19 01:23:31,152 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:31,152 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:31,495 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:31,719 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_head_0_val_tsne.pt
2025-05-19 01:23:31,719 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_14/layer_head_0_val_tsne.pt
2025-05-19 01:23:31,720 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:31,720 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:31,720 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:31,720 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:31,720 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:31,721 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 14)。收集了 2 個批次的數據
2025-05-19 01:23:31,721 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:31,721 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:31,722 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:32,686 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_14.pth
2025-05-19 01:23:32,687 [INFO] trainers.pytorch_trainer: Epoch 15/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_14.pth
2025-05-19 01:23:32,722 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:23:32,723 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:23:32,725 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:23:32,726 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:23:32,727 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:32,728 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:32,730 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:32,731 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:32,735 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:32,739 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:32,741 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:32,742 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:32,743 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:32,745 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:32,750 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:32,753 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:32,758 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:32,759 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:32,761 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:32,762 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:32,763 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:32,768 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:32,769 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:32,771 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:32,772 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:32,774 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:32,775 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:32,780 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:32,782 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:32,787 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:32,788 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:23:32,798 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:23:32,799 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:23:32,801 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:32,802 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:32,803 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:32,805 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:32,824 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:32,826 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:32,831 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:32,832 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:32,833 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:32,835 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:32,853 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:32,855 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:32,873 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:32,875 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:32,877 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:32,880 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:32,883 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:32,897 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:32,900 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:32,907 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:32,909 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:32,911 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:32,914 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:32,933 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:32,936 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:32,959 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:32,962 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:23:33,065 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:23:33,068 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:23:33,071 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:33,073 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:33,076 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:33,080 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:33,134 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:33,137 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:33,156 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:33,158 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:33,161 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:33,166 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:33,228 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:33,232 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:33,295 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:33,297 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:33,300 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:33,302 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:33,307 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:33,354 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:33,357 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:33,382 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:33,384 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:33,387 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:33,391 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:33,489 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:33,494 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:33,558 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:33,560 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:23:33,562 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:23:33,567 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:33,571 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:33,618 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:33,621 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:33,640 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:33,642 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:23:33,645 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:23:33,650 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:33,712 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:33,717 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:33,778 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:33,780 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:23:33,783 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:23:33,787 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:33,791 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:33,843 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:33,847 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:33,866 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:33,868 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:23:33,871 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:23:33,877 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:33,938 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:33,942 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:34,004 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:34,021 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:23:34,024 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:23:34,026 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:34,031 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:34,084 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:34,088 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:34,107 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:34,109 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:23:34,112 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:23:34,117 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:34,179 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:34,183 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:34,245 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:34,247 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:23:34,250 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:23:34,253 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:34,257 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:34,305 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:34,308 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:34,327 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:34,330 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:23:34,332 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:23:34,337 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:34,441 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:34,446 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:34,509 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:34,516 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:23:34,531 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:23:34,534 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:23:34,536 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:23:34,539 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:23:34,541 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:34,551 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:34,572 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:34,576 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:34,639 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:34,641 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:23:34,644 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:23:34,655 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:34,670 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:34,682 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:34,697 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:34,700 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:23:34,702 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:23:34,705 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:23:34,714 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:23:34,729 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:23:34,734 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:23:34,797 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:23:34,799 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:23:34,802 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:23:34,813 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:23:34,828 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:23:34,839 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:23:34,854 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:23:34,857 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_norm_weight_gradient_all.pt
2025-05-19 01:23:34,859 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/backbone_norm_bias_gradient_all.pt
2025-05-19 01:23:34,862 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/head_1_weight_gradient_all.pt
2025-05-19 01:23:34,873 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/head_1_bias_gradient_all.pt
2025-05-19 01:23:34,875 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:23:34,889 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:23:34,892 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:23:34,894 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:23:34,896 [INFO] trainers.pytorch_trainer: Epoch 14: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:23:38,733 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/gns_stats_epoch_14.json
2025-05-19 01:23:38,734 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 14
2025-05-19 01:23:38,734 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 14 檢測到驗證集 outputs 和 targets，準備保存 epoch_14_validation_predictions.pt
2025-05-19 01:23:38,734 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 14 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14_validation_predictions.pt
2025-05-19 01:23:38,735 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 14 達到保存頻率，調用 save_manager.save_epoch_summary
2025-05-19 01:23:38,735 [INFO] utils.save_manager: Epoch 14 摘要已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_14/epoch_summary.pt
2025-05-19 01:23:38,736 [INFO] trainers.pytorch_trainer: Epoch 15/30 - 訓練損失: 18.7371, 驗證損失: 5.4711
2025-05-19 01:23:38,736 [INFO] models.hook_bridge: 開始 epoch 15

Epoch 16/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:39,265 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:39,308 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:39,313 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 15
2025-05-19 01:23:39,337 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:39,352 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:39,360 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:39,376 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:39,381 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:39,381 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:39,383 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:39,383 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:39,384 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:39,384 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:39,385 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:39,385 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 16/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=13.5][A2025-05-19 01:23:39,571 [DEBUG] models.hook_bridge: 更新批次數據: epoch=15, batch=0, loss=13.474120140075684
2025-05-19 01:23:39,571 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:39,571 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 16/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.20it/s, loss=13.5][A2025-05-19 01:23:39,572 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:39,636 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:39,641 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 15
2025-05-19 01:23:39,647 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:39,656 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:39,661 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:39,675 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:39,679 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:39,679 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:39,681 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:39,681 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:39,681 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:39,682 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:39,682 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:39,682 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 16/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.20it/s, loss=7.26][A2025-05-19 01:23:39,787 [DEBUG] models.hook_bridge: 更新批次數據: epoch=15, batch=1, loss=7.264800548553467
2025-05-19 01:23:39,787 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:39,787 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 16/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.13it/s, loss=7.26][A2025-05-19 01:23:39,787 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:39,825 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:39,828 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 15
2025-05-19 01:23:39,834 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:39,843 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:39,849 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:39,862 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:39,865 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:39,865 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:39,867 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:39,867 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:39,867 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:39,868 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:39,868 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:39,868 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 16/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.13it/s, loss=7.05][A2025-05-19 01:23:40,011 [DEBUG] models.hook_bridge: 更新批次數據: epoch=15, batch=2, loss=7.053822040557861
2025-05-19 01:23:40,011 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:40,012 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 16/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.79it/s, loss=7.05][A2025-05-19 01:23:40,012 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:40,021 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:40,024 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 15
2025-05-19 01:23:40,025 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:40,029 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:40,032 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:40,041 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:40,043 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:40,044 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:40,045 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:40,045 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:40,045 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:40,046 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:40,046 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:40,046 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 16/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.79it/s, loss=8.9] [A2025-05-19 01:23:40,103 [DEBUG] models.hook_bridge: 更新批次數據: epoch=15, batch=3, loss=8.89694881439209
2025-05-19 01:23:40,103 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:40,104 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 16/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s, loss=8.9]
2025-05-19 01:23:40,283 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_15/gns_stats_epoch_15.json
2025-05-19 01:23:40,283 [INFO] trainers.pytorch_trainer: Epoch 15 GNS = 0.0000
2025-05-19 01:23:40,286 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 15。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:40,286 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:40,286 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:40,287 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:40,287 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:40,288 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:40,288 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 15)
2025-05-19 01:23:40,288 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 15)

Epoch 16/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:40,692 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:40,987 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:40,994 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 15
2025-05-19 01:23:41,017 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:41,031 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:41,039 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:41,042 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:41,057 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:41,062 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:41,063 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:41,063 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:41,063 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 16/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=7.36][A2025-05-19 01:23:41,071 [DEBUG] models.hook_bridge: 更新批次數據: epoch=15, batch=0, loss=7.362415790557861
2025-05-19 01:23:41,071 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:41,071 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 16/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=7.36][A2025-05-19 01:23:41,071 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:41,109 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:41,115 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 15
2025-05-19 01:23:41,138 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:41,146 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:41,152 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:41,153 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:41,168 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:41,173 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:41,173 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:41,173 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:41,174 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 16/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=11.9][A2025-05-19 01:23:41,175 [DEBUG] models.hook_bridge: 更新批次數據: epoch=15, batch=1, loss=11.936328887939453
2025-05-19 01:23:41,175 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:41,175 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 16/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.61it/s, loss=11.9][AEpoch 16/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.16it/s, loss=11.9]
2025-05-19 01:23:41,223 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 15。將保存捕獲的特徵向量。
2025-05-19 01:23:41,223 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:41,223 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:41,223 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:41,223 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:41,223 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:41,223 [INFO] models.hook_bridge: 開始為 val (epoch 15) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:41,223 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:41,224 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:41,224 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:41,224 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:41,225 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:41,231 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:41,232 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:41,281 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:41,281 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:41,702 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:41,946 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:41,946 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:41,947 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:41,947 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:41,951 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:41,951 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:41,994 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:41,994 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:42,131 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:42,475 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:42,475 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:42,475 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:42,477 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_head_0_val_features.pt
2025-05-19 01:23:42,477 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_head_0_val_features.pt
2025-05-19 01:23:42,509 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:42,509 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:42,765 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:42,995 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_head_0_val_tsne.pt
2025-05-19 01:23:42,996 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_15/layer_head_0_val_tsne.pt
2025-05-19 01:23:42,996 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:42,996 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:42,996 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:42,996 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:42,996 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:42,996 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 15)。收集了 2 個批次的數據
2025-05-19 01:23:42,996 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:42,996 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:42,997 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:42,997 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 15
2025-05-19 01:23:42,998 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 15 檢測到驗證集 outputs 和 targets，準備保存 epoch_15_validation_predictions.pt
2025-05-19 01:23:42,998 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 15 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_15_validation_predictions.pt
2025-05-19 01:23:42,999 [INFO] trainers.pytorch_trainer: Epoch 16/30 - 訓練損失: 9.1724, 驗證損失: 9.6494
2025-05-19 01:23:42,999 [INFO] models.hook_bridge: 開始 epoch 16

Epoch 17/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:43,532 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:43,574 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:43,578 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 16
2025-05-19 01:23:43,601 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:43,617 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:43,624 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:43,642 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:43,646 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:43,647 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:43,649 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:43,649 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:43,649 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:43,650 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:43,650 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:43,650 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 17/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=22][A2025-05-19 01:23:43,815 [DEBUG] models.hook_bridge: 更新批次數據: epoch=16, batch=0, loss=21.9761962890625
2025-05-19 01:23:43,815 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:43,815 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 17/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.23it/s, loss=22][A2025-05-19 01:23:43,816 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:43,854 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:43,860 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 16
2025-05-19 01:23:43,866 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:43,876 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:43,882 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:43,897 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:43,902 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:43,902 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:43,904 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:43,904 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:43,904 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:43,904 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:43,905 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:43,905 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 17/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.23it/s, loss=10.4][A2025-05-19 01:23:44,016 [DEBUG] models.hook_bridge: 更新批次數據: epoch=16, batch=1, loss=10.421708106994629
2025-05-19 01:23:44,016 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:44,016 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 17/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.21it/s, loss=10.4][A2025-05-19 01:23:44,016 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:44,054 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:44,057 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 16
2025-05-19 01:23:44,063 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:44,073 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:44,080 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:44,095 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:44,099 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:44,099 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:44,100 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:44,101 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:44,101 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:44,101 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:44,101 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:44,101 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 17/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.21it/s, loss=13.8][A2025-05-19 01:23:44,237 [DEBUG] models.hook_bridge: 更新批次數據: epoch=16, batch=2, loss=13.757720947265625
2025-05-19 01:23:44,237 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:44,237 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 17/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.88it/s, loss=13.8][A2025-05-19 01:23:44,238 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:44,247 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:44,251 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 16
2025-05-19 01:23:44,252 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:44,259 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:44,262 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:44,270 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:44,273 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:44,273 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:44,275 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:44,275 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:44,275 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:44,275 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:44,275 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:44,276 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 17/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.88it/s, loss=7.56][A2025-05-19 01:23:44,337 [DEBUG] models.hook_bridge: 更新批次數據: epoch=16, batch=3, loss=7.561008930206299
2025-05-19 01:23:44,337 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:44,337 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 17/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s, loss=7.56]
2025-05-19 01:23:44,506 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_16/gns_stats_epoch_16.json
2025-05-19 01:23:44,507 [INFO] trainers.pytorch_trainer: Epoch 16 GNS = 0.0000
2025-05-19 01:23:44,509 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 16。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:44,510 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:44,510 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:44,510 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:44,510 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:44,511 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:44,511 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 16)
2025-05-19 01:23:44,511 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 16)

Epoch 17/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:44,928 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:45,218 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:45,224 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 16
2025-05-19 01:23:45,249 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:45,263 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:45,271 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:45,274 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:45,289 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:45,294 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:45,295 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:45,295 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:45,295 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 17/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=8.84][A2025-05-19 01:23:45,303 [DEBUG] models.hook_bridge: 更新批次數據: epoch=16, batch=0, loss=8.835639953613281
2025-05-19 01:23:45,303 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:45,303 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 17/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.27it/s, loss=8.84][A2025-05-19 01:23:45,303 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:45,341 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:45,347 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 16
2025-05-19 01:23:45,370 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:45,384 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:45,392 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:45,393 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:45,408 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:45,413 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:45,413 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:45,413 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:45,413 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 17/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.27it/s, loss=6.28][A2025-05-19 01:23:45,415 [DEBUG] models.hook_bridge: 更新批次數據: epoch=16, batch=1, loss=6.282597541809082
2025-05-19 01:23:45,415 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:45,415 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 17/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.56it/s, loss=6.28][AEpoch 17/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.12it/s, loss=6.28]
2025-05-19 01:23:45,463 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 16。將保存捕獲的特徵向量。
2025-05-19 01:23:45,463 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:45,463 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:45,463 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:45,463 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:45,463 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:45,463 [INFO] models.hook_bridge: 開始為 val (epoch 16) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:45,463 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:45,463 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:45,463 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:45,464 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:45,464 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:45,471 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:45,471 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:45,520 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:45,520 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:46,049 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:46,283 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:46,283 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:46,284 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:46,284 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:46,288 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:46,288 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:46,331 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:46,331 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:46,706 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:46,938 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:46,938 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:46,939 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:46,939 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_head_0_val_features.pt
2025-05-19 01:23:46,939 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_head_0_val_features.pt
2025-05-19 01:23:46,972 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:46,972 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:47,196 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:47,428 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_head_0_val_tsne.pt
2025-05-19 01:23:47,428 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_16/layer_head_0_val_tsne.pt
2025-05-19 01:23:47,428 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:47,428 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:47,428 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:47,428 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:47,428 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:47,428 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 16)。收集了 2 個批次的數據
2025-05-19 01:23:47,428 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:47,428 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:47,429 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:47,430 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 16
2025-05-19 01:23:47,430 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 16 檢測到驗證集 outputs 和 targets，準備保存 epoch_16_validation_predictions.pt
2025-05-19 01:23:47,430 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 16 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_16_validation_predictions.pt
2025-05-19 01:23:47,432 [INFO] trainers.pytorch_trainer: Epoch 17/30 - 訓練損失: 13.4292, 驗證損失: 7.5591
2025-05-19 01:23:47,432 [INFO] models.hook_bridge: 開始 epoch 17

Epoch 18/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:47,966 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:48,018 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:48,024 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 17
2025-05-19 01:23:48,048 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:48,064 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:48,072 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:48,090 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:48,094 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:48,095 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:48,097 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,097 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:48,097 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:48,098 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:48,098 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,098 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 18/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=15.2][A2025-05-19 01:23:48,305 [DEBUG] models.hook_bridge: 更新批次數據: epoch=17, batch=0, loss=15.159496307373047
2025-05-19 01:23:48,305 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:48,305 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 18/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.15it/s, loss=15.2][A2025-05-19 01:23:48,306 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:48,350 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:48,354 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 17
2025-05-19 01:23:48,360 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:48,370 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:48,376 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:48,391 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:48,396 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:48,396 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:48,398 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,398 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:48,398 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:48,398 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:48,399 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,399 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 18/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.15it/s, loss=23.5][A2025-05-19 01:23:48,564 [DEBUG] models.hook_bridge: 更新批次數據: epoch=17, batch=1, loss=23.463472366333008
2025-05-19 01:23:48,565 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:48,565 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 18/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.96it/s, loss=23.5][A2025-05-19 01:23:48,565 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:48,597 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:48,600 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 17
2025-05-19 01:23:48,606 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:48,615 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:48,620 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:48,633 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:48,636 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:48,636 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:48,638 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,638 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:48,638 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:48,639 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:48,639 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,639 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 18/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.96it/s, loss=13.5][A2025-05-19 01:23:48,735 [DEBUG] models.hook_bridge: 更新批次數據: epoch=17, batch=2, loss=13.539698600769043
2025-05-19 01:23:48,735 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:48,735 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 18/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.81it/s, loss=13.5][A2025-05-19 01:23:48,735 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:48,747 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:48,749 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 17
2025-05-19 01:23:48,750 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:48,756 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:48,760 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:48,768 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:48,770 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:48,770 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:48,772 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,772 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:48,772 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:48,772 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:48,772 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:48,773 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 18/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.81it/s, loss=18.1][A2025-05-19 01:23:48,830 [DEBUG] models.hook_bridge: 更新批次數據: epoch=17, batch=3, loss=18.101863861083984
2025-05-19 01:23:48,830 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:48,830 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 18/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.76it/s, loss=18.1]
2025-05-19 01:23:49,007 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_17/gns_stats_epoch_17.json
2025-05-19 01:23:49,007 [INFO] trainers.pytorch_trainer: Epoch 17 GNS = 0.0000
2025-05-19 01:23:49,011 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 17。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:49,011 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:49,011 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:49,012 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:49,012 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:49,012 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:49,012 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 17)
2025-05-19 01:23:49,012 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 17)

Epoch 18/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:49,424 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:49,728 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:49,734 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 17
2025-05-19 01:23:49,757 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:49,771 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:49,779 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:49,783 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:49,798 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:49,803 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:49,803 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:49,803 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:49,804 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 18/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=14][A2025-05-19 01:23:49,810 [DEBUG] models.hook_bridge: 更新批次數據: epoch=17, batch=0, loss=14.009452819824219
2025-05-19 01:23:49,810 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:49,810 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 18/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=14][A2025-05-19 01:23:49,811 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:49,848 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:49,854 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 17
2025-05-19 01:23:49,877 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:49,892 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:49,900 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:49,901 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:49,916 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:49,921 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:49,921 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:49,921 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:49,921 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 18/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=22.6][A2025-05-19 01:23:49,923 [DEBUG] models.hook_bridge: 更新批次數據: epoch=17, batch=1, loss=22.60594367980957
2025-05-19 01:23:49,923 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:49,923 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 18/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.54it/s, loss=22.6][AEpoch 18/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.10it/s, loss=22.6]
2025-05-19 01:23:49,973 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 17。將保存捕獲的特徵向量。
2025-05-19 01:23:49,973 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:49,973 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:49,973 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:49,973 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:49,973 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:49,973 [INFO] models.hook_bridge: 開始為 val (epoch 17) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:49,973 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:49,973 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:49,973 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:49,974 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:49,974 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:49,981 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:49,981 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:50,031 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:50,031 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:50,458 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:50,749 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:50,749 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:50,749 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:50,750 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:50,754 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:50,754 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:50,794 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:50,794 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:50,898 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:51,110 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:51,111 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:51,111 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:51,112 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_head_0_val_features.pt
2025-05-19 01:23:51,112 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_head_0_val_features.pt
2025-05-19 01:23:51,145 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:51,145 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:51,425 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:51,662 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_head_0_val_tsne.pt
2025-05-19 01:23:51,662 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_17/layer_head_0_val_tsne.pt
2025-05-19 01:23:51,662 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:51,662 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:51,662 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:51,662 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:51,662 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:51,663 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 17)。收集了 2 個批次的數據
2025-05-19 01:23:51,663 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:51,663 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:51,664 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:51,665 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 17
2025-05-19 01:23:51,666 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 17 檢測到驗證集 outputs 和 targets，準備保存 epoch_17_validation_predictions.pt
2025-05-19 01:23:51,667 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 17 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_17_validation_predictions.pt
2025-05-19 01:23:51,667 [INFO] trainers.pytorch_trainer: Epoch 18/30 - 訓練損失: 17.5661, 驗證損失: 18.3077
2025-05-19 01:23:51,668 [INFO] models.hook_bridge: 開始 epoch 18

Epoch 19/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:52,170 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:52,252 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:52,256 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 18
2025-05-19 01:23:52,279 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:52,295 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:52,302 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:52,321 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:52,325 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:52,325 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:52,328 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:52,328 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:52,328 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:52,329 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:52,329 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:52,329 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 19/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=17.6][A2025-05-19 01:23:52,499 [DEBUG] models.hook_bridge: 更新批次數據: epoch=18, batch=0, loss=17.59343147277832
2025-05-19 01:23:52,499 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:52,499 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 19/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.21it/s, loss=17.6][A2025-05-19 01:23:52,500 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:52,553 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:52,563 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 18
2025-05-19 01:23:52,568 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:52,578 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:52,587 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:52,603 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:52,607 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:52,607 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:52,609 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:52,609 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:52,609 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:52,610 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:52,610 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:52,610 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 19/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.21it/s, loss=11]  [A2025-05-19 01:23:52,805 [DEBUG] models.hook_bridge: 更新批次數據: epoch=18, batch=1, loss=11.04696273803711
2025-05-19 01:23:52,805 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:52,805 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 19/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.92it/s, loss=11][A2025-05-19 01:23:52,805 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:52,840 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:52,843 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 18
2025-05-19 01:23:52,850 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:52,859 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:52,866 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:52,878 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:52,882 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:52,882 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:52,884 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:52,884 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:52,884 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:52,884 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:52,885 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:52,885 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 19/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.92it/s, loss=20.2][A2025-05-19 01:23:52,982 [DEBUG] models.hook_bridge: 更新批次數據: epoch=18, batch=2, loss=20.202245712280273
2025-05-19 01:23:52,982 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:52,982 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 19/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.75it/s, loss=20.2][A2025-05-19 01:23:52,983 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:52,993 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:52,995 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 18
2025-05-19 01:23:52,996 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:53,002 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:53,006 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:53,014 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:53,016 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:53,016 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:53,018 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:53,018 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:53,018 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:53,019 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:53,019 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:53,019 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 19/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.75it/s, loss=12.8][A2025-05-19 01:23:53,077 [DEBUG] models.hook_bridge: 更新批次數據: epoch=18, batch=3, loss=12.846782684326172
2025-05-19 01:23:53,077 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:53,077 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 19/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s, loss=12.8]
2025-05-19 01:23:53,254 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_18/gns_stats_epoch_18.json
2025-05-19 01:23:53,254 [INFO] trainers.pytorch_trainer: Epoch 18 GNS = 0.0000
2025-05-19 01:23:53,257 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 18。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:53,257 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:53,257 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:53,258 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:53,258 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:53,258 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:53,258 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 18)
2025-05-19 01:23:53,258 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 18)

Epoch 19/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:53,674 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:54,042 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:54,049 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 18
2025-05-19 01:23:54,073 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:54,088 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:54,096 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:54,099 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:54,114 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:54,119 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:54,120 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:54,120 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:54,120 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 19/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=2.59][A2025-05-19 01:23:54,128 [DEBUG] models.hook_bridge: 更新批次數據: epoch=18, batch=0, loss=2.5920562744140625
2025-05-19 01:23:54,128 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:54,128 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 19/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.15it/s, loss=2.59][A2025-05-19 01:23:54,128 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:54,166 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:54,172 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 18
2025-05-19 01:23:54,195 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:54,209 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:54,217 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:54,217 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:54,232 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:54,238 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:54,238 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:54,238 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:54,238 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 19/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.15it/s, loss=3.49][A2025-05-19 01:23:54,240 [DEBUG] models.hook_bridge: 更新批次數據: epoch=18, batch=1, loss=3.4854094982147217
2025-05-19 01:23:54,240 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:54,240 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 19/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.36it/s, loss=3.49][AEpoch 19/30 [VAL]: 100%|██████████| 2/2 [00:01<00:00,  1.96it/s, loss=3.49]
2025-05-19 01:23:54,288 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 18。將保存捕獲的特徵向量。
2025-05-19 01:23:54,288 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:54,288 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:54,288 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:54,288 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:54,288 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:54,288 [INFO] models.hook_bridge: 開始為 val (epoch 18) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:54,289 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:54,289 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:54,289 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:54,289 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:54,290 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:54,297 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:54,297 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:54,347 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:54,347 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:54,790 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:55,028 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:55,028 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:55,028 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:55,028 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:55,032 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:55,032 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:55,072 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:55,072 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:55,331 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:55,550 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:55,550 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:23:55,550 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:55,552 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_head_0_val_features.pt
2025-05-19 01:23:55,552 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_head_0_val_features.pt
2025-05-19 01:23:55,584 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:55,585 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:23:55,784 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:56,024 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_head_0_val_tsne.pt
2025-05-19 01:23:56,024 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_18/layer_head_0_val_tsne.pt
2025-05-19 01:23:56,024 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:23:56,024 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:23:56,024 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:23:56,025 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:56,025 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:23:56,025 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 18)。收集了 2 個批次的數據
2025-05-19 01:23:56,025 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:23:56,025 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:23:56,025 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:23:56,400 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:23:56,406 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:23:56,406 [INFO] trainers.pytorch_trainer: Epoch 19/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:23:56,407 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 18
2025-05-19 01:23:56,407 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 18 檢測到驗證集 outputs 和 targets，準備保存 epoch_18_validation_predictions.pt
2025-05-19 01:23:56,407 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 18 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_18_validation_predictions.pt
2025-05-19 01:23:56,407 [INFO] trainers.pytorch_trainer: Epoch 19/30 - 訓練損失: 15.4224, 驗證損失: 3.0387
2025-05-19 01:23:56,407 [INFO] models.hook_bridge: 開始 epoch 19

Epoch 20/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:23:56,933 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:57,004 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:57,008 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 19
2025-05-19 01:23:57,032 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:57,048 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:57,056 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:57,072 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:57,077 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:57,077 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:57,079 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,080 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:57,080 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:57,081 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:57,081 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,081 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 20/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=22.9][A2025-05-19 01:23:57,267 [DEBUG] models.hook_bridge: 更新批次數據: epoch=19, batch=0, loss=22.938127517700195
2025-05-19 01:23:57,267 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:57,267 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 20/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.17it/s, loss=22.9][A2025-05-19 01:23:57,267 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:57,313 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:57,319 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 19
2025-05-19 01:23:57,328 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:57,337 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:57,344 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:57,357 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:57,361 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:57,361 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:57,363 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,363 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:57,363 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:57,364 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:57,364 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,364 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 20/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.17it/s, loss=14.4][A2025-05-19 01:23:57,467 [DEBUG] models.hook_bridge: 更新批次數據: epoch=19, batch=1, loss=14.442914962768555
2025-05-19 01:23:57,467 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:57,467 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 20/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.12it/s, loss=14.4][A2025-05-19 01:23:57,467 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:57,501 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:57,504 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 19
2025-05-19 01:23:57,510 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:57,519 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:57,527 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:57,541 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:57,544 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:57,545 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:57,546 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,546 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:57,547 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:57,547 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:57,547 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,547 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 20/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.12it/s, loss=27.7][A2025-05-19 01:23:57,649 [DEBUG] models.hook_bridge: 更新批次數據: epoch=19, batch=2, loss=27.67636489868164
2025-05-19 01:23:57,649 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:57,649 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 20/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.95it/s, loss=27.7][A2025-05-19 01:23:57,650 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:57,659 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:57,660 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 19
2025-05-19 01:23:57,661 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:23:57,664 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:23:57,668 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:57,676 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:23:57,678 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:57,678 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:23:57,680 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,680 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:23:57,680 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:23:57,681 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:23:57,681 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:23:57,681 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 20/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.95it/s, loss=12.7][A2025-05-19 01:23:57,737 [DEBUG] models.hook_bridge: 更新批次數據: epoch=19, batch=3, loss=12.74091911315918
2025-05-19 01:23:57,737 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:23:57,737 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 20/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s, loss=12.7]
2025-05-19 01:23:57,901 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/gns_stats_epoch_19.json
2025-05-19 01:23:57,901 [INFO] trainers.pytorch_trainer: Epoch 19 GNS = 0.0000
2025-05-19 01:23:57,906 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 19。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:23:57,906 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:23:57,906 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:57,906 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:57,907 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:23:57,907 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:23:57,907 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 19)
2025-05-19 01:23:57,907 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 19)

Epoch 20/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:23:58,318 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:58,630 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:58,637 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 19
2025-05-19 01:23:58,660 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:58,674 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:58,682 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:58,685 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:58,700 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:58,705 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:58,706 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:58,706 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:58,706 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 20/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=5.33][A2025-05-19 01:23:58,714 [DEBUG] models.hook_bridge: 更新批次數據: epoch=19, batch=0, loss=5.33342981338501
2025-05-19 01:23:58,714 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:58,714 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 20/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=5.33][A2025-05-19 01:23:58,714 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:23:58,748 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:23:58,754 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 19
2025-05-19 01:23:58,777 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:23:58,785 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:23:58,793 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:58,794 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:58,808 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:23:58,814 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:23:58,814 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:23:58,814 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:23:58,814 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 20/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=5.55][A2025-05-19 01:23:58,816 [DEBUG] models.hook_bridge: 更新批次數據: epoch=19, batch=1, loss=5.552484035491943
2025-05-19 01:23:58,816 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:23:58,816 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 20/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.55it/s, loss=5.55][AEpoch 20/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.10it/s, loss=5.55]
2025-05-19 01:23:58,866 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 19。將保存捕獲的特徵向量。
2025-05-19 01:23:58,866 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:23:58,866 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:23:58,866 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:23:58,866 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:58,866 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:58,866 [INFO] models.hook_bridge: 開始為 val (epoch 19) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:23:58,867 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:23:58,867 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:23:58,867 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:23:58,928 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:23:58,928 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:58,935 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:58,935 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_4_val_features.pt
2025-05-19 01:23:58,985 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:58,986 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:23:59,478 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:23:59,686 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:59,687 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:23:59,687 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:23:59,687 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:23:59,692 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:59,692 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_7_val_features.pt
2025-05-19 01:23:59,733 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:59,733 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:23:59,843 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:00,052 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:00,052 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:00,052 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:00,054 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_head_0_val_features.pt
2025-05-19 01:24:00,054 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_head_0_val_features.pt
2025-05-19 01:24:00,087 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:00,087 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:00,129 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:00,352 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_head_0_val_tsne.pt
2025-05-19 01:24:00,353 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_19/layer_head_0_val_tsne.pt
2025-05-19 01:24:00,353 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:00,353 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:00,353 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:00,353 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:00,353 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:00,354 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 19)。收集了 2 個批次的數據
2025-05-19 01:24:00,354 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:00,354 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:00,355 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:01,335 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_19.pth
2025-05-19 01:24:01,336 [INFO] trainers.pytorch_trainer: Epoch 20/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_19.pth
2025-05-19 01:24:01,378 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:24:01,387 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:24:01,388 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:24:01,390 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:24:01,391 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:01,392 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:01,394 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:01,395 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:01,399 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:01,401 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:01,403 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:01,408 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:01,409 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:01,411 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:01,416 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:01,418 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:01,450 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:01,452 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:01,453 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:01,454 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:01,456 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:01,463 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:01,466 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:01,469 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:01,471 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:01,473 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:01,476 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:01,482 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:01,485 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:01,491 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:01,493 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:24:01,504 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:24:01,506 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:24:01,509 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:01,511 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:01,513 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:01,516 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:01,533 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:01,535 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:01,541 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:01,544 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:01,546 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:01,549 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:01,568 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:01,571 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:01,589 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:01,592 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:01,594 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:01,596 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:01,599 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:01,613 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:01,616 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:01,622 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:01,624 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:01,626 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:01,629 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:01,648 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:01,651 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:01,669 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:01,673 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:24:01,707 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:24:01,709 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:24:01,712 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:01,714 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:01,716 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:01,721 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:01,767 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:01,771 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:01,790 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:01,792 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:01,794 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:01,799 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:01,862 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:01,866 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:01,929 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:01,932 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:01,935 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:01,937 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:01,942 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:02,001 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:02,004 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:02,023 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:02,026 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:02,028 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:02,033 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:02,096 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:02,101 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:02,162 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:02,165 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:24:02,167 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:24:02,170 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:02,174 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:02,224 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:02,227 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:02,247 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:02,249 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:24:02,252 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:24:02,257 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:02,320 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:02,325 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:02,385 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:02,388 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:24:02,390 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:24:02,393 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:02,404 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:02,450 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:02,453 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:02,473 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:02,475 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:24:02,478 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:24:02,483 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:02,545 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:02,549 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:02,610 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:02,613 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:24:02,615 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:24:02,621 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:02,631 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:02,677 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:02,681 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:02,700 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:02,703 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:24:02,706 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:24:02,711 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:02,772 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:02,776 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:02,838 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:02,840 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:24:02,843 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:24:02,847 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:02,851 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:02,903 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:02,906 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:02,925 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:02,928 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:24:02,930 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:24:02,935 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:02,996 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:03,000 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:03,085 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:03,092 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:24:03,108 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:24:03,111 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:24:03,113 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:03,117 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:03,120 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:03,129 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:03,150 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:03,164 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:03,228 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:03,231 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:03,234 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:03,245 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:03,260 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:03,272 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:03,287 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:03,289 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:03,292 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:03,294 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:03,304 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:03,325 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:03,330 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:03,392 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:03,394 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:03,397 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:03,408 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:03,423 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:03,435 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:03,450 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:03,452 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_norm_weight_gradient_all.pt
2025-05-19 01:24:03,455 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/backbone_norm_bias_gradient_all.pt
2025-05-19 01:24:03,457 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/head_1_weight_gradient_all.pt
2025-05-19 01:24:03,459 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/head_1_bias_gradient_all.pt
2025-05-19 01:24:03,462 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:24:03,480 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:24:03,482 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:24:03,488 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:24:03,490 [INFO] trainers.pytorch_trainer: Epoch 19: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:24:07,290 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/gns_stats_epoch_19.json
2025-05-19 01:24:07,291 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 19
2025-05-19 01:24:07,291 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 19 檢測到驗證集 outputs 和 targets，準備保存 epoch_19_validation_predictions.pt
2025-05-19 01:24:07,292 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 19 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19_validation_predictions.pt
2025-05-19 01:24:07,292 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 19 達到保存頻率，調用 save_manager.save_epoch_summary
2025-05-19 01:24:07,293 [INFO] utils.save_manager: Epoch 19 摘要已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_19/epoch_summary.pt
2025-05-19 01:24:07,293 [INFO] trainers.pytorch_trainer: Epoch 20/30 - 訓練損失: 19.4496, 驗證損失: 5.4430
2025-05-19 01:24:07,293 [INFO] models.hook_bridge: 開始 epoch 20

Epoch 21/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:07,808 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:07,855 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:07,859 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 20
2025-05-19 01:24:07,883 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:07,899 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:07,907 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:07,925 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:07,930 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:07,930 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:07,932 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:07,932 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:07,933 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:07,933 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:07,934 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:07,934 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 21/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=13.1][A2025-05-19 01:24:08,110 [DEBUG] models.hook_bridge: 更新批次數據: epoch=20, batch=0, loss=13.07766342163086
2025-05-19 01:24:08,110 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:08,110 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 21/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.23it/s, loss=13.1][A2025-05-19 01:24:08,111 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:08,148 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:08,152 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 20
2025-05-19 01:24:08,157 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:08,167 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:08,173 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:08,188 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:08,192 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:08,192 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:08,194 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:08,194 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:08,194 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:08,195 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:08,195 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:08,195 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 21/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.23it/s, loss=21.3][A2025-05-19 01:24:08,307 [DEBUG] models.hook_bridge: 更新批次數據: epoch=20, batch=1, loss=21.292205810546875
2025-05-19 01:24:08,307 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:08,308 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 21/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.21it/s, loss=21.3][A2025-05-19 01:24:08,308 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:08,355 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:08,358 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 20
2025-05-19 01:24:08,360 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:08,370 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:08,376 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:08,391 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:08,394 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:08,395 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:08,396 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:08,396 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:08,396 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:08,397 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:08,397 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:08,397 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 21/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.21it/s, loss=14.4][A2025-05-19 01:24:08,495 [DEBUG] models.hook_bridge: 更新批次數據: epoch=20, batch=2, loss=14.364825248718262
2025-05-19 01:24:08,495 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:08,495 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 21/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.02it/s, loss=14.4][A2025-05-19 01:24:08,495 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:08,505 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:08,506 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 20
2025-05-19 01:24:08,507 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:08,510 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:08,515 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:08,523 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:08,526 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:08,526 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:08,527 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:08,528 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:08,528 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:08,528 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:08,528 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:08,528 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 21/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.02it/s, loss=23.7][A2025-05-19 01:24:08,585 [DEBUG] models.hook_bridge: 更新批次數據: epoch=20, batch=3, loss=23.741052627563477
2025-05-19 01:24:08,585 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:08,586 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 21/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.00it/s, loss=23.7]
2025-05-19 01:24:08,755 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_20/gns_stats_epoch_20.json
2025-05-19 01:24:08,755 [INFO] trainers.pytorch_trainer: Epoch 20 GNS = 0.0000
2025-05-19 01:24:08,758 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 20。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:08,758 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:08,759 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:08,759 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:08,759 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:08,760 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:08,760 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 20)
2025-05-19 01:24:08,760 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 20)

Epoch 21/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:09,179 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:09,459 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:09,465 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 20
2025-05-19 01:24:09,490 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:09,503 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:09,511 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:09,514 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:09,529 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:09,534 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:09,535 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:09,535 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:09,535 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 21/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=7.6][A2025-05-19 01:24:09,543 [DEBUG] models.hook_bridge: 更新批次數據: epoch=20, batch=0, loss=7.602870941162109
2025-05-19 01:24:09,543 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:09,543 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 21/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=7.6][A2025-05-19 01:24:09,543 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:09,602 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:09,608 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 20
2025-05-19 01:24:09,632 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:09,646 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:09,654 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:09,655 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:09,670 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:09,675 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:09,675 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:09,676 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:09,676 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 21/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=12.4][A2025-05-19 01:24:09,677 [DEBUG] models.hook_bridge: 更新批次數據: epoch=20, batch=1, loss=12.405160903930664
2025-05-19 01:24:09,678 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:09,678 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 21/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.49it/s, loss=12.4][AEpoch 21/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.08it/s, loss=12.4]
2025-05-19 01:24:09,729 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 20。將保存捕獲的特徵向量。
2025-05-19 01:24:09,729 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:09,729 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:09,729 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:09,729 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:09,729 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:09,730 [INFO] models.hook_bridge: 開始為 val (epoch 20) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:09,730 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:09,730 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:09,730 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:09,741 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:09,741 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:09,748 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:09,748 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:09,797 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:09,797 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:10,259 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:10,467 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:10,468 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:10,468 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:10,468 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:10,472 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:10,472 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:10,512 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:10,512 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:10,614 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:10,825 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:10,826 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:10,826 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:10,827 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_head_0_val_features.pt
2025-05-19 01:24:10,827 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_head_0_val_features.pt
2025-05-19 01:24:10,860 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:10,861 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:11,095 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:11,327 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_head_0_val_tsne.pt
2025-05-19 01:24:11,327 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_20/layer_head_0_val_tsne.pt
2025-05-19 01:24:11,327 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:11,327 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:11,327 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:11,327 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:11,328 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:11,328 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 20)。收集了 2 個批次的數據
2025-05-19 01:24:11,328 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:11,328 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:11,329 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:11,331 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 20
2025-05-19 01:24:11,331 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 20 檢測到驗證集 outputs 和 targets，準備保存 epoch_20_validation_predictions.pt
2025-05-19 01:24:11,332 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 20 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_20_validation_predictions.pt
2025-05-19 01:24:11,332 [INFO] trainers.pytorch_trainer: Epoch 21/30 - 訓練損失: 18.1189, 驗證損失: 10.0040
2025-05-19 01:24:11,333 [INFO] models.hook_bridge: 開始 epoch 21

Epoch 22/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:11,851 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:11,958 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:11,964 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 21
2025-05-19 01:24:11,987 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:12,004 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:12,011 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:12,029 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:12,034 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:12,034 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:12,036 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,036 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:12,037 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:12,038 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:12,038 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,038 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 22/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=9.23][A2025-05-19 01:24:12,220 [DEBUG] models.hook_bridge: 更新批次數據: epoch=21, batch=0, loss=9.22743034362793
2025-05-19 01:24:12,220 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:12,220 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 22/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.13it/s, loss=9.23][A2025-05-19 01:24:12,220 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:12,289 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:12,298 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 21
2025-05-19 01:24:12,303 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:12,312 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:12,322 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:12,335 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:12,339 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:12,339 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:12,341 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,341 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:12,341 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:12,342 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:12,342 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,342 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 22/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.13it/s, loss=16.5][A2025-05-19 01:24:12,454 [DEBUG] models.hook_bridge: 更新批次數據: epoch=21, batch=1, loss=16.536663055419922
2025-05-19 01:24:12,454 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:12,454 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 22/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.99it/s, loss=16.5][A2025-05-19 01:24:12,454 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:12,486 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:12,489 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 21
2025-05-19 01:24:12,495 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:12,504 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:12,509 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:12,522 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:12,525 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:12,526 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:12,527 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,527 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:12,528 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:12,528 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:12,528 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,528 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 22/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.99it/s, loss=17.5][A2025-05-19 01:24:12,626 [DEBUG] models.hook_bridge: 更新批次數據: epoch=21, batch=2, loss=17.4549560546875
2025-05-19 01:24:12,626 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:12,626 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 22/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s, loss=17.5][A2025-05-19 01:24:12,626 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:12,635 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:12,636 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 21
2025-05-19 01:24:12,637 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:12,641 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:12,644 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:12,653 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:12,655 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:12,656 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:12,657 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,657 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:12,658 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:12,658 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:12,658 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:12,658 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 22/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.85it/s, loss=23]  [A2025-05-19 01:24:12,715 [DEBUG] models.hook_bridge: 更新批次數據: epoch=21, batch=3, loss=23.024070739746094
2025-05-19 01:24:12,715 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:12,715 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 22/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.81it/s, loss=23]
2025-05-19 01:24:12,880 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_21/gns_stats_epoch_21.json
2025-05-19 01:24:12,880 [INFO] trainers.pytorch_trainer: Epoch 21 GNS = 0.0000
2025-05-19 01:24:12,883 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 21。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:12,884 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:12,884 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:12,884 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:12,885 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:12,886 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:12,886 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 21)
2025-05-19 01:24:12,886 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 21)

Epoch 22/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:13,311 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:13,583 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:13,590 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 21
2025-05-19 01:24:13,614 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:13,628 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:13,636 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:13,640 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:13,654 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:13,660 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:13,660 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:13,660 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:13,660 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 22/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=10.9][A2025-05-19 01:24:13,668 [DEBUG] models.hook_bridge: 更新批次數據: epoch=21, batch=0, loss=10.905241966247559
2025-05-19 01:24:13,668 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:13,668 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 22/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=10.9][A2025-05-19 01:24:13,668 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:13,704 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:13,710 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 21
2025-05-19 01:24:13,733 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:13,747 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:13,755 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:13,755 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:13,770 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:13,775 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:13,775 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:13,776 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:13,776 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 22/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=7.82][A2025-05-19 01:24:13,777 [DEBUG] models.hook_bridge: 更新批次數據: epoch=21, batch=1, loss=7.817481994628906
2025-05-19 01:24:13,777 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:13,778 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 22/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.59it/s, loss=7.82][AEpoch 22/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.14it/s, loss=7.82]
2025-05-19 01:24:13,828 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 21。將保存捕獲的特徵向量。
2025-05-19 01:24:13,828 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:13,828 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:13,828 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:13,828 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:13,828 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:13,828 [INFO] models.hook_bridge: 開始為 val (epoch 21) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:13,829 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:13,829 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:13,829 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:13,831 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:13,831 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:13,838 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:13,838 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:13,893 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:13,894 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:14,370 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:14,692 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:14,692 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:14,693 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:14,693 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:14,697 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:14,697 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:14,738 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:14,738 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:14,842 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:15,053 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:15,053 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:15,053 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:15,054 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_head_0_val_features.pt
2025-05-19 01:24:15,055 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_head_0_val_features.pt
2025-05-19 01:24:15,087 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:15,088 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:15,331 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:15,563 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_head_0_val_tsne.pt
2025-05-19 01:24:15,564 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_21/layer_head_0_val_tsne.pt
2025-05-19 01:24:15,564 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:15,564 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:15,564 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:15,564 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:15,564 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:15,564 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 21)。收集了 2 個批次的數據
2025-05-19 01:24:15,564 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:15,565 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:15,566 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:15,566 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 21
2025-05-19 01:24:15,567 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 21 檢測到驗證集 outputs 和 targets，準備保存 epoch_21_validation_predictions.pt
2025-05-19 01:24:15,568 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 21 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_21_validation_predictions.pt
2025-05-19 01:24:15,568 [INFO] trainers.pytorch_trainer: Epoch 22/30 - 訓練損失: 16.5608, 驗證損失: 9.3614
2025-05-19 01:24:15,568 [INFO] models.hook_bridge: 開始 epoch 22

Epoch 23/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:16,077 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:16,181 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:16,186 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 22
2025-05-19 01:24:16,210 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:16,226 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:16,234 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:16,252 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:16,256 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:16,257 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:16,259 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,259 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:16,259 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:16,260 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:16,260 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,260 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 23/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=16.2][A2025-05-19 01:24:16,423 [DEBUG] models.hook_bridge: 更新批次數據: epoch=22, batch=0, loss=16.189083099365234
2025-05-19 01:24:16,423 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:16,423 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 23/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.18it/s, loss=16.2][A2025-05-19 01:24:16,423 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:16,469 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:16,475 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 22
2025-05-19 01:24:16,480 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:16,489 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:16,497 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:16,513 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:16,517 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:16,517 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:16,518 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,519 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:16,519 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:16,519 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:16,520 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,520 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 23/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.18it/s, loss=28.5][A2025-05-19 01:24:16,625 [DEBUG] models.hook_bridge: 更新批次數據: epoch=22, batch=1, loss=28.53190803527832
2025-05-19 01:24:16,626 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:16,626 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 23/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.13it/s, loss=28.5][A2025-05-19 01:24:16,626 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:16,705 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:16,708 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 22
2025-05-19 01:24:16,712 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:16,721 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:16,727 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:16,739 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:16,743 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:16,743 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:16,744 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,745 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:16,745 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:16,745 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:16,746 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,746 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 23/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.13it/s, loss=30.4][A2025-05-19 01:24:16,846 [DEBUG] models.hook_bridge: 更新批次數據: epoch=22, batch=2, loss=30.37877655029297
2025-05-19 01:24:16,846 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:16,846 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 23/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.81it/s, loss=30.4][A2025-05-19 01:24:16,847 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:16,856 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:16,857 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 22
2025-05-19 01:24:16,858 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:16,862 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:16,865 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:16,874 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:16,876 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:16,877 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:16,878 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,878 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:16,878 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:16,879 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:16,879 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:16,879 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 23/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.81it/s, loss=9.49][A2025-05-19 01:24:16,942 [DEBUG] models.hook_bridge: 更新批次數據: epoch=22, batch=3, loss=9.4868803024292
2025-05-19 01:24:16,943 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:16,943 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 23/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.83it/s, loss=9.49]
2025-05-19 01:24:17,105 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_22/gns_stats_epoch_22.json
2025-05-19 01:24:17,105 [INFO] trainers.pytorch_trainer: Epoch 22 GNS = 0.0000
2025-05-19 01:24:17,108 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 22。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:17,109 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:17,109 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:17,109 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:17,110 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:17,111 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:17,111 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 22)
2025-05-19 01:24:17,111 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 22)

Epoch 23/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:17,531 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:17,826 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:17,833 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 22
2025-05-19 01:24:17,858 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:17,872 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:17,880 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:17,883 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:17,898 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:17,903 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:17,904 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:17,904 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:17,904 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 23/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=8.06][A2025-05-19 01:24:17,912 [DEBUG] models.hook_bridge: 更新批次數據: epoch=22, batch=0, loss=8.062832832336426
2025-05-19 01:24:17,912 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:17,912 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 23/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.25it/s, loss=8.06][A2025-05-19 01:24:17,912 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:17,949 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:17,955 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 22
2025-05-19 01:24:17,978 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:17,987 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:17,994 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:17,995 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:18,010 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:18,015 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:18,016 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:18,016 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:18,016 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 23/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.25it/s, loss=13.1][A2025-05-19 01:24:18,017 [DEBUG] models.hook_bridge: 更新批次數據: epoch=22, batch=1, loss=13.066722869873047
2025-05-19 01:24:18,018 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:18,018 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 23/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.55it/s, loss=13.1][AEpoch 23/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.11it/s, loss=13.1]
2025-05-19 01:24:18,070 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 22。將保存捕獲的特徵向量。
2025-05-19 01:24:18,070 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:18,070 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:18,070 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:18,070 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:18,070 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:18,070 [INFO] models.hook_bridge: 開始為 val (epoch 22) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:18,070 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:18,070 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:18,070 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:18,100 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:18,100 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:18,106 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:18,107 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:18,159 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:18,159 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:18,602 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:18,847 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:18,848 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:18,861 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:18,861 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:18,865 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:18,865 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:18,909 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:18,909 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:19,022 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:19,234 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:19,235 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:19,235 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:19,236 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_head_0_val_features.pt
2025-05-19 01:24:19,236 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_head_0_val_features.pt
2025-05-19 01:24:19,269 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:19,269 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:19,321 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:19,546 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_head_0_val_tsne.pt
2025-05-19 01:24:19,546 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_22/layer_head_0_val_tsne.pt
2025-05-19 01:24:19,546 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:19,546 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:19,547 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:19,547 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:19,547 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:19,547 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 22)。收集了 2 個批次的數據
2025-05-19 01:24:19,547 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:19,547 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:19,548 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:19,548 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 22
2025-05-19 01:24:19,549 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 22 檢測到驗證集 outputs 和 targets，準備保存 epoch_22_validation_predictions.pt
2025-05-19 01:24:19,549 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 22 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_22_validation_predictions.pt
2025-05-19 01:24:19,550 [INFO] trainers.pytorch_trainer: Epoch 23/30 - 訓練損失: 21.1467, 驗證損失: 10.5648
2025-05-19 01:24:19,550 [INFO] models.hook_bridge: 開始 epoch 23

Epoch 24/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:20,096 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:20,153 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:20,170 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 23
2025-05-19 01:24:20,194 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:20,211 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:20,220 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:20,236 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:20,241 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:20,241 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:20,244 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,244 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:20,244 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:20,245 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:20,245 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,245 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 24/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=10.9][A2025-05-19 01:24:20,411 [DEBUG] models.hook_bridge: 更新批次數據: epoch=23, batch=0, loss=10.927373886108398
2025-05-19 01:24:20,412 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:20,412 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 24/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.17it/s, loss=10.9][A2025-05-19 01:24:20,412 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:20,460 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:20,466 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 23
2025-05-19 01:24:20,471 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:20,481 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:20,487 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:20,505 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:20,509 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:20,509 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:20,511 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,511 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:20,511 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:20,512 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:20,512 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,512 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 24/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.17it/s, loss=9.13][A2025-05-19 01:24:20,623 [DEBUG] models.hook_bridge: 更新批次數據: epoch=23, batch=1, loss=9.126757621765137
2025-05-19 01:24:20,624 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:20,624 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 24/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=9.13][A2025-05-19 01:24:20,624 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:20,665 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:20,668 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 23
2025-05-19 01:24:20,674 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:20,683 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:20,688 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:20,701 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:20,704 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:20,704 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:20,706 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,706 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:20,706 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:20,706 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:20,707 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,707 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 24/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.10it/s, loss=17.3][A2025-05-19 01:24:20,803 [DEBUG] models.hook_bridge: 更新批次數據: epoch=23, batch=2, loss=17.25002670288086
2025-05-19 01:24:20,803 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:20,803 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 24/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.93it/s, loss=17.3][A2025-05-19 01:24:20,803 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:20,815 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:20,816 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 23
2025-05-19 01:24:20,817 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:20,821 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:20,824 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:20,833 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:20,835 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:20,835 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:20,837 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,837 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:20,837 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:20,838 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:20,838 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:20,838 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 24/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.93it/s, loss=10.6][A2025-05-19 01:24:20,903 [DEBUG] models.hook_bridge: 更新批次數據: epoch=23, batch=3, loss=10.59896469116211
2025-05-19 01:24:20,903 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:20,904 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 24/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  4.06it/s, loss=10.6][AEpoch 24/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s, loss=10.6]
2025-05-19 01:24:21,152 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_23/gns_stats_epoch_23.json
2025-05-19 01:24:21,152 [INFO] trainers.pytorch_trainer: Epoch 23 GNS = 0.0000
2025-05-19 01:24:21,156 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 23。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:21,156 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:21,156 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:21,157 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:21,157 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:21,158 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:21,158 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 23)
2025-05-19 01:24:21,158 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 23)

Epoch 24/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:21,587 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:21,867 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:21,873 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 23
2025-05-19 01:24:21,897 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:21,911 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:21,919 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:21,922 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:21,937 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:21,943 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:21,943 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:21,943 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:21,944 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 24/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=3.52][A2025-05-19 01:24:21,951 [DEBUG] models.hook_bridge: 更新批次數據: epoch=23, batch=0, loss=3.520756483078003
2025-05-19 01:24:21,951 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:21,951 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 24/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=3.52][A2025-05-19 01:24:21,951 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:21,988 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:21,994 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 23
2025-05-19 01:24:22,017 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:22,030 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:22,037 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:22,038 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:22,053 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:22,058 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:22,058 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:22,058 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:22,058 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 24/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.26it/s, loss=5.49][A2025-05-19 01:24:22,060 [DEBUG] models.hook_bridge: 更新批次數據: epoch=23, batch=1, loss=5.486709117889404
2025-05-19 01:24:22,060 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:22,060 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 24/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.56it/s, loss=5.49][AEpoch 24/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.12it/s, loss=5.49]
2025-05-19 01:24:22,110 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 23。將保存捕獲的特徵向量。
2025-05-19 01:24:22,110 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:22,110 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:22,110 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:22,110 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:22,110 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:22,110 [INFO] models.hook_bridge: 開始為 val (epoch 23) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:22,110 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:22,110 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:22,110 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:22,111 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:22,111 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:22,118 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:22,118 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:22,167 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:22,167 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:22,666 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:22,889 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:22,889 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:22,890 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:22,890 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:22,894 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:22,895 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:22,936 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:22,936 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:23,046 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:23,307 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:23,307 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:23,309 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:23,311 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_head_0_val_features.pt
2025-05-19 01:24:23,311 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_head_0_val_features.pt
2025-05-19 01:24:23,345 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:23,345 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:23,583 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:23,809 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_head_0_val_tsne.pt
2025-05-19 01:24:23,810 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_23/layer_head_0_val_tsne.pt
2025-05-19 01:24:23,810 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:23,810 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:23,810 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:23,810 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:23,810 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:23,811 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 23)。收集了 2 個批次的數據
2025-05-19 01:24:23,811 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:23,811 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:23,812 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:23,813 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 23
2025-05-19 01:24:23,814 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 23 檢測到驗證集 outputs 和 targets，準備保存 epoch_23_validation_predictions.pt
2025-05-19 01:24:23,815 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 23 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_23_validation_predictions.pt
2025-05-19 01:24:23,815 [INFO] trainers.pytorch_trainer: Epoch 24/30 - 訓練損失: 11.9758, 驗證損失: 4.5037
2025-05-19 01:24:23,815 [INFO] models.hook_bridge: 開始 epoch 24

Epoch 25/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:24,313 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:24,446 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:24,453 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 24
2025-05-19 01:24:24,477 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:24,493 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:24,501 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:24,519 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:24,523 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:24,524 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:24,526 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:24,526 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:24,527 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:24,528 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:24,528 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:24,528 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 25/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=8.41][A2025-05-19 01:24:24,720 [DEBUG] models.hook_bridge: 更新批次數據: epoch=24, batch=0, loss=8.412357330322266
2025-05-19 01:24:24,720 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:24,721 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 25/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.11it/s, loss=8.41][A2025-05-19 01:24:24,721 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:24,761 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:24,765 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 24
2025-05-19 01:24:24,771 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:24,780 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:24,786 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:24,799 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:24,802 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:24,802 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:24,804 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:24,804 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:24,804 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:24,805 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:24,805 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:24,805 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 25/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.11it/s, loss=15.1][A2025-05-19 01:24:24,915 [DEBUG] models.hook_bridge: 更新批次數據: epoch=24, batch=1, loss=15.140152931213379
2025-05-19 01:24:24,915 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:24,915 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 25/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.06it/s, loss=15.1][A2025-05-19 01:24:24,915 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:24,948 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:24,951 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 24
2025-05-19 01:24:24,957 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:24,966 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:24,972 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:24,985 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:24,988 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:24,989 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:24,990 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:24,990 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:24,990 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:24,991 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:24,991 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:24,991 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 25/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.06it/s, loss=11.7][A2025-05-19 01:24:25,134 [DEBUG] models.hook_bridge: 更新批次數據: epoch=24, batch=2, loss=11.697087287902832
2025-05-19 01:24:25,134 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:25,134 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 25/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.75it/s, loss=11.7][A2025-05-19 01:24:25,135 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:25,150 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:25,151 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 24
2025-05-19 01:24:25,152 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:25,156 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:25,160 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:25,169 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:25,171 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:25,172 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:25,173 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:25,173 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:25,173 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:25,174 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:25,174 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:25,174 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 25/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.75it/s, loss=13.1][A2025-05-19 01:24:25,231 [DEBUG] models.hook_bridge: 更新批次數據: epoch=24, batch=3, loss=13.115999221801758
2025-05-19 01:24:25,231 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:25,231 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 25/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.73it/s, loss=13.1]
2025-05-19 01:24:25,424 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/gns_stats_epoch_24.json
2025-05-19 01:24:25,424 [INFO] trainers.pytorch_trainer: Epoch 24 GNS = 0.0000
2025-05-19 01:24:25,428 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 24。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:25,428 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:25,428 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:25,429 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:25,429 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:25,429 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:25,429 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 24)
2025-05-19 01:24:25,429 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 24)

Epoch 25/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:25,857 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:26,127 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:26,134 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 24
2025-05-19 01:24:26,157 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:26,172 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:26,180 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:26,183 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:26,198 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:26,203 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:26,204 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:26,204 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:26,204 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 25/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=2.21][A2025-05-19 01:24:26,212 [DEBUG] models.hook_bridge: 更新批次數據: epoch=24, batch=0, loss=2.207520008087158
2025-05-19 01:24:26,212 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:26,212 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 25/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=2.21][A2025-05-19 01:24:26,212 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:26,249 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:26,255 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 24
2025-05-19 01:24:26,278 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:26,287 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:26,295 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:26,295 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:26,311 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:26,316 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:26,316 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:26,316 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:26,316 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 25/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.28it/s, loss=1.98][A2025-05-19 01:24:26,318 [DEBUG] models.hook_bridge: 更新批次數據: epoch=24, batch=1, loss=1.978939175605774
2025-05-19 01:24:26,318 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:26,318 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 25/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.60it/s, loss=1.98][AEpoch 25/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.15it/s, loss=1.98]
2025-05-19 01:24:26,369 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 24。將保存捕獲的特徵向量。
2025-05-19 01:24:26,369 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:26,369 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:26,369 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:26,369 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:26,369 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:26,369 [INFO] models.hook_bridge: 開始為 val (epoch 24) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:26,369 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:26,369 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:26,369 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:26,370 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:26,370 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:26,377 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:26,377 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:26,429 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:26,429 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:26,953 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:27,167 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:27,167 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:27,167 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:27,167 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:27,171 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:27,171 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:27,212 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:27,212 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:27,463 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:27,736 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:27,737 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:27,737 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:27,738 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_head_0_val_features.pt
2025-05-19 01:24:27,738 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_head_0_val_features.pt
2025-05-19 01:24:27,771 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:27,771 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:27,870 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:28,090 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_head_0_val_tsne.pt
2025-05-19 01:24:28,090 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_24/layer_head_0_val_tsne.pt
2025-05-19 01:24:28,091 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:28,091 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:28,091 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:28,091 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:28,091 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:28,091 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 24)。收集了 2 個批次的數據
2025-05-19 01:24:28,091 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:28,092 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:28,093 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:28,457 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:24:28,463 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:24:28,464 [INFO] trainers.pytorch_trainer: Epoch 25/30 - 保存新的最佳模型: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:24:29,495 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_24.pth
2025-05-19 01:24:29,496 [INFO] trainers.pytorch_trainer: Epoch 25/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_24.pth
2025-05-19 01:24:29,536 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:24:29,538 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:24:29,540 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:24:29,541 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:24:29,542 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:29,544 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:29,545 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:29,547 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:29,553 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:29,555 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:29,557 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:29,558 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:29,560 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:29,561 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:29,569 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:29,570 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:29,576 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:29,577 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:29,579 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:29,580 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:29,581 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:29,590 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:29,591 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:29,593 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:29,595 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:29,596 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:29,597 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:29,603 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:29,604 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:29,610 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:29,611 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:24:29,621 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:24:29,622 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:24:29,623 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:29,625 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:29,626 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:29,628 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:29,642 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:29,643 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:29,649 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:29,650 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:29,652 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:29,654 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:29,821 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:29,824 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:29,843 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:29,846 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:29,848 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:29,851 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:29,854 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:29,871 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:29,874 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:29,880 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:29,883 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:29,885 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:29,888 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:29,907 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:29,910 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:29,929 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:29,933 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:24:29,966 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:24:29,969 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:24:29,972 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:29,974 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:29,977 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:29,981 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:30,028 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:30,031 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:30,051 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:30,053 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:30,056 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:30,061 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:30,124 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:30,128 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:30,191 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:30,193 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:30,196 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:30,198 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:30,209 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:30,258 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:30,261 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:30,280 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:30,283 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:30,285 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:30,290 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:30,352 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:30,357 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:30,419 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:30,421 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:24:30,424 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:24:30,426 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:30,432 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:30,488 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:30,491 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:30,510 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:30,512 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:24:30,515 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:24:30,519 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:30,582 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:30,587 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:30,650 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:30,653 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:24:30,656 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:24:30,658 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:30,665 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:30,717 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:30,721 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:30,740 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:30,742 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:24:30,745 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:24:30,750 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:30,811 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:30,816 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:30,936 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:30,938 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:24:30,941 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:24:30,943 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:30,948 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:30,995 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:30,998 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:31,017 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:31,019 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:24:31,022 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:24:31,027 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:31,087 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:31,092 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:31,165 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:31,168 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:24:31,170 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:24:31,173 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:31,177 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:31,229 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:31,232 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:31,253 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:31,256 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:24:31,258 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:24:31,263 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:31,324 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:31,329 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:31,389 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:31,405 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:24:31,421 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:24:31,423 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:24:31,426 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:31,429 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:31,431 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:31,441 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:31,456 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:31,460 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:31,521 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:31,524 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:31,527 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:31,538 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:31,553 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:31,565 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:31,579 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:31,582 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:31,585 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:31,587 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:31,597 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:31,613 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:31,618 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:31,680 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:31,683 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:31,685 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:31,697 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:31,712 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:31,723 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:31,738 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:31,741 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_norm_weight_gradient_all.pt
2025-05-19 01:24:31,743 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/backbone_norm_bias_gradient_all.pt
2025-05-19 01:24:31,746 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/head_1_weight_gradient_all.pt
2025-05-19 01:24:31,748 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/head_1_bias_gradient_all.pt
2025-05-19 01:24:31,751 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:24:31,769 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:24:31,772 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:24:31,774 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:24:31,776 [INFO] trainers.pytorch_trainer: Epoch 24: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:24:35,725 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/gns_stats_epoch_24.json
2025-05-19 01:24:35,726 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 24
2025-05-19 01:24:35,726 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 24 檢測到驗證集 outputs 和 targets，準備保存 epoch_24_validation_predictions.pt
2025-05-19 01:24:35,727 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 24 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24_validation_predictions.pt
2025-05-19 01:24:35,727 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 24 達到保存頻率，調用 save_manager.save_epoch_summary
2025-05-19 01:24:35,727 [INFO] utils.save_manager: Epoch 24 摘要已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_24/epoch_summary.pt
2025-05-19 01:24:35,728 [INFO] trainers.pytorch_trainer: Epoch 25/30 - 訓練損失: 12.0914, 驗證損失: 2.0932
2025-05-19 01:24:35,728 [INFO] models.hook_bridge: 開始 epoch 25

Epoch 26/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:36,298 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:36,448 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:36,455 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 25
2025-05-19 01:24:36,480 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:36,496 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:36,504 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:36,522 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:36,526 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:36,527 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:36,529 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:36,529 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:36,529 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:36,530 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:36,530 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:36,531 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 26/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=8.64][A2025-05-19 01:24:36,708 [DEBUG] models.hook_bridge: 更新批次數據: epoch=25, batch=0, loss=8.639140129089355
2025-05-19 01:24:36,708 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:36,708 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 26/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.02it/s, loss=8.64][A2025-05-19 01:24:36,709 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:36,758 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:36,764 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 25
2025-05-19 01:24:36,769 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:36,785 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:36,793 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:36,806 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:36,810 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:36,810 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:36,812 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:36,812 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:36,812 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:36,812 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:36,813 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:36,813 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 26/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.02it/s, loss=12.3][A2025-05-19 01:24:36,916 [DEBUG] models.hook_bridge: 更新批次數據: epoch=25, batch=1, loss=12.272698402404785
2025-05-19 01:24:36,916 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:36,916 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 26/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.91it/s, loss=12.3][A2025-05-19 01:24:36,916 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:36,953 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:36,961 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 25
2025-05-19 01:24:36,966 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:36,975 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:36,980 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:36,993 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:36,996 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:36,997 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:36,998 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:36,998 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:36,999 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:36,999 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:36,999 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:36,999 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 26/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.91it/s, loss=14.1][A2025-05-19 01:24:37,099 [DEBUG] models.hook_bridge: 更新批次數據: epoch=25, batch=2, loss=14.102652549743652
2025-05-19 01:24:37,099 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:37,099 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 26/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.71it/s, loss=14.1][A2025-05-19 01:24:37,100 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:37,109 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:37,110 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 25
2025-05-19 01:24:37,111 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:37,115 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:37,119 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:37,127 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:37,129 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:37,130 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:37,131 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:37,131 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:37,132 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:37,132 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:37,132 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:37,132 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 26/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.71it/s, loss=9.59][A2025-05-19 01:24:37,200 [DEBUG] models.hook_bridge: 更新批次數據: epoch=25, batch=3, loss=9.591239929199219
2025-05-19 01:24:37,201 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:37,201 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 26/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.80it/s, loss=9.59][AEpoch 26/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.64it/s, loss=9.59]
2025-05-19 01:24:37,372 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_25/gns_stats_epoch_25.json
2025-05-19 01:24:37,372 [INFO] trainers.pytorch_trainer: Epoch 25 GNS = 0.0000
2025-05-19 01:24:37,375 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 25。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:37,375 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:37,375 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:37,376 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:37,376 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:37,377 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:37,377 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 25)
2025-05-19 01:24:37,377 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 25)

Epoch 26/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:37,792 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:38,101 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:38,107 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 25
2025-05-19 01:24:38,131 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:38,145 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:38,153 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:38,156 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:38,172 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:38,177 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:38,177 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:38,177 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:38,178 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 26/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=6.38][A2025-05-19 01:24:38,184 [DEBUG] models.hook_bridge: 更新批次數據: epoch=25, batch=0, loss=6.379027843475342
2025-05-19 01:24:38,184 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:38,184 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 26/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=6.38][A2025-05-19 01:24:38,184 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:38,219 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:38,225 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 25
2025-05-19 01:24:38,248 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:38,262 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:38,270 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:38,271 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:38,286 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:38,291 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:38,291 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:38,291 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:38,291 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 26/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=4.62][A2025-05-19 01:24:38,293 [DEBUG] models.hook_bridge: 更新批次數據: epoch=25, batch=1, loss=4.624828338623047
2025-05-19 01:24:38,293 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:38,293 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 26/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.52it/s, loss=4.62][AEpoch 26/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.09it/s, loss=4.62]
2025-05-19 01:24:38,339 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 25。將保存捕獲的特徵向量。
2025-05-19 01:24:38,340 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:38,340 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:38,340 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:38,340 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:38,340 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:38,340 [INFO] models.hook_bridge: 開始為 val (epoch 25) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:38,340 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:38,340 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:38,340 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:38,341 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:38,341 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:38,348 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:38,348 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:38,397 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:38,397 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:39,037 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:39,244 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:39,244 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:39,244 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:39,245 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:39,249 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:39,249 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:39,290 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:39,290 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:39,400 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:39,706 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:39,706 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:39,706 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:39,708 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_head_0_val_features.pt
2025-05-19 01:24:39,708 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_head_0_val_features.pt
2025-05-19 01:24:39,741 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:39,741 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:40,016 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:40,246 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_head_0_val_tsne.pt
2025-05-19 01:24:40,246 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_25/layer_head_0_val_tsne.pt
2025-05-19 01:24:40,246 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:40,246 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:40,246 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:40,247 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:40,247 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:40,247 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 25)。收集了 2 個批次的數據
2025-05-19 01:24:40,247 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:40,247 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:40,248 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:40,250 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 25
2025-05-19 01:24:40,250 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 25 檢測到驗證集 outputs 和 targets，準備保存 epoch_25_validation_predictions.pt
2025-05-19 01:24:40,251 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 25 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_25_validation_predictions.pt
2025-05-19 01:24:40,251 [INFO] trainers.pytorch_trainer: Epoch 26/30 - 訓練損失: 11.1514, 驗證損失: 5.5019
2025-05-19 01:24:40,252 [INFO] models.hook_bridge: 開始 epoch 26

Epoch 27/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:40,742 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:40,879 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:40,886 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 26
2025-05-19 01:24:40,910 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:40,926 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:40,934 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:40,952 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:40,956 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:40,957 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:40,959 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:40,959 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:40,960 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:40,960 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:40,961 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:40,961 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 27/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=8.95][A2025-05-19 01:24:41,140 [DEBUG] models.hook_bridge: 更新批次數據: epoch=26, batch=0, loss=8.946412086486816
2025-05-19 01:24:41,140 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:41,140 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 27/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.13it/s, loss=8.95][A2025-05-19 01:24:41,141 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:41,190 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:41,196 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 26
2025-05-19 01:24:41,202 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:41,211 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:41,216 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:41,230 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:41,234 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:41,234 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:41,235 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:41,236 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:41,236 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:41,236 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:41,237 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:41,237 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 27/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.13it/s, loss=12.2][A2025-05-19 01:24:41,343 [DEBUG] models.hook_bridge: 更新批次數據: epoch=26, batch=1, loss=12.188036918640137
2025-05-19 01:24:41,343 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:41,343 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 27/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.07it/s, loss=12.2][A2025-05-19 01:24:41,343 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:41,379 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:41,382 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 26
2025-05-19 01:24:41,387 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:41,396 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:41,401 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:41,413 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:41,417 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:41,417 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:41,419 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:41,419 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:41,419 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:41,420 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:41,420 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:41,420 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 27/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.07it/s, loss=15.9][A2025-05-19 01:24:41,590 [DEBUG] models.hook_bridge: 更新批次數據: epoch=26, batch=2, loss=15.877163887023926
2025-05-19 01:24:41,590 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:41,590 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 27/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.66it/s, loss=15.9][A2025-05-19 01:24:41,590 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:41,612 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:41,617 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 26
2025-05-19 01:24:41,618 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:41,622 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:41,625 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:41,634 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:41,636 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:41,636 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:41,638 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:41,638 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:41,638 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:41,639 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:41,639 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:41,639 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 27/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.66it/s, loss=11.3][A2025-05-19 01:24:41,697 [DEBUG] models.hook_bridge: 更新批次數據: epoch=26, batch=3, loss=11.314987182617188
2025-05-19 01:24:41,698 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:41,698 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 27/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  3.71it/s, loss=11.3][AEpoch 27/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.68it/s, loss=11.3]
2025-05-19 01:24:41,899 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_26/gns_stats_epoch_26.json
2025-05-19 01:24:41,899 [INFO] trainers.pytorch_trainer: Epoch 26 GNS = 0.0000
2025-05-19 01:24:41,902 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 26。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:41,903 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:41,903 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:41,903 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:41,904 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:41,904 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:41,904 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 26)
2025-05-19 01:24:41,904 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 26)

Epoch 27/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:42,312 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:42,626 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:42,632 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 26
2025-05-19 01:24:42,655 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:42,670 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:42,678 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:42,681 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:42,696 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:42,701 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:42,702 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:42,702 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:42,702 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 27/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=9.07][A2025-05-19 01:24:42,710 [DEBUG] models.hook_bridge: 更新批次數據: epoch=26, batch=0, loss=9.072551727294922
2025-05-19 01:24:42,710 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:42,710 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 27/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=9.07][A2025-05-19 01:24:42,710 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:42,744 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:42,750 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 26
2025-05-19 01:24:42,773 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:42,787 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:42,794 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:42,795 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:42,810 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:42,815 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:42,816 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:42,816 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:42,816 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 27/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.24it/s, loss=14.5][A2025-05-19 01:24:42,817 [DEBUG] models.hook_bridge: 更新批次數據: epoch=26, batch=1, loss=14.517755508422852
2025-05-19 01:24:42,818 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:42,818 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 27/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.53it/s, loss=14.5][AEpoch 27/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.10it/s, loss=14.5]
2025-05-19 01:24:42,865 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 26。將保存捕獲的特徵向量。
2025-05-19 01:24:42,865 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:42,865 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:42,865 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:42,865 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:42,865 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:42,865 [INFO] models.hook_bridge: 開始為 val (epoch 26) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:42,866 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:42,866 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:42,866 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:42,889 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:42,890 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:42,896 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:42,896 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:42,962 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:42,963 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:43,490 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:43,701 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:43,701 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:43,701 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:43,701 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:43,705 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:43,705 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:43,746 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:43,746 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:43,918 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:44,203 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:44,203 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:44,203 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:44,205 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_head_0_val_features.pt
2025-05-19 01:24:44,205 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_head_0_val_features.pt
2025-05-19 01:24:44,238 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:44,238 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:44,276 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:44,512 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_head_0_val_tsne.pt
2025-05-19 01:24:44,512 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_26/layer_head_0_val_tsne.pt
2025-05-19 01:24:44,512 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:44,512 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:44,512 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:44,512 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:44,512 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:44,512 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 26)。收集了 2 個批次的數據
2025-05-19 01:24:44,513 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:44,513 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:44,514 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:44,515 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 26
2025-05-19 01:24:44,516 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 26 檢測到驗證集 outputs 和 targets，準備保存 epoch_26_validation_predictions.pt
2025-05-19 01:24:44,516 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 26 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_26_validation_predictions.pt
2025-05-19 01:24:44,517 [INFO] trainers.pytorch_trainer: Epoch 27/30 - 訓練損失: 12.0817, 驗證損失: 11.7952
2025-05-19 01:24:44,517 [INFO] models.hook_bridge: 開始 epoch 27

Epoch 28/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:45,048 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:45,101 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:45,121 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 27
2025-05-19 01:24:45,127 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:45,143 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:45,151 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:45,169 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:45,173 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:45,174 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:45,176 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,176 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:45,177 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:45,178 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:45,178 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,178 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 28/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=14.5][A2025-05-19 01:24:45,358 [DEBUG] models.hook_bridge: 更新批次數據: epoch=27, batch=0, loss=14.481070518493652
2025-05-19 01:24:45,358 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:45,358 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 28/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.19it/s, loss=14.5][A2025-05-19 01:24:45,358 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:45,396 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:45,402 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 27
2025-05-19 01:24:45,406 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:45,415 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:45,421 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:45,436 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:45,440 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:45,440 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:45,442 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,442 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:45,442 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:45,443 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:45,443 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,443 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 28/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.19it/s, loss=13.4][A2025-05-19 01:24:45,548 [DEBUG] models.hook_bridge: 更新批次數據: epoch=27, batch=1, loss=13.418831825256348
2025-05-19 01:24:45,548 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:45,548 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 28/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.19it/s, loss=13.4][A2025-05-19 01:24:45,548 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:45,583 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:45,587 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 27
2025-05-19 01:24:45,593 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:45,601 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:45,607 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:45,619 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:45,623 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:45,623 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:45,625 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,625 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:45,625 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:45,625 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:45,626 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,626 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 28/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.19it/s, loss=11.1][A2025-05-19 01:24:45,725 [DEBUG] models.hook_bridge: 更新批次數據: epoch=27, batch=2, loss=11.058442115783691
2025-05-19 01:24:45,725 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:45,725 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 28/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.04it/s, loss=11.1][A2025-05-19 01:24:45,726 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:45,734 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:45,737 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 27
2025-05-19 01:24:45,738 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:45,742 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:45,745 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:45,754 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:45,756 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:45,757 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:45,758 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,758 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:45,759 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:45,759 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:45,759 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:45,759 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 28/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  3.04it/s, loss=10.4][A2025-05-19 01:24:45,818 [DEBUG] models.hook_bridge: 更新批次數據: epoch=27, batch=3, loss=10.442914962768555
2025-05-19 01:24:45,818 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:45,818 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 28/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s, loss=10.4]
2025-05-19 01:24:45,989 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_27/gns_stats_epoch_27.json
2025-05-19 01:24:45,989 [INFO] trainers.pytorch_trainer: Epoch 27 GNS = 0.0000
2025-05-19 01:24:45,992 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 27。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:45,992 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:45,993 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:45,993 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:45,993 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:45,993 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:45,993 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 27)
2025-05-19 01:24:45,993 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 27)

Epoch 28/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:46,422 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:46,734 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:46,740 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 27
2025-05-19 01:24:46,763 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:46,776 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:46,784 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:46,788 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:46,803 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:46,808 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:46,808 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:46,809 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:46,809 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 28/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=4.79][A2025-05-19 01:24:46,816 [DEBUG] models.hook_bridge: 更新批次數據: epoch=27, batch=0, loss=4.788347244262695
2025-05-19 01:24:46,816 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:46,817 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 28/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.22it/s, loss=4.79][A2025-05-19 01:24:46,817 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:46,852 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:46,858 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 27
2025-05-19 01:24:46,881 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:46,889 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:46,897 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:46,898 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:46,913 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:46,918 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:46,918 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:46,918 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:46,919 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 28/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.22it/s, loss=2.96][A2025-05-19 01:24:46,920 [DEBUG] models.hook_bridge: 更新批次數據: epoch=27, batch=1, loss=2.957174777984619
2025-05-19 01:24:46,920 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:46,920 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 28/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.50it/s, loss=2.96][AEpoch 28/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.07it/s, loss=2.96]
2025-05-19 01:24:46,969 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 27。將保存捕獲的特徵向量。
2025-05-19 01:24:46,969 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:46,969 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:46,969 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:46,969 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:46,969 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:46,969 [INFO] models.hook_bridge: 開始為 val (epoch 27) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:46,969 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:46,969 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:46,969 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:46,970 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:46,971 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:46,978 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:46,978 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:47,026 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:47,026 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:47,525 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:47,739 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:47,739 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:47,740 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:47,740 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:47,744 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:47,744 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:47,785 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:47,785 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:47,902 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:48,116 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:48,116 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:48,116 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:48,117 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_head_0_val_features.pt
2025-05-19 01:24:48,117 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_head_0_val_features.pt
2025-05-19 01:24:48,149 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:48,149 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:48,423 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:48,667 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_head_0_val_tsne.pt
2025-05-19 01:24:48,668 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_27/layer_head_0_val_tsne.pt
2025-05-19 01:24:48,668 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:48,668 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:48,668 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:48,668 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:48,668 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:48,668 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 27)。收集了 2 個批次的數據
2025-05-19 01:24:48,668 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:48,668 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:48,669 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:48,670 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 27
2025-05-19 01:24:48,670 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 27 檢測到驗證集 outputs 和 targets，準備保存 epoch_27_validation_predictions.pt
2025-05-19 01:24:48,671 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 27 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_27_validation_predictions.pt
2025-05-19 01:24:48,671 [INFO] trainers.pytorch_trainer: Epoch 28/30 - 訓練損失: 12.3503, 驗證損失: 3.8728
2025-05-19 01:24:48,671 [INFO] models.hook_bridge: 開始 epoch 28

Epoch 29/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:49,220 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:49,261 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:49,267 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 28
2025-05-19 01:24:49,290 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:49,307 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:49,314 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:49,332 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:49,337 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:49,337 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:49,339 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:49,339 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:49,340 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:49,340 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:49,341 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:49,341 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 29/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=12.9][A2025-05-19 01:24:49,538 [DEBUG] models.hook_bridge: 更新批次數據: epoch=28, batch=0, loss=12.888655662536621
2025-05-19 01:24:49,538 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:49,538 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 29/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.16it/s, loss=12.9][A2025-05-19 01:24:49,539 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:49,577 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:49,583 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 28
2025-05-19 01:24:49,606 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:49,617 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:49,625 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:49,640 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:49,645 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:49,645 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:49,647 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:49,647 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:49,647 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:49,648 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:49,648 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:49,648 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 29/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.16it/s, loss=10.9][A2025-05-19 01:24:49,766 [DEBUG] models.hook_bridge: 更新批次數據: epoch=28, batch=1, loss=10.899962425231934
2025-05-19 01:24:49,766 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:49,766 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 29/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.04it/s, loss=10.9][A2025-05-19 01:24:49,766 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:49,811 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:49,818 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 28
2025-05-19 01:24:49,841 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:49,850 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:49,855 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:49,867 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:49,871 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:49,871 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:49,873 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:49,873 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:49,873 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:49,874 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:49,874 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:49,874 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 29/30 [Train]:  50%|█████     | 2/4 [00:01<00:00,  2.04it/s, loss=7.81][A2025-05-19 01:24:49,971 [DEBUG] models.hook_bridge: 更新批次數據: epoch=28, batch=2, loss=7.807180881500244
2025-05-19 01:24:49,971 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:49,971 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 29/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.78it/s, loss=7.81][A2025-05-19 01:24:49,972 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:49,981 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:49,983 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 28
2025-05-19 01:24:49,984 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:49,991 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:49,994 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:50,002 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:50,005 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:50,005 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:50,007 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:50,007 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:50,007 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:50,007 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:50,008 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:50,008 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 29/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.78it/s, loss=22.6][A2025-05-19 01:24:50,065 [DEBUG] models.hook_bridge: 更新批次數據: epoch=28, batch=3, loss=22.58304214477539
2025-05-19 01:24:50,066 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:50,066 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 29/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.79it/s, loss=22.6]
2025-05-19 01:24:50,235 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_28/gns_stats_epoch_28.json
2025-05-19 01:24:50,235 [INFO] trainers.pytorch_trainer: Epoch 28 GNS = 0.0000
2025-05-19 01:24:50,238 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 28。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:50,239 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:50,239 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:50,239 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:50,239 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:50,239 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:50,240 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 28)
2025-05-19 01:24:50,240 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 28)

Epoch 29/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:50,670 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:50,989 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:50,995 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 28
2025-05-19 01:24:51,018 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:51,033 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:51,041 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:51,045 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:51,060 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:51,065 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:51,066 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:51,066 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:51,066 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 29/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=3.25][A2025-05-19 01:24:51,073 [DEBUG] models.hook_bridge: 更新批次數據: epoch=28, batch=0, loss=3.253997802734375
2025-05-19 01:24:51,073 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:51,074 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 29/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.20it/s, loss=3.25][A2025-05-19 01:24:51,074 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:51,108 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:51,113 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 28
2025-05-19 01:24:51,137 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:51,151 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:51,158 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:51,159 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:51,174 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:51,179 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:51,180 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:51,180 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:51,180 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 29/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.20it/s, loss=5.12][A2025-05-19 01:24:51,182 [DEBUG] models.hook_bridge: 更新批次數據: epoch=28, batch=1, loss=5.115231037139893
2025-05-19 01:24:51,182 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:51,182 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 29/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.46it/s, loss=5.12][AEpoch 29/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.03it/s, loss=5.12]
2025-05-19 01:24:51,234 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 28。將保存捕獲的特徵向量。
2025-05-19 01:24:51,234 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:51,234 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:51,234 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:51,234 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:51,234 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:51,234 [INFO] models.hook_bridge: 開始為 val (epoch 28) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:51,234 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:51,234 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:51,234 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:51,235 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:51,235 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:51,243 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:51,243 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:51,292 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:51,292 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:51,742 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:51,943 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:51,944 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:51,944 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:51,944 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:51,948 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:51,948 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:51,990 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:51,990 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:52,317 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:52,604 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:52,604 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:52,605 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:52,606 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_head_0_val_features.pt
2025-05-19 01:24:52,606 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_head_0_val_features.pt
2025-05-19 01:24:52,640 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:52,640 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:52,895 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:53,133 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_head_0_val_tsne.pt
2025-05-19 01:24:53,133 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_28/layer_head_0_val_tsne.pt
2025-05-19 01:24:53,133 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:53,133 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:53,133 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:53,133 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:53,134 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:53,134 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 28)。收集了 2 個批次的數據
2025-05-19 01:24:53,134 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:53,134 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:53,135 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:53,136 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 28
2025-05-19 01:24:53,137 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 28 檢測到驗證集 outputs 和 targets，準備保存 epoch_28_validation_predictions.pt
2025-05-19 01:24:53,137 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 28 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_28_validation_predictions.pt
2025-05-19 01:24:53,138 [INFO] trainers.pytorch_trainer: Epoch 29/30 - 訓練損失: 13.5447, 驗證損失: 4.1846
2025-05-19 01:24:53,138 [INFO] models.hook_bridge: 開始 epoch 29

Epoch 30/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s][A2025-05-19 01:24:53,648 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:53,835 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:53,842 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 29
2025-05-19 01:24:53,865 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:53,877 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:53,885 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:53,903 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:53,908 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:53,908 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:53,910 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:53,910 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:53,911 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:53,911 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:53,912 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:53,912 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 30/30 [Train]:   0%|          | 0/4 [00:00<?, ?it/s, loss=5.17][A2025-05-19 01:24:54,098 [DEBUG] models.hook_bridge: 更新批次數據: epoch=29, batch=0, loss=5.165735244750977
2025-05-19 01:24:54,098 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:54,098 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 30/30 [Train]:  25%|██▌       | 1/4 [00:00<00:02,  1.05it/s, loss=5.17][A2025-05-19 01:24:54,099 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:54,137 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:54,143 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 29
2025-05-19 01:24:54,165 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:54,174 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:54,183 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:54,196 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:54,200 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:54,200 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:54,201 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:54,202 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:54,202 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:54,202 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:54,203 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:54,203 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 30/30 [Train]:  25%|██▌       | 1/4 [00:01<00:02,  1.05it/s, loss=18.8][A2025-05-19 01:24:54,304 [DEBUG] models.hook_bridge: 更新批次數據: epoch=29, batch=1, loss=18.760787963867188
2025-05-19 01:24:54,304 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:54,304 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 30/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.94it/s, loss=18.8][A2025-05-19 01:24:54,304 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:54,340 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:54,343 [DEBUG] models.hook_bridge: 開始批次 2 處理 in epoch 29
2025-05-19 01:24:54,348 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:54,358 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:54,363 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:54,376 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:54,380 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:54,380 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:54,382 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:54,382 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:54,382 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:54,383 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:54,383 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:54,383 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 30/30 [Train]:  50%|█████     | 2/4 [00:01<00:01,  1.94it/s, loss=13.9][A2025-05-19 01:24:54,482 [DEBUG] models.hook_bridge: 更新批次數據: epoch=29, batch=2, loss=13.932978630065918
2025-05-19 01:24:54,482 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:54,482 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 2，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。

Epoch 30/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.77it/s, loss=13.9][A2025-05-19 01:24:54,482 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:54,491 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:54,494 [DEBUG] models.hook_bridge: 開始批次 3 處理 in epoch 29
2025-05-19 01:24:54,494 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([8, 32, 39, 96])
2025-05-19 01:24:54,498 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([8, 16, 20, 192])
2025-05-19 01:24:54,502 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:54,510 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([8, 8, 10, 384])
2025-05-19 01:24:54,512 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:54,512 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([8, 3])
2025-05-19 01:24:54,514 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:54,514 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.2.weight' 的梯度，形狀: torch.Size([3, 128])
2025-05-19 01:24:54,514 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.bias' 的梯度，形狀: torch.Size([128])
2025-05-19 01:24:54,515 [DEBUG] models.hook_bridge: 捕獲參數 'skip_connection.0.weight' 的梯度，形狀: torch.Size([128, 768])
2025-05-19 01:24:54,515 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.bias' 的梯度，形狀: torch.Size([3])
2025-05-19 01:24:54,515 [DEBUG] models.hook_bridge: 捕獲參數 'head.1.weight' 的梯度，形狀: torch.Size([3, 768])

Epoch 30/30 [Train]:  75%|███████▌  | 3/4 [00:01<00:00,  2.77it/s, loss=15.1][A2025-05-19 01:24:54,575 [DEBUG] models.hook_bridge: 更新批次數據: epoch=29, batch=3, loss=15.144307136535645
2025-05-19 01:24:54,575 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'test' 與當前評估數據集 'train' 不匹配。
2025-05-19 01:24:54,575 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 3，因為目標數據集 'val' 與當前評估數據集 'train' 不匹配。
Epoch 30/30 [Train]: 100%|██████████| 4/4 [00:01<00:00,  2.70it/s, loss=15.1]
2025-05-19 01:24:54,772 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/gns_stats_epoch_29.json
2025-05-19 01:24:54,772 [INFO] trainers.pytorch_trainer: Epoch 29 GNS = 0.0000
2025-05-19 01:24:54,776 [INFO] models.hook_bridge: 評估開始，數據集: val, Epoch: 29。將為此數據集註冊特徵向量鉤子。
2025-05-19 01:24:54,776 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:54,776 [INFO] models.hook_bridge: 已為層 'backbone.features.4' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:54,777 [INFO] models.hook_bridge: 已為層 'backbone.features.7' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:54,777 [INFO] models.hook_bridge: 已為層 'head.0' 註冊特徵向量捕獲鉤子
2025-05-19 01:24:54,779 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:24:54,779 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 29)
2025-05-19 01:24:54,779 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 29)

Epoch 30/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:24:55,195 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:55,281 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:55,287 [DEBUG] models.hook_bridge: 開始批次 0 處理 in epoch 29
2025-05-19 01:24:55,312 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:55,327 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:55,335 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:55,339 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:55,354 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:55,359 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:55,360 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:55,360 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:55,360 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 30/30 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=2.5][A2025-05-19 01:24:55,368 [DEBUG] models.hook_bridge: 更新批次數據: epoch=29, batch=0, loss=2.500863552093506
2025-05-19 01:24:55,368 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:55,368 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1

Epoch 30/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.70it/s, loss=2.5][A2025-05-19 01:24:55,462 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:24:55,495 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道
2025-05-19 01:24:55,501 [DEBUG] models.hook_bridge: 開始批次 1 處理 in epoch 29
2025-05-19 01:24:55,525 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.0' 的激活值，形狀: torch.Size([32, 32, 39, 96])
2025-05-19 01:24:55,539 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.2' 的激活值，形狀: torch.Size([32, 16, 20, 192])
2025-05-19 01:24:55,547 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.4' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:55,547 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.4' 的特徵向量，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:55,562 [DEBUG] models.hook_bridge: 捕獲層 'backbone.features.5' 的激活值，形狀: torch.Size([32, 8, 10, 384])
2025-05-19 01:24:55,568 [DEBUG] models.hook_bridge: 捕獲到層 'backbone.features.7' 的特徵向量，形狀: torch.Size([32, 4, 5, 768])
2025-05-19 01:24:55,568 [DEBUG] models.hook_bridge: 捕獲到層 'head.0' 的特徵向量，形狀: torch.Size([32, 768])
2025-05-19 01:24:55,568 [DEBUG] models.hook_bridge: 捕獲層 'head.1' 的激活值，形狀: torch.Size([32, 3])
2025-05-19 01:24:55,568 [DEBUG] models.hook_bridge: 捕獲層 'skip_connection.2' 的激活值，形狀: torch.Size([32, 3])

Epoch 30/30 [VAL]:  50%|█████     | 1/2 [00:00<00:00,  1.70it/s, loss=4]  [A2025-05-19 01:24:55,570 [DEBUG] models.hook_bridge: 更新批次數據: epoch=29, batch=1, loss=4.002025604248047
2025-05-19 01:24:55,570 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'test' 與當前評估數據集 'val' 不匹配。
2025-05-19 01:24:55,570 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2

Epoch 30/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.77it/s, loss=4][AEpoch 30/30 [VAL]: 100%|██████████| 2/2 [00:00<00:00,  2.40it/s, loss=4]
2025-05-19 01:24:55,620 [INFO] models.hook_bridge: 評估結束，數據集: val, Epoch: 29。將保存捕獲的特徵向量。
2025-05-19 01:24:55,620 [INFO] models.hook_bridge: 未從配置中找到標籤信息，使用默認值: DrLee_Evaluation
2025-05-19 01:24:55,620 [INFO] models.hook_bridge: 將使用以下標籤信息保存特徵向量：
2025-05-19 01:24:55,620 [INFO] models.hook_bridge:   標籤欄位: DrLee_Evaluation
2025-05-19 01:24:55,620 [INFO] models.hook_bridge:   標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:55,620 [INFO] models.hook_bridge:   標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:55,621 [INFO] models.hook_bridge: 開始為 val (epoch 29) 保存特徵向量。監控的層: ['backbone.features.4', 'backbone.features.7', 'head.0']
2025-05-19 01:24:55,621 [INFO] models.hook_bridge: 標籤欄位: DrLee_Evaluation
2025-05-19 01:24:55,621 [INFO] models.hook_bridge: 標籤映射: {0: '聽起來正常', 1: '輕度異常', 2: '重度異常'}
2025-05-19 01:24:55,621 [INFO] models.hook_bridge: 標籤名稱: ['聽起來正常', '輕度異常', '重度異常']
2025-05-19 01:24:55,624 [DEBUG] models.hook_bridge: 層 'backbone.features.4' 的特徵張量已從 torch.Size([64, 8, 10, 384]) 展平為 torch.Size([64, 30720]) 以便保存
2025-05-19 01:24:55,624 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.4' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:55,631 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:55,631 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_4_val_features.pt
2025-05-19 01:24:55,679 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:55,679 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_4_val_cosine_similarity.pt
2025-05-19 01:24:56,194 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=30720)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:56,404 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:56,404 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_4_val_tsne.pt
2025-05-19 01:24:56,407 [DEBUG] models.hook_bridge: 層 'backbone.features.7' 的特徵張量已從 torch.Size([64, 4, 5, 768]) 展平為 torch.Size([64, 15360]) 以便保存
2025-05-19 01:24:56,407 [DEBUG] models.hook_bridge: 準備保存層 'backbone.features.7' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:56,411 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:56,411 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_7_val_features.pt
2025-05-19 01:24:56,452 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:56,452 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_7_val_cosine_similarity.pt
2025-05-19 01:24:56,615 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=15360)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:56,841 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:56,841 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_backbone_features_7_val_tsne.pt
2025-05-19 01:24:56,841 [DEBUG] models.hook_bridge: 準備保存層 'head.0' 的特徵數據，包含鍵: ['layer_name', 'activations', 'targets', 'timestamp', 'epoch', 'dataset_name', 'label_names', 'label_mapping', 'label_field']
2025-05-19 01:24:56,842 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_head_0_val_features.pt
2025-05-19 01:24:56,842 [INFO] models.hook_bridge: 已保存特徵向量到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_head_0_val_features.pt
2025-05-19 01:24:56,875 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:56,875 [INFO] models.hook_bridge: 已保存餘弦相似度矩陣到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_head_0_val_cosine_similarity.pt
2025-05-19 01:24:57,178 [INFO] models.hook_bridge: t-SNE計算：使用PCA降維到50個組件 (樣本數=64, 原始特徵數=768)
/home/sbplab/miniconda3/envs/ENT/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:1164: FutureWarning: 'n_iter' was renamed to 'max_iter' in version 1.5 and will be removed in 1.7.
  warnings.warn(
2025-05-19 01:24:57,410 [INFO] utils.save_manager: 特徵向量數據已保存到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_head_0_val_tsne.pt
2025-05-19 01:24:57,410 [INFO] models.hook_bridge: 已保存t-SNE結果到: results/indexed_classification_drlee_20250519_012024/feature_vectors/epoch_29/layer_head_0_val_tsne.pt
2025-05-19 01:24:57,411 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.4' 的特徵向量鉤子
2025-05-19 01:24:57,411 [DEBUG] models.hook_bridge: 已移除層 'backbone.features.7' 的特徵向量鉤子
2025-05-19 01:24:57,411 [DEBUG] models.hook_bridge: 已移除層 'head.0' 的特徵向量鉤子
2025-05-19 01:24:57,411 [INFO] models.hook_bridge: 已移除所有特徵向量鉤子
2025-05-19 01:24:57,411 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'test' 与 logs 中的數據集 'val' 不匹配。
2025-05-19 01:24:57,411 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集評估結束 (Epoch: 29)。收集了 2 個批次的數據
2025-05-19 01:24:57,411 [DEBUG] models.hook_bridge: EvaluationResultsHook (val): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([64, 3])
2025-05-19 01:24:57,412 [INFO] models.hook_bridge: EvaluationResultsHook (val): 準備保存結果。Targets: torch.Size([64]), Predictions: torch.Size([64])
2025-05-19 01:24:57,413 [INFO] models.hook_bridge: EvaluationResultsHook: val 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_val.pt
2025-05-19 01:24:58,399 [INFO] utils.save_manager: 檢查點已保存到: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_29.pth
2025-05-19 01:24:58,400 [INFO] trainers.pytorch_trainer: Epoch 30/30 - 已保存檢查點: results/indexed_classification_drlee_20250519_012024/models/checkpoint_epoch_29.pth
2025-05-19 01:24:58,442 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_0_weight_gradient_all.pt
2025-05-19 01:24:58,443 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_0_bias_gradient_all.pt
2025-05-19 01:24:58,445 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_2_weight_gradient_all.pt
2025-05-19 01:24:58,446 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_0_2_bias_gradient_all.pt
2025-05-19 01:24:58,447 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:58,449 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:58,450 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:58,452 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:58,456 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:58,460 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:58,462 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:58,463 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:58,464 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:58,466 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:58,471 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:58,473 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:58,478 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:58,479 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:58,481 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:58,482 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:58,484 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:58,488 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:58,490 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:58,493 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:58,494 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:58,496 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:58,497 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:58,506 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:58,509 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:58,515 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_1_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:58,517 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_2_reduction_weight_gradient_all.pt
2025-05-19 01:24:58,528 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_2_norm_weight_gradient_all.pt
2025-05-19 01:24:58,531 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_2_norm_bias_gradient_all.pt
2025-05-19 01:24:58,533 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:58,535 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:58,538 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:58,541 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:58,555 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:58,558 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:58,564 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:58,567 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:58,569 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:58,572 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:58,591 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:58,594 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:58,613 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:58,615 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:58,617 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:58,620 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:58,623 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:58,637 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:58,640 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:58,646 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:58,648 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:58,651 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:58,654 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:58,673 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:58,676 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:58,694 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_3_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:58,698 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_4_reduction_weight_gradient_all.pt
2025-05-19 01:24:58,731 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_4_norm_weight_gradient_all.pt
2025-05-19 01:24:58,733 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_4_norm_bias_gradient_all.pt
2025-05-19 01:24:58,736 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm1_weight_gradient_all.pt
2025-05-19 01:24:58,738 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm1_bias_gradient_all.pt
2025-05-19 01:24:58,741 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:58,745 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:58,793 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:58,796 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:58,815 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:58,818 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm2_weight_gradient_all.pt
2025-05-19 01:24:58,820 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_norm2_bias_gradient_all.pt
2025-05-19 01:24:58,825 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:58,887 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:58,891 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:58,956 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:58,964 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm1_weight_gradient_all.pt
2025-05-19 01:24:58,966 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm1_bias_gradient_all.pt
2025-05-19 01:24:58,969 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:58,984 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:59,034 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:59,037 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:59,058 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:59,061 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm2_weight_gradient_all.pt
2025-05-19 01:24:59,063 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_norm2_bias_gradient_all.pt
2025-05-19 01:24:59,068 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:59,155 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:59,160 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:59,225 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:59,228 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm1_weight_gradient_all.pt
2025-05-19 01:24:59,231 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm1_bias_gradient_all.pt
2025-05-19 01:24:59,233 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:59,238 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:59,284 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:59,287 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:59,307 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:59,309 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm2_weight_gradient_all.pt
2025-05-19 01:24:59,312 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_norm2_bias_gradient_all.pt
2025-05-19 01:24:59,316 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:59,380 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:59,385 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:59,448 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_2_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:59,450 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm1_weight_gradient_all.pt
2025-05-19 01:24:59,453 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm1_bias_gradient_all.pt
2025-05-19 01:24:59,456 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:59,460 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:59,508 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:59,511 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:59,530 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:59,533 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm2_weight_gradient_all.pt
2025-05-19 01:24:59,535 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_norm2_bias_gradient_all.pt
2025-05-19 01:24:59,540 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:59,605 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:59,610 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:59,707 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_3_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:59,709 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm1_weight_gradient_all.pt
2025-05-19 01:24:59,712 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm1_bias_gradient_all.pt
2025-05-19 01:24:59,715 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:59,719 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:59,767 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_qkv_bias_gradient_all.pt
2025-05-19 01:24:59,770 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_proj_weight_gradient_all.pt
2025-05-19 01:24:59,791 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_attn_proj_bias_gradient_all.pt
2025-05-19 01:24:59,793 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm2_weight_gradient_all.pt
2025-05-19 01:24:59,795 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_norm2_bias_gradient_all.pt
2025-05-19 01:24:59,800 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_0_weight_gradient_all.pt
2025-05-19 01:24:59,862 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_0_bias_gradient_all.pt
2025-05-19 01:24:59,867 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_3_weight_gradient_all.pt
2025-05-19 01:24:59,927 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_4_mlp_3_bias_gradient_all.pt
2025-05-19 01:24:59,929 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm1_weight_gradient_all.pt
2025-05-19 01:24:59,932 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm1_bias_gradient_all.pt
2025-05-19 01:24:59,935 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:24:59,940 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_qkv_weight_gradient_all.pt
2025-05-19 01:24:59,997 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_qkv_bias_gradient_all.pt
2025-05-19 01:25:00,000 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_proj_weight_gradient_all.pt
2025-05-19 01:25:00,019 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_attn_proj_bias_gradient_all.pt
2025-05-19 01:25:00,021 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm2_weight_gradient_all.pt
2025-05-19 01:25:00,024 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_norm2_bias_gradient_all.pt
2025-05-19 01:25:00,028 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_0_weight_gradient_all.pt
2025-05-19 01:25:00,092 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_0_bias_gradient_all.pt
2025-05-19 01:25:00,096 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_3_weight_gradient_all.pt
2025-05-19 01:25:00,208 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_5_5_mlp_3_bias_gradient_all.pt
2025-05-19 01:25:00,215 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_6_reduction_weight_gradient_all.pt
2025-05-19 01:25:00,230 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_6_norm_weight_gradient_all.pt
2025-05-19 01:25:00,232 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_6_norm_bias_gradient_all.pt
2025-05-19 01:25:00,235 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm1_weight_gradient_all.pt
2025-05-19 01:25:00,237 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm1_bias_gradient_all.pt
2025-05-19 01:25:00,240 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:25:00,249 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_qkv_weight_gradient_all.pt
2025-05-19 01:25:00,264 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_qkv_bias_gradient_all.pt
2025-05-19 01:25:00,269 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_proj_weight_gradient_all.pt
2025-05-19 01:25:00,333 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_attn_proj_bias_gradient_all.pt
2025-05-19 01:25:00,336 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm2_weight_gradient_all.pt
2025-05-19 01:25:00,338 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_norm2_bias_gradient_all.pt
2025-05-19 01:25:00,350 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_0_weight_gradient_all.pt
2025-05-19 01:25:00,367 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_0_bias_gradient_all.pt
2025-05-19 01:25:00,378 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_3_weight_gradient_all.pt
2025-05-19 01:25:00,393 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_0_mlp_3_bias_gradient_all.pt
2025-05-19 01:25:00,396 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm1_weight_gradient_all.pt
2025-05-19 01:25:00,398 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm1_bias_gradient_all.pt
2025-05-19 01:25:00,401 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_relative_position_bias_table_gradient_all.pt
2025-05-19 01:25:00,410 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_qkv_weight_gradient_all.pt
2025-05-19 01:25:00,443 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_qkv_bias_gradient_all.pt
2025-05-19 01:25:00,448 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_proj_weight_gradient_all.pt
2025-05-19 01:25:00,510 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_attn_proj_bias_gradient_all.pt
2025-05-19 01:25:00,513 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm2_weight_gradient_all.pt
2025-05-19 01:25:00,516 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_norm2_bias_gradient_all.pt
2025-05-19 01:25:00,527 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_0_weight_gradient_all.pt
2025-05-19 01:25:00,542 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_0_bias_gradient_all.pt
2025-05-19 01:25:00,554 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_3_weight_gradient_all.pt
2025-05-19 01:25:00,568 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_features_7_1_mlp_3_bias_gradient_all.pt
2025-05-19 01:25:00,571 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_norm_weight_gradient_all.pt
2025-05-19 01:25:00,573 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/backbone_norm_bias_gradient_all.pt
2025-05-19 01:25:00,576 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/head_1_weight_gradient_all.pt
2025-05-19 01:25:00,579 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/head_1_bias_gradient_all.pt
2025-05-19 01:25:00,581 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_0_weight_gradient_all.pt
2025-05-19 01:25:00,588 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_0_bias_gradient_all.pt
2025-05-19 01:25:00,591 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_2_weight_gradient_all.pt
2025-05-19 01:25:00,593 [INFO] utils.save_manager: gradient 數據已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/skip_connection_2_bias_gradient_all.pt
2025-05-19 01:25:00,595 [INFO] trainers.pytorch_trainer: Epoch 29: _epoch_batch_grads contains 4 entries. Ready for GNS calculation.
2025-05-19 01:25:04,488 [INFO] utils.save_manager: GNS 統計量已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/gns_stats_epoch_29.json
2025-05-19 01:25:04,489 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: 結束 epoch 29
2025-05-19 01:25:04,489 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 29 檢測到驗證集 outputs 和 targets，準備保存 epoch_29_validation_predictions.pt
2025-05-19 01:25:04,490 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 29 驗證集預測結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29_validation_predictions.pt
2025-05-19 01:25:04,490 [INFO] models.hook_bridge: SimpleModelAnalyticsCallback: Epoch 29 達到保存頻率，調用 save_manager.save_epoch_summary
2025-05-19 01:25:04,491 [INFO] utils.save_manager: Epoch 29 摘要已保存到: results/indexed_classification_drlee_20250519_012024/hooks/epoch_29/epoch_summary.pt
2025-05-19 01:25:04,491 [INFO] trainers.pytorch_trainer: Epoch 30/30 - 訓練損失: 13.2510, 驗證損失: 3.2514
2025-05-19 01:25:04,491 [INFO] trainers.pytorch_trainer: 訓練完成，耗時: 168.67 秒
2025-05-19 01:25:04,501 [INFO] utils.save_manager: 訓練摘要已保存到: results/indexed_classification_drlee_20250519_012024/hooks/training_summary.pt
2025-05-19 01:25:04,501 [INFO] models.hook_bridge: 已移除所有激活值鉤子
2025-05-19 01:25:04,501 [INFO] models.hook_bridge: 已移除所有梯度鉤子
2025-05-19 01:25:04,501 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:25:04,501 [INFO] models.hook_bridge: 已移除所有激活值鉤子
2025-05-19 01:25:04,501 [INFO] models.hook_bridge: 已移除所有梯度鉤子
2025-05-19 01:25:04,502 [DEBUG] models.hook_bridge: 已清除所有緩存的特徵向量
2025-05-19 01:25:04,502 [INFO] models.hook_bridge: 已移除所有激活值鉤子
2025-05-19 01:25:04,502 [INFO] models.hook_bridge: 已移除所有梯度鉤子
2025-05-19 01:25:04,871 [INFO] utils.save_manager: 模型已保存到: results/indexed_classification_drlee_20250519_012024/models/best_model.pth
2025-05-19 01:25:04,878 [INFO] trainers.pytorch_trainer: 模型結構信息已保存到: results/indexed_classification_drlee_20250519_012024/model_structure.json
2025-05-19 01:25:04,878 [INFO] trainers.pytorch_trainer: 在測試集上評估最佳模型...
2025-05-19 01:25:04,878 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 test 數據集的評估結果 (Epoch: 29)
2025-05-19 01:25:04,878 [INFO] models.hook_bridge: EvaluationResultsHook: 開始收集 val 數據集的評估結果 (Epoch: 29)

Epoch 30/30 [TEST]:   0%|          | 0/2 [00:00<?, ?it/s][A2025-05-19 01:25:05,340 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:25:05,387 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [TEST]:   0%|          | 0/2 [00:00<?, ?it/s, loss=1.51][A2025-05-19 01:25:05,429 [DEBUG] models.hook_bridge: EvaluationResultsHook (test): 處理完批次 0, 已收集 1 個批次數據。Raw outputs: 1, Targets: 1
2025-05-19 01:25:05,429 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 0，因為目標數據集 'val' 與當前評估數據集 'test' 不匹配。

Epoch 30/30 [TEST]:  50%|█████     | 1/2 [00:00<00:00,  1.82it/s, loss=1.51][A2025-05-19 01:25:05,429 [INFO] utils.data_adapter: 將音頻轉換為頻譜圖以適應視覺模型
2025-05-19 01:25:05,447 [INFO] utils.data_adapter: 將單通道頻譜圖轉換為3通道

Epoch 30/30 [TEST]:  50%|█████     | 1/2 [00:00<00:00,  1.82it/s, loss=2.56][A2025-05-19 01:25:05,470 [DEBUG] models.hook_bridge: EvaluationResultsHook (test): 處理完批次 1, 已收集 2 個批次數據。Raw outputs: 2, Targets: 2
2025-05-19 01:25:05,470 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過批次 1，因為目標數據集 'val' 與當前評估數據集 'test' 不匹配。
Epoch 30/30 [TEST]: 100%|██████████| 2/2 [00:00<00:00,  3.18it/s, loss=2.56]
2025-05-19 01:25:05,514 [INFO] models.hook_bridge: EvaluationResultsHook: test 數據集評估結束 (Epoch: 29)。收集了 2 個批次的數據
2025-05-19 01:25:05,515 [DEBUG] models.hook_bridge: EvaluationResultsHook (test): 分類任務，處理原始輸出以獲取預測和概率。原始輸出形狀: torch.Size([48, 3])
2025-05-19 01:25:05,515 [INFO] models.hook_bridge: EvaluationResultsHook (test): 準備保存結果。Targets: torch.Size([48]), Predictions: torch.Size([48])
2025-05-19 01:25:05,516 [INFO] models.hook_bridge: EvaluationResultsHook: test 數據集的評估結果已保存到: results/indexed_classification_drlee_20250519_012024/hooks/evaluation_results_test.pt
2025-05-19 01:25:05,517 [INFO] models.hook_bridge: EvaluationResultsHook: test 測試結果副本已保存到: results/indexed_classification_drlee_20250519_012024/test_predictions.pt
2025-05-19 01:25:05,517 [DEBUG] models.hook_bridge: EvaluationResultsHook: 跳過 on_evaluation_end，因為目標數據集 'val' 与 logs 中的數據集 'test' 不匹配。
2025-05-19 01:25:05,517 [INFO] trainers.pytorch_trainer: 測試損失: 2.0334
2025-05-19 01:25:05,517 [INFO] trainers.pytorch_trainer: 測試 accuracy: 0.4167
2025-05-19 01:25:05,517 [INFO] trainers.pytorch_trainer: 測試 f1_score: 0.1961
2025-05-19 01:25:05,517 [INFO] trainers.pytorch_trainer: 測試 precision: 0.1389
2025-05-19 01:25:05,517 [INFO] trainers.pytorch_trainer: 測試 recall: 0.3333
Training:   0%|          | 0/30 [02:49<?, ?it/s]
2025-05-19 01:25:05,526 [INFO] __main__: 最終實驗結果已保存到: results/indexed_classification_drlee_20250519_012024/results/results.json
